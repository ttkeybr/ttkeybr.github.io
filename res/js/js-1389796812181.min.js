"use strict";function polyfill(){polyfill=function(){throw new Error},function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=window.CustomEvent.prototype,window.CustomEvent=a}(),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(a,b){return b=b||0,this.indexOf(a,b)===b}}),String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(a,b){b=b||this.length,b-=a.length;var c=this.lastIndexOf(a);return-1!==c&&c===b}}),String.prototype.trim||Object.defineProperty(String.prototype,"trim",{enumerable:!1,configurable:!1,writable:!1,value:function(){return this.replace(/^\s+|\s+$/g,"")}}),Storage.prototype.getObject=function(a){try{return JSON.parse(this.getItem(a))}catch(b){return null}},Storage.prototype.setObject=function(a,b){this.setItem(a,JSON.stringify(b))},window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,window.URL=window.URL||window.webkitURL}function ParamMap(){var a=window.location.search;a.startsWith("?")&&(a=a.substring(1)),a.split("&").map(function(a){var b,c=a.split("="),d=decodeURIComponent(c[0]);b=void 0==c[1]?null:decodeURIComponent(c[1]),this[d]=b},this),this.flag=function(a,b){return b=!!b,a in this?"false"!=this[a]:b}}function normalRandom(a,b){a=void 0!==a?a:0,b=void 0!==b?b:1;var c=Math.sqrt(3*b*b),d=2*c,e=Math.random()*d-c,f=Math.random()*d-c,g=Math.random()*d-c,h=Math.random()*d-c,i=Math.random()*d-c;return a+(e+f+g+h+i)/5*2.23606797749979}function jdkNormalRandom(a,b){a=void 0!==a?a:0,b=void 0!==b?b:1;var c,d,e;do c=2*Math.random()-1,d=2*Math.random()-1,e=c*c+d*d;while(e>=1||0==e);var f=Math.sqrt(-2*Math.log(e)/e);return c*f*b+a}function Identifier(){throw new Error}function AnimationSupport(){function a(a,b){return function(c){return a+b(c)}}this.supported=!1,this.id="standard",this.domName=Identifier.toPascalCase,this.styleName=Identifier.toCamelCase,this.eventName=Identifier.toSimple;var b=[{id:"webkit",domName:a("Webkit",Identifier.toPascalCase),styleName:a("webkit",Identifier.toPascalCase),eventName:a("webkit",Identifier.toPascalCase)},{id:"moz",domName:a("Moz",Identifier.toPascalCase),styleName:a("moz",Identifier.toPascalCase),eventName:a("moz",Identifier.toPascalCase)},{id:"ms",domName:a("MS",Identifier.toPascalCase),styleName:a("ms",Identifier.toPascalCase),eventName:a("MS",Identifier.toPascalCase)}],c=document.body;if(void 0!==c.style.animationName)this.supported=!0;else for(var d=0;d<b.length;d++){var e=b[d];if(void 0!==c.style[e.domName("animation-name")]){this.supported=!0,this.id=e.id,this.domName=e.domName,this.styleName=e.styleName,this.eventName=e.eventName;break}}}function Color(a){if(3==arguments.length)return this.r=arguments[0],this.g=arguments[1],this.b=arguments[2],this;if("number"==typeof a){var b=0|a;return this.r=b>>16&255,this.g=b>>8&255,this.b=255&b,this}if("string"==typeof a){a.startsWith("#")&&(a=a.substring(1));var c=parseInt(a,16);return this.r=c>>16&255,this.g=c>>8&255,this.b=255&c,this}if("array"==typeof a)return this.r=0|a[0],this.g=0|a[1],this.b=0|a[2],this;if("object"==typeof a)return this.r=0|a.r,this.g=0|a.g,this.b=0|a.b,this;throw new Error}function DateX(a){return"number"==typeof a&&(a=new Date(a)),this.year=a.getFullYear(),this.month=a.getMonth()+1,this.day=a.getDate(),Object.freeze(this)}function mapValues(a){var b=[];for(var c in a)b.push(a[c]);return b}function round(a,b){return Math.round(a*b)/b}function clientId(){function a(a){for(var b="abcdefghijklmnopqrstuvwxyz0123456789",c="",d=0;a>d;d++)c+=b.charAt(Math.randomInt(0,b.length-1));return c}function b(a){return void 0==a||null==a?a:a.trim()}var c=b(Cookies.get("cid")),d=b(window.localStorage.getItem("cid")),e=null;return e=c&&d?d=c:c?d=c:c=d?d:d=a(10),Cookies.set("cid",e),window.localStorage.setItem("cid",e),e}function DropDown(a){this.$el=a,this.$placeholder=this.$el.children("span"),0==this.$placeholder.length&&this.$el.append(this.$placeholder=$("<span></span>")),this.$list=this.$el.children("ul"),0==this.$list.length&&this.$el.append(this.$list=$('<ul tabindex="1"></ul>'));var b=this;b.$el.on("click",function(){return b.$el.toggleClass("active"),!1}),this.clear()}function initCommonUi(){$(document).on("click",function(){$(".ui.dropdown").removeClass("active")})}function UnicodeCombiner(a,b,c,d){if(c.length!=d.length)throw new Error;for(var e=0;e<d.length;e++)if(Unicode.isCombining(d.charCodeAt(e)))throw new Error;return this.combiner=a,this.image=b,this.from=c,this.to=d,Object.freeze(this)}function sanitizeText(a,b,c){for(var d="",e="",f=0;f<a.length;f++){var g=a.charCodeAt(f);if(Unicode.isNl(g))e=""==d?"":"\n";else if(Unicode.isWs(g))""==d?e="":"\n"!=e&&(e=" ");else{d+=e,e="";var h=String.fromCharCode(g);switch(g){case 8210:case 8211:case 8212:case 8213:g=45,h="-";break;case 8216:case 8217:case 8218:g=39,h="'";break;case 8220:case 8221:case 8222:case 171:case 187:g=34,h='"';break;case 8230:g=0,h="..."}if(null!=c&&-1!=c.indexOf(g))continue;(null==b||-1!=b.indexOf(g))&&(d+=h)}}return d}function TextParser(a){this.text=a,this.reset()}function Censor(a){this.config={set:a.set.map(function(a){return a.replace(/\s+/g," ").trim()}).sort(function(a,b){return b.length-a.length}).map(function(a){return new RegExp("\\b"+a.replace(" ","\\s+")+"\\b","gi")})}}function Generator(){}function DummyGenerator(a){Generator.call(this),this.text=a}function StaticTextGenerator(a,b,c){Generator.call(this),this.wordLimit=20,this.fragmentLimit=80,b.censor&&(a=CENSOR.get(c.lang).censor(a)),a=b.simplify?sanitizeText(a,c.charSet,sanitizeText.GRAPHICS):sanitizeText(a,c.charSet),b.lowercase&&(a=a.toLowerCase()),this.text=a,this.parser=new TextParser(this.text),this.nextWord()}function RandomWordsGenerator(){Generator.call(this),this.charSet=[],this.subSet=null,this.boost=null,this.wordLimit=8,this.fragmentLimit=80,this.enableCapitals=!1,this.enablePunctuators=!1}function LanguageModel(a){function b(a,b,c){this.index=a,this.charCode=b,this.weight=c}function c(a){Array.call(this,a)}function d(a,d){function e(){for(var b=new Uint8Array(a,0),c=9,d=b[c++],e=0;d>e;e++)l+=String.fromCharCode(256*b[c++]+b[c++]);k=b[c++]-1;var f=c,g=f+2*Math.pow(l.length,k);m=new Uint8Array(a,f,g-f),n=new Uint8Array(a,g),o.reset()}function f(a,b,c,d){for(var e=!1,f="",h=0;;){var i=g(a,c);if(0==i.length)c.reset(),e=!1,f="";else{b&&!e&&(f.length>0||h>3)&&i.boost(b.charCode,b.factor);var j=i.pickRandom();if(b&&!e&&j.charCode==b.charCode&&(e=!0),c.push(j.index),c.shift(),32==j.charCode){if(!b)return f;if(e)return f;h++,c.reset(),e=!1,f=""}else f.length==d?(c.reset(),e=!1,f=""):f+=String.fromCharCode(j.charCode)}}}function g(a,d){for(var e=l.length,f=0,g=1,h=0;k>h;h++)f+=g*d[k-h-1],g*=e;f*=2,f=m[f]<<8|m[f+1];var i=new c,j=0;if(65535!=f){var o=n[f]>>4&15,p=15&n[f];for(f++;;){for(;o>0;){var q=l.charCodeAt(j),r=n[f];(32==q||null==a||-1!=a.indexOf(q))&&i.push(new b(j,q,r)),f++,j++,o--}if(j+=p,j==e)break;o=n[f]>>>4&15,p=15&n[f],f++}}return i}function h(){for(var a=Object.create(null),b=0;b<l.length;b++)a[l.charCodeAt(b)]=0;return a}function i(a,b,c){for(var d=0;d<l.length;d++)if(a[b]=d,k-1>b)i(a,b+1,c);else for(var e=g(null,a),f=0;f<e.length;f++){var h=e[f],j=c[h.charCode];j+=h.weight,c[h.charCode]=j}}function j(a){var b,c,d=0;for(b=0;b<l.length;b++)c=l.charCodeAt(b),32!=c&&(d+=a[c]);var e=[];for(b=0;b<l.length;b++)c=l.charCodeAt(b),32!=c&&e.push(Object.freeze({charCode:c,f:a[c]/d}));return e.orderBy=function(a){var b=this.slice(0);switch(a){case ORDER_BY.FREQUENCY:b.sort(function(a,b){return b.f-a.f});break;case ORDER_BY.INDEX:b.sort(function(a,b){return a.charCode-b.charCode});break;default:throw new Error}return b},Object.freeze(e)}var k=0,l="",m=null,n=null,o=[],p="";o.reset=function(){for(var a=0;k>a;a++)this[a]=0},e();var q=new RandomWordsGenerator,r=h();return i(new Array(k),0,r),q.charSet=j(r),q.nextWord=function(){for(var a=f(this.subSet,this.boost,o,this.wordLimit);p==a||a.length<3;)a=f(this.subSet,this.boost,o,this.wordLimit);return p=a},q.nextFragment=function(){for(var a=[".",",",":",";","!","?","-","(","[",'"',"'"],b="";;){var c=this.nextWord();if(this.enableCapitals&&(c=c.substring(0,1).toUpperCase()+c.substring(1)),this.enablePunctuators){var e=a[Math.randomInt(0,a.length-1)];switch(e){case null:break;case"-":c=c+"-"+this.nextWord();break;case"(":c="("+c+")";break;case"[":c="["+c+"]";break;case'"':c='"'+c+'"';break;case"'":c=c+"'"+this.nextWord();break;default:c+=e}}if(0==b.length){if(b=c,b.length>this.fragmentLimit)break}else{if(b.length+1+c.length>this.fragmentLimit)break;b+=" "+c}}return d.censor(b,"omg")},q}function e(){i=[],j=null}function f(a){j=new XMLHttpRequest,j.onload=function(){i.forEach(function(a){a(h=d(j.response,g))}),e()},j.onerror=function(){i.forEach(function(a){a(h=new DummyGenerator("error loading language data"))}),e()},watchProgress(j),j.open("GET",a,!0),j.responseType="arraybuffer",j.send()}this.code=a,c.prototype=[],c.prototype.boost=function(a,b){for(var c=0;c<this.length;c++){var d=this[c];if(d.charCode==a)return d.weight=Math.round(d.weight*b),!0}return!1},c.prototype.weight=function(){for(var a=0,b=0;b<this.length;b++){var c=this[b];a+=c.weight}return a},c.prototype.pickRandom=function(){for(var a=this.weight(),b=Math.floor(Math.random()*(a+1)),c=0;c<this.length;c++){var d=this[c];if(b<=d.weight)return d;b-=d.weight}throw new Error};var g=CENSOR.get(this.code),h=null,i=[],j=null;return this.load=function(a){null==h?(i.push(a),null==j&&f("/data/lang-"+this.code+".data")):a(h)},Object.freeze(this)}function Language(a,b){return this.id=a,this.name=b,Object.freeze(this)}function CustomKeyboardEvent(a){return this.ev=a,this.type=a.type,this.timeStamp=a.timeStamp,this.altKey=a.altKey,this.ctrlKey=a.ctrlKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.location=a.location,this.keyCode=VK.normalizeKeyCode(a.keyCode),Object.defineProperty(this,"eventPhase",{configurable:!1,enumerable:!0,get:function(){return a.eventPhase}}),Object.defineProperty(this,"bubbles",{configurable:!1,enumerable:!0,get:function(){return a.bubbles}}),Object.defineProperty(this,"cancelable",{configurable:!1,enumerable:!0,get:function(){return a.cancelable}}),Object.defineProperty(this,"defaultPrevented",{configurable:!1,enumerable:!0,get:function(){return a.defaultPrevented}}),Object.defineProperty(this,"cancelBubble",{configurable:!1,enumerable:!0,get:function(){return a.cancelBubble},set:function(b){a.cancelBubble=b}}),Object.freeze(this)}function LayoutKey(a,b,c,d,e,f,g){function h(a){if(null==a)return 0;if("string"==typeof a)return a.charCodeAt(0);if("number"==typeof a)return a;throw new Error}return this.position=a,this.keyCode=b,this.alpha=c,this.primary=h(d),this.primaryShift=h(e),this.secondary=h(f),this.secondaryShift=h(g),Object.freeze(this)}function KeyCombo(a,b,c,d,e,f,g){function h(a,b,c,d,e){var f=1;return a&&f++,b&&f++,c&&(f++,d&&f++,e&&f++),f}return this.charCode=a,this.key=b,this.shift=c,this.alt=d,this.deadKey=e,this.deadShift=f,this.deadAlt=g,this.complexity=h(c,d,e,f,g),Object.freeze(this)}function Layout(a,b,c,d,e,f){function g(a){var b=l.comboMap[a.charCode];if(b){if(b.deadKey&&a.deadKey)throw new Error;b.deadKey&&!a.deadKey&&(l.comboMap[a.charCode]=a)}else l.comboMap[a.charCode]=a;l.charSet.push(a.charCode)}function h(a,b,c,d){a>0&&!Unicode.isCombining(a)&&(m.push(a),g(new KeyCombo(a,b,c,d)))}function i(a,b,c,d){if(a>0&&Unicode.isCombining(a))for(var e=0;e<m.length;e++){var f=m[e],h=Unicode.combine(f,a);if(h!=f){var i=l.comboMap[f];g(i.applyDeadKey(h,b,c,d))}}}this.id=a,this.name=b,this.lang=c,this.keys=d,this.geometry=e,this.variantOf=f,this.config={emulate:!1},this.charSet=[],this.comboMap=[];var j,k;for(this.byKeyCode=[],this.byPosition=[],j=0;j<this.keys.length;j++)this.byKeyCode[this.keys[j].keyCode]=this.keys[j],this.byPosition[this.keys[j].position]=this.keys[j];for(this.geometryMap=[],j=0;j<this.geometry.length;j++)this.geometryMap[this.geometry[j].id]=this.geometry[j];var l=this,m=[];for(j=0;j<this.keys.length;j++)k=this.keys[j],h(k.primary,k,!1,!1),h(k.primaryShift,k,!0,!1),h(k.secondary,k,!1,!0),h(k.secondaryShift,k,!0,!0);for(j=0;j<this.keys.length;j++)k=this.keys[j],i(k.primary,k,!1,!1),i(k.primaryShift,k,!0,!1),i(k.secondary,k,!1,!0),i(k.secondaryShift,k,!0,!0);return this.charSet.sort(function(a,b){return a-b}),Object.freeze(this)}function KeyboardEventHandler(a,b){this.layout=a,this.sink=b}function KeyboardShakeAnimation(a){ShakeAnimation.call(this),this.keyMap=a}function dumpGeometry(){function a(a){return void 0===a||null===a?"":a}function b(b){for(var c="",d=0;d<b.length;d++){var e=b[d],f=e.id;f="number"==typeof f?"VK."+VK.name(f):'"'+f+'"',c+="{ id: "+f+", x: "+e.x+", y: "+e.y+', ref: "'+a(e.ref)+'", c: "'+a(e.c)+'" },\n'}return c}for(var c in LAYOUT_GEOMETRY){var d=LAYOUT_GEOMETRY[c];console.log("--- "+c+" ---"),console.log(b(d))}}function dumpLayout(){function a(a){function b(a){try{return"VK."+VK.name(a)}catch(b){return a}}function c(a){if(0==a)return"null";var b=String.fromCharCode(a);return"\\"==b&&(b="\\\\"),'"'==b&&(b='\\"'),a+' /*"'+b+'"*/'}var d="";for(var e in a.keys){var f=a.keys[e];d+=f.keyCode==f.position?"LayoutKey.std("+b(f.keyCode)+", "+f.alpha+", "+c(f.primary)+", "+c(f.primaryShift)+", "+c(f.secondary)+", "+c(f.secondaryShift)+"),\n":"LayoutKey.ext("+b(f.position)+", "+b(f.keyCode)+", "+f.alpha+", "+c(f.primary)+", "+c(f.primaryShift)+", "+c(f.secondary)+", "+c(f.secondaryShift)+"),\n"}return d}for(var b in LAYOUT){var c=LAYOUT[b];console.log("--- "+b+" ---"),console.log(a(c))}}function Sounds(){this.library=null}function fromCode(a,b,c){for(var d in a){var e=a[d];if(e.id===b)return e}if(void 0===c)throw new Error;return c}function ModeType(a,b){return this.id=a,this.title=b,Object.freeze(this)}function Mode(a,b){return this.id=a,this.type=b,this.config={},Object.freeze(this)}function SpeedUnit(a,b,c){return this.id=a,this.title=b,this.measure=c,Object.freeze(this)}function Settings(a,b){this.cid=a,this.layout=Settings.DEFAULT_LAYOUT,this.emulateLayout=!1,this.mode=Settings.DEFAULT_MODE,this.lesson={complexity:1,length:1,capitals:!1,punctuators:!1},this.speedUnit=SPEED_UNIT.WPM,this.enableSound=!1,this.textConfig={url:"",text:"",mangle:{simplify:!0,lowercase:!0,censor:!0}},this.newSettings=!0,(void 0===b||b)&&(this.reload(),this.newSettings&&this.persist())}function ResultArray(){}function Histogram(a){if(this.data=Object.create(null),a)for(var b=0;b<a.length;b++)this.add(a[b])}function History(){this.data=new ResultArray}function Achievement(a,b){this.id=a,this.value=b}function AchievementsAnalyzer(){this.reset()}function StaticLesson(a,b){return this.settings=a,this.generator=b,this}function Lesson(a,b){return this.settings=a,this.generator=b,this.charSet=Lesson.getCharSet(this.generator,this.settings.layout),this}function LessonUi(){throw new Error}function Result(a,b,c,d,e,f,g,h){return this.layout=a instanceof Layout?a.id:a,this.modeType=b instanceof ModeType?b.id:b,this.timeStamp=c,this.length=d,this.time=e,this.errors=f,this.complexity=g,this.speed=this.length/(this.time/1e3)*60,this.score=this.speed*this.complexity/(this.errors+1),this.histogram=h,Object.freeze(this)}function Fragment(a,b,c){this.layout=a,this.modeType=b,this.lesson=c,this.text=this.lesson.generate(),this.complexity=this.layout.complexity(this.text),this.reset()}function FragmentUi(a){this.fragment=a,this.fragmentEl=_dom.el("div","fragment"),this.itemEl=[];for(var b=this.fragment.text,c=0;c<b.length;c++){var d=b.charAt(c);"\n"==d?(this.fragmentEl.appendChild(this.itemEl[c]=_dom.el("span",["item","new-line"],"↵")),this.fragmentEl.appendChild(_dom.el("br",null,null))):" "==d?(this.fragmentEl.appendChild(this.itemEl[c]=_dom.el("span",["item","space"],"␣")),this.fragmentEl.appendChild(_dom.el("span",null," "))):this.fragmentEl.appendChild(this.itemEl[c]=_dom.el("span","item",d))}this.updateUi()}function LessonDetailsUi(a){this.$el=a}function FragmentShakeAnimation(a){ShakeAnimation.call(this),this.elArray=a}function Shake(a){this.a=a}function ShakeAnimation(){}function initGameUi(a){$("#ctl-reset").on("click",function(){a.reset()}),$("#ctl-skip").on("click",function(){a.next()})}function initSettingsUi(a){function b(a){function b(){LanguageModel.get(o.layout.lang).load(function(a){var b=new Lesson(o,a),c=p.data.filter(MODE_TYPE.AUTO,o.layout);b.update(c),new LessonDetailsUi(r).update(b),s.text(b.generate())})}T&&(window.clearTimeout(T),T=null),a?b():T=window.setTimeout(function(){T=null,b()},100)}function c(){N.text(o.speedUnit.id),N.attr("title",o.speedUnit.title),O.attr("title",o.speedUnit.title)}function d(){b(!0)}function e(){}function f(){}function g(){}function h(){}function i(){}function j(){switch(Q.reveal("_form-1"),t.val(Math.round(100*o.lesson.complexity)),u.val(Math.round(100*o.lesson.length)),v.attr("checked",o.lesson.capitals),w.attr("checked",o.lesson.punctuators),x.val(o.textConfig.url),y.val(o.textConfig.text),z.attr("checked",o.textConfig.mangle.simplify),A.attr("checked",o.textConfig.mangle.lowercase),B.attr("checked",o.textConfig.mangle.censor),o.mode){case MODE.GUIDED:R.reveal("_fieldset-mode-1");break;case MODE.IMPORT_WEBSITE:R.reveal("_fieldset-mode-2");break;case MODE.IMPORT_TEXT:R.reveal("_fieldset-mode-3")}switch(o.speedUnit){case SPEED_UNIT.WPM:K.attr("checked",!0),L.attr("checked",!1);break;default:K.attr("checked",!1),L.attr("checked",!0)}M.attr("checked",o.enableSound),S.reset(),P.reset(),document.addEventListener("keydown",U,!0),document.addEventListener("keyup",V,!0)}function k(){document.removeEventListener("keydown",U,!0),document.removeEventListener("keyup",V,!0)}function l(){switch(o.layout=S.layout,o.emulateLayout=S.emulateLayout,R.mode){case"_fieldset-mode-1":o.mode=MODE.GUIDED;break;case"_fieldset-mode-2":o.mode=MODE.IMPORT_WEBSITE;break;case"_fieldset-mode-3":o.mode=MODE.IMPORT_TEXT}return o.lesson.capitals=v.is(":checked"),o.lesson.punctuators=w.is(":checked"),o.textConfig.url=x.val().trim(),o.textConfig.text=y.val().trim(),o.textConfig.mangle.simplify=z.is(":checked"),o.textConfig.mangle.lowercase=A.is(":checked"),o.textConfig.mangle.censor=B.is(":checked"),o.speedUnit=K.is(":checked")?SPEED_UNIT.WPM:SPEED_UNIT.CPM,o.enableSound=M.is(":checked"),c(),m()}function m(){switch(o.mode){case MODE.IMPORT_WEBSITE:if(0==o.textConfig.url.length)return Q.reveal("_form1"),R.reveal("_fieldset-mode-2"),x.focus(),!1;break;case MODE.IMPORT_TEXT:if(0==o.textConfig.text.length)return Q.reveal("_form1"),R.reveal("_fieldset-mode-3"),y.focus(),!1}return!0}var n=function(){var a='Jabberwocky\n\n\'Twas brillig, and the slithy toves\nDid gyre and gimble in the wabe;\nAll mimsy were the borogoves,\nAnd the mome raths outgrabe.\n\n"Beware the Jabberwock, my son!\nThe jaws that bite, the claws that catch!\nBeware the Jubjub bird, and shun\nThe frumious Bandersnatch!"\n\nHe took his vorpal sword in hand:\nLong time the manxome foe he sought-\nSo rested he by the Tumtum tree,\nAnd stood awhile in thought.\n\nAnd as in uffish thought he stood,\nThe Jabberwock, with eyes of flame,\nCame whiffling through the tulgey wood,\nAnd burbled as it came!\n\nOne, two! One, two! and through and through\nThe vorpal blade went snicker-snack!\nHe left it dead, and with its head\nHe went galumphing back.\n\n"And hast thou slain the Jabberwock?\nCome to my arms, my beamish boy!\nO frabjous day! Callooh! Callay!"\nHe chortled in his joy.\n\n\'Twas brillig, and the slithy toves\nDid gyre and gimble in the wabe;\nAll mimsy were the borogoves,\nAnd the mome raths outgrabe.',b="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut egestas libero non laoreet scelerisque. Mauris nec sodales velit. Quisque mattis eu nulla varius accumsan. Sed interdum erat eu justo sodales, vel hendrerit diam pretium. Phasellus lacus libero, scelerisque quis enim eget, tempus elementum massa. Aenean elementum nec magna at fringilla. Nam nisl eros, viverra et luctus eget, placerat non velit. Cras ante velit, mattis quis porttitor nec, pellentesque eu sem. Aenean blandit consectetur metus ut bibendum. Aliquam in suscipit erat. Praesent non vulputate tortor, ac semper diam.",c="Imagine all human beings swept off the face of the earth, excepting one man. Imagine this man in some vast city, New York or London. Imagine him on the third or fourth day of his solitude sitting in a house and hearing a ring at the door-bell!";return{jabberwocky:a,loremipsum:b,story:c}}(),o=a.settings,p=a.history,q=$("#_form-1"),r=($("#_form-2"),$("#_form-3"),$("#_lesson-details")),s=$("#_lesson-example"),t=$("#_range-lesson-complexity"),u=$("#_range-lesson-length"),v=$("#_cb-enable-capitals"),w=$("#_cb-enable-punctuators"),x=$("#_url"),y=$("#_text"),z=$("#_cb-simplify"),A=$("#_cb-lowercase"),B=$("#_cb-censor"),C=$("#_t0"),D=$("#_t1"),E=$("#_t2"),F=C.find(".field-list"),G=$("#_language-list"),H=$("#_layout-list"),I=$("#_layout-demo"),J=$("#_cb-emulate-layout"),K=$("#_rb-speed-unit-wpm"),L=$("#_rb-speed-unit-cpm"),M=$("#_cb-enable-sound"),N=$(".speed-unit-text"),O=$(".speed-unit-title"),P=new KeyboardUi,Q={$items:$("ul.menu > li"),$forms:$("form.settings"),init:function(){var a=this;this.$items.on("click",function(){var b=$(this);a.reveal(b.data("for"))})},reveal:function(a){switch(this.$items.each(function(b,c){var d=$(c);d.data("for")==a?d.addClass("active"):d.removeClass("active")}),this.$forms.each(function(b,c){var d=$(c);c.id==a?d.show():d.hide()}),a){case"_form-1":d();break;case"_form-2":e();break;case"_form-3":f();break;default:throw new Error("unknown id: "+a)}}};Q.init();var R={mode:null,$items:q.find("input[name=mode]"),$forms:q.find("fieldset"),init:function(){var a=this;this.$items.on("click",function(){var b=$(this);a.mode=b.val(),a.reveal(b.val())})},reveal:function(a){switch(this.$items.each(function(b,c){var d=$(c);d.val()==a?d.attr("checked",!0):d.attr("checked",!1)}),this.$forms.each(function(b,c){var d=$(c);c.id==a?d.show():d.hide()}),a){case"_fieldset-mode-1":C.append(F),g();break;case"_fieldset-mode-2":D.append(F),h();break;case"_fieldset-mode-3":E.append(F),i();break;default:throw new Error("unknown id: "+a)}}};R.init();var S={map:Object.create(null),layout:null,emulateLayout:null,init:function(){var a=this;a.languageList=new DropDown(G);for(var b in LAYOUT){var c=LAYOUT[b],d=c.lang,e=this.map[d];void 0===e&&(this.map[d]=e=[],a.languageList.add(LANGUAGE[d].name,d)),e.push(c)}a.languageList.change=function(b,c){a.switchLanguage(c)},J.on("click",function(){a.emulateLayout=J.is(":checked"),a.update()})},reset:function(){var a=this;a.layout=o.layout,a.emulateLayout=o.emulateLayout,a.switchLanguage(a.layout.lang),a.update()},switchLanguage:function(a){var b=this;H.empty();var c=$();$.each(b.map[a],function(a,d){var e=$("<span></span>").addClass("ui radio").text(d.name);H.append($("<li></li>").append(e)),c=c.add(e),d==b.layout&&e.addClass("checked"),e.on("click",function(){c.removeClass("checked"),e.addClass("checked"),b.layout=d,b.update()})})},update:function(){var a=this;a.languageList.select(a.layout.lang),a.layout.config.emulate=a.emulateLayout,P.init(I[0],a.layout),J.each(function(b,c){c.disabled=a.layout.variantOf?!1:!0,c.checked=a.emulateLayout})}};S.init();var T,U=function(a){P.keyDown(new CustomKeyboardEvent(a))},V=function(a){P.keyUp(new CustomKeyboardEvent(a))};t.on("change",function(){o.lesson.complexity=t.val()/100,b(!1)}),u.on("change",function(){o.lesson.length=u.val()/100,b(!1)}),v.on("change",function(){o.lesson.capitals=v.is(":checked"),b(!0)}),w.on("change",function(){o.lesson.punctuators=w.is(":checked"),b(!0)}),c(),q.find("a.example-url").on("click",function(){return x.val($(this).data("url")),!1}),q.find("a.example-text").on("click",function(){return y.val(n[$(this).data("name")]),!1}),$("#submit").on("click",function(){return l()?document.dispatchEvent(new CustomEvent("settings-changed",{detail:{settings:o},bubbles:!0,cancelable:!1}))?(o.persist(),o.loadLesson(function(b){a.start(b)}),!0):!1:!1}),document.addEventListener("reveal-page",function(a){"#settings"==a.detail.url&&j()}),document.addEventListener("hide-page",function(a){"#settings"==a.detail.url&&k()})}function initProfileUi(a){function b(a){var b=a.width(),c=a.height();return 100==b&&a.attr("width",(b=a.parent().width())+"px"),{width:b,height:c}}function c(b){return a.settings.speedUnit.measure(b)}function d(a){var b=new AchievementsAnalyzer,c=b.analyze(a);if(u.empty(),c.length)for(var d=0;d<c.length;d++)for(var e=c[d],f=0;f<e.list.length;f++){var g=e.list[f];if(g.id!=ACH_ID.MAX_SPEED&&g.id!=ACH_ID.MAX_SCORE){var h=$("<div></div>").addClass("badge");h.attr("title",g+" "+new Date(e.timeStamp).toLocaleString()),h.addClass(g.id),h.addClass(g.value),u.append(h)}}}function e(a,c){function d(a){return h.x(a*l)}function e(a){return h.y(a*m)+k/2}c=c.orderBy(ORDER_BY.FREQUENCY),q.empty();var f=b(q),g=SVG(q[0]).size(f.width,f.height),h={top:40,right:50,bottom:40,left:50,x:function(a){return a+this.left},y:function(a){return a+this.top}},i=f.width-h.left-h.right,j=f.height-h.top-h.bottom,k=8,l=Math.min(i/a.length,30),m=(j-k)/(c.length-1),n=g.group();n.rect(i,j).move(h.x(0),h.y(0)).attr("class","f"),n.text2(""+a.length).move(h.x(i),h.y(j)).font({anchor:"middle"});for(var o=g.group(),p=0;p<c.length;p++){var r=c[p];n.text2(String.fromCharCode(r.charCode).toUpperCase()).move(d(0)-20,e(p)-15).font({anchor:"middle"}).attr("class","l");for(var s=0;s<a.length;s++){var t=a[s],u=t.histogram,v=u[r.charCode];if(v){var w=Lesson.confidenceLevel(v.t),x=LessonUi.confidenceColor(w);o.rect(l,k).move(d(s),e(p)-k/2).fill(x.toString()).attr("class","b")}}}}function f(a){function d(b){return j.x(b/a.length*k)}function e(a){return j.y(l-a/m*l)}{var f=a.linearRegression(function(a){return c(a.speed)});a.linearRegression(function(a){return a.errors})}r.empty();var g,h=b(r),i=SVG(r[0]).size(h.width,h.height),j={top:40,right:50,bottom:40,left:50,x:function(a){return a+this.left},y:function(a){return a+this.top}},k=h.width-j.left-j.right,l=h.height-j.top-j.bottom,m=0,n=0;for(g=0;g<a.length;g++)m=Math.max(m,c(a[g].speed)),n=Math.max(n,a[g].errors);var o=i.group();o.rect(k,l).move(j.x(0),j.y(0)).attr("class","f"),o.line(j.x(0),j.y(.25*l),j.x(k),j.y(.25*l)).attr("class","f"),o.line(j.x(0),j.y(.5*l),j.x(k),j.y(.5*l)).attr("class","f"),o.line(j.x(0),j.y(.75*l),j.x(k),j.y(.75*l)).attr("class","f"),o.line(j.x(0),j.y(0),j.x(l),j.y(0)).attr("class","f"),o.line(j.x(.25*k),j.y(0),j.x(.25*k),j.y(l)).attr("class","f"),o.line(j.x(.5*k),j.y(0),j.x(.5*k),j.y(l)).attr("class","f"),o.line(j.x(.75*k),j.y(0),j.x(.75*k),j.y(l)).attr("class","f");var p=20;o.line(j.x(-p),j.y(l),j.x(k+p),j.y(l)).attr("class","f axis"),o.line(j.x(0),j.y(-p),j.x(0),j.y(l+p)).attr("class","f axis"),o.text2(""+Math.round(m)).move(j.x(0)-8,j.y(0)-12).font({anchor:"end"}),o.text2(""+a.length).move(j.x(k),j.y(l)).font({anchor:"middle"});var q=i.group(),s=Math.max(Math.min(k/a.length,24),12);for(g=0;g<a.length;g++)q.circle(s).center(d(g),e(c(a[g].speed))).attr("class","s");var t=0;q.line(d(-t),e(f.fn(-t)),d(a.length+t),e(f.fn(a.length+t))).attr("class","rs")}function g(a,c){c=c.orderBy(ORDER_BY.INDEX),s.empty();var d,e,f=b(s),g=SVG(s[0]).size(f.width,f.height),h={top:40,right:50,bottom:40,left:50,x:function(a){return a+this.left},y:function(a){return a+this.top}},i=f.width-h.left-h.right,j=f.height-h.top-h.bottom,k=new Histogram(a),l=5,m=(i+l)/c.length,n=0,o=0;for(e=0;e<c.length;e++)d=k.data[c[e].charCode],d&&(n=Math.max(n,d.h),o=Math.max(o,d.m));var p=.7*j,q=.3*j-10,r=g.group();r.rect(i,p).move(h.x(0),h.y(0)).attr("class","f"),r.rect(i,q).move(h.x(0),h.y(j-q)).attr("class","f");var t=g.group();for(e=0;e<c.length;e++){var u=h.x(e*m);if(d=k.data[c[e].charCode]){var v=d.h/n*p,w=d.m/o*q;t.rect(m-l,v).move(u,h.y(p-v)).attr("class","b h").title(d.h),t.rect(m-l,w).move(u,h.y(j-w)).attr("class","b m").title(d.m)}var x=d?"l":"l empty";t.text2(String.fromCharCode(c[e].charCode).toUpperCase()).move(u+m/2-l/2,h.y(j)).font({anchor:"middle"}).attr("class",x)}}function h(a,c){c=c.orderBy(ORDER_BY.INDEX),t.empty();var d,e,f=b(t),g=SVG(t[0]).size(f.width,f.height),h={top:40,right:50,bottom:40,left:50,x:function(a){return a+this.left},y:function(a){return a+this.top}},i=f.width-h.left-h.right,j=f.height-h.top-h.bottom,k=a.keyAverageTimes(),l=5,m=(i+l)/c.length,n=0;for(e=0;e<c.length;e++)d=k[c[e].charCode],d&&(n=Math.max(n,d));var o=g.group();o.rect(i,j).move(h.x(0),h.y(0)).attr("class","f");var p=g.group();for(e=0;e<c.length;e++){var q=h.x(e*m);if(d=k[c[e].charCode]){var r=d/n*j;p.rect(m-l,r).move(q,h.y(j-r)).attr("class","b").title(round(d,100)+"ms")}var s=d?"l":"l empty";p.text2(String.fromCharCode(c[e].charCode).toUpperCase()).move(q+m/2-l/2,h.y(j)).font({anchor:"middle"}).attr("class",s)}}function i(a){for(var b=new DateX(Date.now()),c=Object.create(null),d=a.groupByDate(),e=0;e<d.length;e++){var f=d[e],g=f.date.year+"-"+f.date.month,h=c[g];void 0===h&&(c[g]=h=new k(f.date.year,f.date.month));for(var i=0;i<f.data.length;i++)h.add(f.date.day,f.data[i])}var j=mapValues(c).sort(function(a,b){return a.timeStamp-b.timeStamp});0==j.length&&j.push(new k(b.year,b.month));var l=$("#calendar");l.empty();for(var m=0;m<j.length;m++)l.append($(j[m].build()))}function j(a){this.day=a,this.count=0,this.time=0}function k(a,b){this.year=a,this.month=b,this.cell=[];var c=new Date(this.year,this.month-1,1,12,0,0,0);this.timeStamp=c.getTime(),this.dayOffset=0==c.getDay()?6:c.getDay()-1;for(var d=0;42>d;d++)if(d<this.dayOffset)this.cell[d]=null;else{var e=d-this.dayOffset,f=new Date(c.getTime()+1e3*e*60*60*24);this.cell[d]=c.getMonth()==f.getMonth()?new j(e+1):null}}function l(a){function b(a){return 10>a?"0"+a:a}var c=a/3600|0;a-=3600*c;var d=a/60|0;a-=60*d;var e=0|a;return b(c)+":"+b(d)+":"+b(e)}function m(a,b){var j=a.statistics();if(j.count){v.text(l(j.totalTime/1e3)),w.text(j.count),x.text(Math.round(c(j.topSpeed))),y.text(Math.round(c(j.avgSpeed)));var k=a.today().statistics();k.count?z.text(Math.round(c(k.avgSpeed))):z.text("N/A")}else v.text(l(0)),w.text("0"),x.text("N/A"),y.text("N/A"),z.text("N/A");d(a),e(a,b),f(a,b),g(a,b),h(a,b),i(a)}function n(){function b(a,b,c){var d=fromCode(MODE_TYPE,a),f=fromCode(LAYOUT,b),g=d.title+" / "+f.name,h=d.id+":"+f.id;e[h]={modeType:d,layout:f,data:c},B.add(g,h)}var c=a.settings,d=a.history.data,e=Object.create(null);B.clear(),$.each(d.group(),function(a,c){$.each(c,function(c,d){b(a,c,d)})});var f=c.mode.type.id,g=c.layout.id,h=f+":"+g;void 0===e[h]&&b(f,g,new ResultArray),B.change=function(a,b){var c=e[b];LanguageModel.get(c.layout.lang).load(function(a){m(c.data,a.charSet)})},B.select(h),D&&(window.URL.revokeObjectURL(D),D=null),C=new Blob([JSON.stringify(d)],{type:"application/json"}),D=window.URL.createObjectURL(C),A.each(function(a,b){b.href=D,b.download="typing-data.json"})}function o(){D&&(window.URL.revokeObjectURL(D),D=null),C=null}var p=$("#group-list"),q=$("#svg-chart-progress"),r=$("#svg-chart-speed"),s=$("#svg-histogram-frequency"),t=$("#svg-histogram-proficiency"),u=$("#achievements"),v=$("#g-s-total-time"),w=$("#g-s-total-samples"),x=$("#g-s-top-speed"),y=$("#g-s-avg-speed"),z=$("#g-s-avg-speed-today"),A=$("#download-data"),B=new DropDown(p);SVG.Text2=function(){SVG.Text.call(this),this.styles={}},SVG.Text2.prototype=new SVG.Text,SVG.Text2.prototype.x=function(a,b){return null==a?b?this.attr("x"):this.bbox().x:(this.textPath||this.lines.each(function(){this.newLined&&this.x(a)}),this.attr("x",a))},SVG.extend(SVG.Container,{text2:function(a){return this.put(new SVG.Text2).text(a)}}),SVG.extend(SVG.Element,{title:function(a){var b=SVG.create("title");return b.textContent=a,this.node.insertBefore(b,this.node.firstChild),this}}),j.prototype.add=function(a){this.count++,this.time+=a.time},j.prototype.className=function(){return this.count>30?"s3":this.count>20?"s2":this.count>10?"s1":this.count>0?"s0":"z"},k.prototype.add=function(a,b){this.cell[a+this.dayOffset-1].add(b)
},k.prototype.build=function(){var a=_dom.el("div","calendar"),b=_dom.el("table"),c=_dom.el("caption",null,this.year+"/"+this.month);b.appendChild(c);var d=_dom.el("tr");d.appendChild(_dom.el("th",null,"M")),d.appendChild(_dom.el("th",null,"T")),d.appendChild(_dom.el("th",null,"W")),d.appendChild(_dom.el("th",null,"T")),d.appendChild(_dom.el("th",null,"F")),d.appendChild(_dom.el("th",null,"S")),d.appendChild(_dom.el("th",null,"S")),b.appendChild(d);for(var e=0;6>e;e++){for(var f=_dom.el("tr"),g=0;7>g;g++){var h,i=this.cell[7*e+g];null==i?h=_dom.el("td",null,null):(h=_dom.el("td",i.className(),i.day),i.count>0&&(h.title=i.count+" sample(s)")),f.appendChild(h)}b.appendChild(f)}return a.appendChild(b),a};var C=null,D=null;A.on("click",function(){return D&&window.navigator.msSaveBlob?(window.navigator.msSaveBlob(C,"typing-data.json"),!1):void 0}),document.addEventListener("reveal-page",function(a){"#profile"==a.detail.url?n():o()})}function Invaders(){}function initInvadersUi(){}function PageNavigation(a){function b(a){return document.dispatchEvent(new CustomEvent("hide-page",{detail:{url:a},bubbles:!0,cancelable:!0}))}function c(a){return document.dispatchEvent(new CustomEvent("reveal-page",{detail:{url:a},bubbles:!0,cancelable:!1}))}function d(a){return document.dispatchEvent(new CustomEvent("page-ready",{detail:{url:a},bubbles:!0,cancelable:!1}))}function e(a,b,c){b.detach(),a.append(c)}function f(a,b,c){function e(){b.detach(),n.detach(),c.detach(),$(document.body).removeClass("animating"),b.removeClass("animPageOut"),c.removeClass("animPageIn"),a.append(c),d(j.url)}var f=!1,g=!1;b.addClass("animPageOut"),c.addClass("animPageIn"),b.on(m,function(){b.off(m),f=!0,g&&e()}),c.on(m,function(){c.off(m),g=!0,f&&e()}),n.append(c),a.append(n),$(document.body).addClass("animating")}var g=new AnimationSupport;a=!!a&&g.supported;var h=$("#perspective"),i=$("section.page"),j={url:"#null",$page:h.children(),$links:$()},k=null,l={};if(a){var m=g.eventName("animation-end"),n=$("<div>").addClass("backstage");i.removeClass("animated")}this.reveal=function(g){if(g=g||k,j.url!=g){var i=l[g];i&&b(j.url)&&(a?f(h,j.$page,i.$page):e(h,j.$page,i.$page),j.$page.removeClass("current"),j.$links.removeClass("current"),i.$page.addClass("current"),i.$links.addClass("current"),j=i,c(j.url),a||d(j.url))}},this.init=function(){var a=this;i.each(function(b,c){var d=$(c),e=d.data("url");if(e){e="#"+e;var f=$("a[href="+e+"]");l[e]={url:e,$page:d,$links:f},f.on("click",function(b){b.isDefaultPrevented()||(b.preventDefault(),j.url!=e&&(window.history.pushState(null,"",e),a.reveal(e)))}),k=k||e}}),i.detach(),window.addEventListener("popstate",function(){a.reveal(window.location.hash)}),a.reveal(window.location.hash)}}function redirect(){var a=window.location;if("keybr.com"==a.hostname){var b=[a.protocol+"//","www.keybr.com",a.port?":"+a.port:"",a.pathname,a.search,a.path,a.hash].join("");window.location=b}}function changeTheme(a){var b=["theme0","theme0","theme0"];b.pickOne=function(){return this[Math.randomInt(0,this.length-1)]},a.theme?$(document.body).addClass(a.theme):$(document.body).addClass(b.pickOne())}function initFullScreen(){function a(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}$("#toggle-fullscreen").on("click",function(){a()})}function buildTrip(a){var b=[];return $(".hint").each(function(a,c){var d=$(c);b.push({sel:$(d.data("query")),content:d.html(),position:d.data("position")})}),new Trip(b,{tripTheme:"black",showNavigation:!0,showCloseBox:!0,delay:-1,onTripStart:function(){$(document.body).addClass("tour"),a.pause()},onTripStop:function(){$(document.body).removeClass("tour"),a.unpause()}})}function init(a,b){function c(b){var c=new FormData;c.append("cid",a),c.append("result",JSON.stringify(b));var d=window.location.protocol+"//"+window.location.host+"/watch",e=new XMLHttpRequest;e.onload=function(){}.bind(this),e.onerror=function(){}.bind(this),e.open("POST",d,!0),e.send(c)}initFullScreen(),initCommonUi();var d=new Settings(a),e=new Game(d);initSettingsUi(e),initProfileUi(e),initGameUi(e),initInvadersUi(e),e.init(function(){new PageNavigation(!b.flag("noanimate")).init(),d.loadLesson(function(a){e.start(a)}),window.game=e});var f=buildTrip(e);$(".button.tour").on("click",function(){return f.start(),!1});var g=d.newSettings;document.addEventListener("hide-page",function(a){console.log("hiding: "+a.detail.url),"#game"==a.detail.url&&f.stop()}),document.addEventListener("reveal-page",function(a){console.log("revealing: "+a.detail.url)}),document.addEventListener("page-ready",function(a){"#game"==a.detail.url&&g&&(g=!1,f.start())}),document.addEventListener("settings-changed",function(){}),document.addEventListener("fragment-complete",function(a){c(a.detail.result)})}var _svg={classList:{contains:function(a,b){if(a.classList)return a.classList.contains(b);var c=a.className.baseVal.split(/\s+/),d=c.indexOf(b);return-1!=d},add:function(a,b){if(a.classList)a.classList.add(b);else{var c=a.className.baseVal.split(/\s+/),d=c.indexOf(b);-1==d&&(c.push(b),a.className.baseVal=c.join(" "))}},remove:function(a,b){if(a.classList)a.classList.remove(b);else{var c=a.className.baseVal.split(/\s+/),d=c.indexOf(b);-1!=d&&(c.splice(d,1),a.className.baseVal=c.join(" "))}},toggle:function(a,b){if(a.classList)a.classList.toggle(b);else{var c=a.className.baseVal.split(/\s+/),d=c.indexOf(b);-1!=d?c.splice(d,1):c.push(b),a.className.baseVal=c.join(" ")}}}},_dom={el:function(a,b,c){if("object"==typeof a){var d=a;a=d.tagName,b=d.className,c=d.text}var e=document.createElement(a);if(b)if(b instanceof Array)for(var f=0;f<b.length;f++)e.classList.add(b[f]);else e.classList.add(b);return c&&(e.textContent=c),e},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)}};Math.randomInt=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},Math.normalRandom=normalRandom,Math.normalRandomInt=function(a,b){return Math.round(Math.normalRandom((a+b)/2,Math.sqrt(b-a)))},Identifier.toSimple=function(a){return a.split("-").map(function(a){return a.toLowerCase()}).join("")},Identifier.toPascalCase=function(a){return a.split("-").map(function(a){return a.substring(0,1).toUpperCase()+a.substring(1).toLowerCase()}).join("")},Identifier.toCamelCase=function(a){return a.split("-").map(function(a,b){return 0==b?a.toLowerCase():a.substring(0,1).toUpperCase()+a.substring(1).toLowerCase()}).join("")},Color.prototype.shade=function(a){function b(a,b){return a+=b,a>255?255:0>a?0:a}this.r=b(this.r,a),this.g=b(this.g,a),this.b=b(this.b,a)},Color.prototype.toHex=function(){function a(a){return 16>a?"0"+a.toString(16):a.toString(16)}return"#"+a(this.r)+a(this.g)+a(this.b)},Color.prototype.toRgb=function(){return"rgb("+this.r+","+this.g+","+this.b+")"},Color.prototype.toString=Color.prototype.toHex,DateX.prototype.toString=function(){return this.year+"-"+this.month+"-"+this.day},function(a){function b(b){return{path:b&&b.path||g.defaults.path,domain:b&&b.domain||g.defaults.domain,expires:b&&b.expires||g.defaults.expires,secure:b&&b.secure!==a?b.secure:g.defaults.secure}}function c(a,b){switch(b=b||new Date,typeof a){case"number":a=new Date(b.getTime()+1e3*a);break;case"string":a=new Date(a)}return a}function d(a,b,c){a=encodeURIComponent(a),b=encodeURIComponent(b),c=c||{};var d=a+"="+b;return c.path&&(d+=";path="+c.path),c.domain&&(d+=";domain="+c.domain),c.expires&&(d+=";expires="+c.expires.toUTCString()),c.secure&&(d+=";secure"),d}function e(b){for(var c={},d=b?b.split("; "):[],e=0;e<d.length;e++){var g=f(d[e]);c[g.key]===a&&(c[g.key]=g.value)}return c}function f(a){var b=a.indexOf("=");return b=-1===b?a.length:b,{key:decodeURIComponent(a.substring(0,b)),value:decodeURIComponent(a.substring(b+1))}}var g=function(a,b,c){return 1===arguments.length?g.get(a):g.set(a,b,c)};g.defaults={path:"/"},g.get=function(a){return e(document.cookie)[a]},g.set=function(e,f,h){return h=b(h),h.expires=c(f===a?-1:h.expires),document.cookie=d(e,f,h),g},g.expire=function(b,c){return g.set(b,a,c)},window.Cookies=g}();var watchProgress=function(){var a=$(document.body);return function(b){a.addClass("loading"),console.log("loading started"),b.addEventListener("load",function(){a.removeClass("loading"),console.log("loading completed")},!1),b.addEventListener("abort",function(){a.removeClass("loading"),console.log("loading aborted")},!1),b.addEventListener("error",function(){console.log("loading failed")},!1),b.addEventListener("progress",function(a){if(a.lengthComputable){var b=Math.floor(a.loaded/a.total*100);console.log("loading in progress: "+b+"%")}},!1)}}();DropDown.prototype={getValue:function(){return this.val},clear:function(){this.val=null,this.map=Object.create(null),this.$list.empty(),this.$placeholder.text("-")},add:function(a,b){b=b||a;var c=this,d=$('<a href="#"></a>').data("value",b).text(a),e=$("<li></li>").append(d);d.on("click",function(){return c.$el.removeClass("active"),c.select(b),!1}),this.$list.append(e),this.map[b]={text:a,value:b}},select:function(a){var b=this.map[a];b?(this.val=b.value,this.$placeholder.text(b.text),"function"==typeof this.change&&this.change(this,b.value)):(this.val=null,this.$placeholder.text("-"))}};var Unicode=Object.freeze({MIN_HIGH_SURROGATE:55296,MAX_HIGH_SURROGATE:56319,MIN_LOW_SURROGATE:56320,MAX_LOW_SURROGATE:57343,MIN_SURROGATE:this.MIN_HIGH_SURROGATE,MAX_SURROGATE:this.MAX_LOW_SURROGATE,MIN_SUPPLEMENTARY_CODE_POINT:65536,MIN_CODE_POINT:0,MAX_CODE_POINT:1114111,COMBINING_DIACRITICAL_MARK_MIN:768,COMBINING_DIACRITICAL_MARK_MAX:879,DIACRITIC_ACUTE:180,COMBINING_DIACRITIC_ACUTE:769,DIACRITIC_DOUBLE_ACUTE:733,COMBINING_DIACRITIC_DOUBLE_ACUTE:779,DIACRITIC_BREVE:728,COMBINING_DIACRITIC_BREVE:774,DIACRITIC_CARON:711,COMBINING_DIACRITIC_CARON:780,DIACRITIC_CEDILLA:184,COMBINING_DIACRITIC_CEDILLA:807,DIACRITIC_CIRCUMFLEX:710,COMBINING_DIACRITIC_CIRCUMFLEX:770,DIACRITIC_DIAERESIS:168,COMBINING_DIACRITIC_DIAERESIS:776,DIACRITIC_GRAVE:96,COMBINING_DIACRITIC_GRAVE:768,DIACRITIC_TILDE:126,COMBINING_DIACRITIC_TILDE:771,COMBINER_MAP:[],isValidCodePoint:function(a){return a>=this.MIN_CODE_POINT&&a<=this.MAX_CODE_POINT},isBmpCodePoint:function(a){return a>>>16==0},isSupplementaryCodePoint:function(a){return a>=this.MIN_SUPPLEMENTARY_CODE_POINT&&a<=this.MAX_CODE_POINT},isHighSurrogate:function(a){return a>=this.MIN_HIGH_SURROGATE&&a<=this.MAX_HIGH_SURROGATE},isLowSurrogate:function(a){return a>=this.MIN_LOW_SURROGATE&&a<=this.MAX_LOW_SURROGATE},isSurrogate:function(a){return a>=this.MIN_SURROGATE&&a<=this.MAX_SURROGATE},isSurrogatePair:function(a,b){return this.isHighSurrogate(a)&&this.isLowSurrogate(b)},isCombining:function(a){return this.isCombiningDiacriticalMark(a)},isCombiningDiacriticalMark:function(a){return a>=this.COMBINING_DIACRITICAL_MARK_MIN&&a<=this.COMBINING_DIACRITICAL_MARK_MAX},combine:function(a,b){var c=this.COMBINER_MAP[b];return c?c.combine(a):a},uncombine:function(a){for(var b=0;b<this.COMBINER_MAP.length;b++){var c=this.COMBINER_MAP[b];if(c){var d=c.uncombine(a);if(d!=a)return d}}return a},combinerImage:function(a){var b=this.COMBINER_MAP[a];return b?b.image:a},isWs:function(a){return"string"==typeof a&&(a=a.charCodeAt(0)),32==a||9==a||10==a||13==a||160==a||8192==a||8193==a||8194==a||8195==a||8232==a||8233==a},isNl:function(a){return"string"==typeof a&&(a=a.charCodeAt(0)),10==a||13==a||8232==a||8233==a}});UnicodeCombiner.prototype.combine=function(a){for(var b=this.from,c=this.to,d=0;d<b.length;d++)if(b.charCodeAt(d)==a)return c.charCodeAt(d);return a},UnicodeCombiner.prototype.uncombine=function(a){for(var b=this.from,c=this.to,d=0;d<c.length;d++)if(c.charCodeAt(d)==a)return b.charCodeAt(d);return a},UnicodeCombiner.initCombinerMap=function(a){function b(a,b,c,d,e){a[b]=new UnicodeCombiner(b,c,d,e)}a.length>0||(b(a,Unicode.COMBINING_DIACRITIC_ACUTE,Unicode.DIACRITIC_ACUTE,"AaCcEeGgIiKkLlMmNnOoPpRrSsUuWwYyZz","ÁáĆćÉéǴǵÍíḰḱĹĺḾḿŃńÓóṔṕŔŕŚśÚúẂẃÝýŹź"),b(a,Unicode.COMBINING_DIACRITIC_DOUBLE_ACUTE,Unicode.DIACRITIC_DOUBLE_ACUTE,"OoUu","ŐőŰű"),b(a,Unicode.COMBINING_DIACRITIC_CEDILLA,Unicode.DIACRITIC_CEDILLA,"CcDdEeGgHhKkLlNnRrSsTt","ÇçḐḑȨȩĢģḨḩĶķĻļŅņŖŗŞşŢţ"),b(a,Unicode.COMBINING_DIACRITIC_CIRCUMFLEX,Unicode.DIACRITIC_CIRCUMFLEX,"AaCcEeGgHhIiJjOoSsUuWwYyZz","ÂâĈĉÊêĜĝĤĥÎîĴĵÔôŜŝÛûŴŵŶŷẐẑ"),b(a,Unicode.COMBINING_DIACRITIC_DIAERESIS,Unicode.DIACRITIC_DIAERESIS,"AaEeHhIiOotUuWwXxYy","ÄäËëḦḧÏïÖöẗÜüẄẅẌẍŸÿ"),b(a,Unicode.COMBINING_DIACRITIC_GRAVE,Unicode.DIACRITIC_GRAVE,"AaEeIiNnOoUuWwYy","ÀàÈèÌìǸǹÒòÙùẀẁỲỳ"),b(a,Unicode.COMBINING_DIACRITIC_TILDE,Unicode.DIACRITIC_TILDE,"AaEeIiNnOoUuVvYy","ÃãẼẽĨĩÑñÕõŨũṼṽỸỹ"))},UnicodeCombiner.initCombinerMap(Unicode.COMBINER_MAP),function(){function a(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);if(-1!=b.indexOf(d))throw new Error("duplicate char code "+d);b.push(d)}return b}sanitizeText.NUMBER=a("0123456789"),sanitizeText.GRAPHICS=a("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~")}(),TextParser.SPLIT=">>>",TextParser.prototype.reset=function(){this.offset=0,this.next=null},TextParser.prototype.nextWord=function(a){for(a=void 0!==a?a:15;;){var b=this.next,c=this.nextWordImpl(a);if(null==c){if(null==b)return"empty";this.reset(),b!=TextParser.SPLIT&&(this.next=TextParser.SPLIT)}else{if(null==b&&c==TextParser.SPLIT)continue;if(null==b&&"\n"==c)continue;if(b==TextParser.SPLIT&&c==TextParser.SPLIT){this.next=TextParser.SPLIT;continue}if(b==TextParser.SPLIT&&"\n"==c){this.next=TextParser.SPLIT;continue}if("\n"==b&&c==TextParser.SPLIT){this.next=TextParser.SPLIT;continue}if("\n"==b&&"\n"==c){this.next="\n";continue}this.next=c}if(null!=b)return b}},TextParser.prototype.nextWordImpl=function(a){if(this.skipWs())return"\n";if(this.offset==this.text.length)return null;for(var b=this.offset;this.offset<this.text.length&&this.offset-b<a;){var c=this.text.charCodeAt(this.offset);if(Unicode.isWs(c))break;this.offset++}var d=this.text.substring(b,this.offset);return d==TextParser.SPLIT&&this.skipWs(),d},TextParser.prototype.skipWs=function(){for(var a=!1;this.offset<this.text.length;){var b=this.text.charCodeAt(this.offset);if(!Unicode.isWs(b))break;Unicode.isNl(b)&&(a=!0),this.offset++}return a},Censor.prototype.censor=function(a){for(var b=a,c=0;c<this.config.set.length;c++){var d=this.config.set[c];d.lastIndex=0,b=b.replace(d,"?")}return b};var CENSOR_EN=new Censor({set:["acrotomophilia","anal","anilingus","anus","arsehole","ass","asshole","assmunch","autoerotic","babeland","baby batter","ball gag","ball gravy","ball kicking","ball licking","ball sack","ball sucking","bangbros","bareback","barely legal","barenaked","bastardo","bastinado","bbw","bdsm","beaver cleaver","beaver lips","bestiality","big breasts","big knockers","big tits","bimbos","birdlock","bitch","blow j","blue waffle","blumpkin","bollocks","bondage","boner","boob","boobs","booty call","brown showers","brunette action","bukkake","bulldyke","bullet vibe","bung hole","bunghole","busty","butt","buttcheeks","butthole","camel toe","camgirl","camslut","camwhore","carpet muncher","carpetmuncher","chocolate rosebuds","circlejerk","clit","clitoris","clusterfuck","cock","cocks","coprolagnia","coprophilia","cornhole","cum","cumming","cunnilingus","cunt","darkie","date rape","daterape","deep throat","deepthroat","dick","dildo","dirty pillows","dirty sanchez","dog style","doggie style","doggiestyle","doggy style","doggystyle","dolcett","dominatrix","dommes","donkey punch","double dong","double penetration","dp action","eat my ass","ecchi","ejaculation","erotic","erotism","escort","ethical slut","eunuch","faggot","fecal","felch","fellatio","feltch","female squirting","femdom","figging","fingering","fisting","foot fetish","footjob","frotting","fuck","fucked","fucker","fucking","fuck buttons","fudge packer","fudgepacker","futanari","g-spot","gang bang","gay sex","genitals","giant cock","goatcx","goatse","gokkun","golden shower","goo girl","goodpoop","goregasm","grope","group sex","guro","hand job","handjob","hard core","hardcore","hentai","homoerotic","honkey","hooker","hot chick","how to kill","how to murder","huge fat","humping","incest","intercourse","jack off","jail bait","jailbait","jerk off","jigaboo","jiggaboo","jiggerboo","jizz","juggs","kike","kinbaku","kinkster","kinky","knobbing","leather restraint","leather straight jacket","lemon party","lolita","lovemaking","make me come","male squirting","masturbate","menage a trois","milf","mother fucker","motherfucker","mound of venus","mr hands","muff diver","muffdiving","nambla","nawashi","negro","neonazi","nig nog","nigga","nigger","nimphomania","nipple","nipples","nsfw images","nude","nudity","nympho","nymphomania","octopussy","omorashi","one cup two girls","one guy one jar","orgasm","orgy","paedophile","panties","panty","pedobear","pedophile","pegging","penis","phone sex","piece of shit","piss pig","pissing","pisspig","playboy","pleasure chest","pole smoker","ponyplay","poof","poop chute","poopchute","porn","porno","pornography","pubes","pussy","queaf","raghead","raging boner","rape","raping","rapist","rectum","reverse cowgirl","rimjob","rimming","rosy palm","rusty trombone","sadism","scat","schlong","scissoring","semen","sex","sexo","sexy","shaved beaver","shaved pussy","shemale","shibari","shit","shota","shrimping","slanteye","slut","smut","snatch","snowballing","sodomize","sodomy","spic","spooge","spread legs","strap on","strapon","strappado","strip club","style doggy","suck","sucks","suicide girls","sultry women","swastika","swinger","tainted love","taste my","tea bagging","threesome","throating","tied up","tight white","tit","tits","titties","titty","tongue in a","topless","tosser","towelhead","tranny","tribadism","tub girl","tubgirl","tushy","twat","twink","twinkie","two girls one cup","upskirt","urethra play","urophilia","vagina","venus mound","vibrator","violet blue","violet wand","vorarephilia","voyeur","vulva","wank","wet dream","wetback","white power","women rapping","wrapping men","wrinkled starfish","yaoi","yellow showers","yiffy","zoophilia"]}),CENSOR_EMPTY=new Censor({set:[]}),CENSOR={en:CENSOR_EN,de:CENSOR_EMPTY,fr:CENSOR_EMPTY,it:CENSOR_EMPTY,es:CENSOR_EMPTY,pt:CENSOR_EMPTY,ru:CENSOR_EMPTY,get:function(a){if("string"==typeof a)return CENSOR[a];if("object"==typeof a)return CENSOR[a.code];throw new Error}};Generator.prototype.nextFragment=function(){throw new Error},DummyGenerator.prototype=new Generator,DummyGenerator.prototype.nextFragment=function(){return this.text},StaticTextGenerator.prototype=new Generator,StaticTextGenerator.prototype.nextWord=function(){return this.word=this.parser.nextWord(this.wordLimit)},StaticTextGenerator.prototype.nextFragment=function(){for(var a="",b=0,c=" ";this.word!=TextParser.SPLIT&&5>b;){if(""==a)"\n"!=this.word&&(a=this.word);else if("\n"==this.word)c="\n",b++;else{if(a.length+this.word.length+1>this.fragmentLimit)break;a=a+c+this.word,c=" "}this.nextWord()}for(;this.word==TextParser.SPLIT;)this.nextWord();return a};var ORDER_BY=function(){return Object.freeze({FREQUENCY:"F",INDEX:"N"})}();RandomWordsGenerator.prototype=new Generator,RandomWordsGenerator.prototype.nextWord=function(){throw new Error},RandomWordsGenerator.prototype.nextFragment=function(){throw new Error},RandomWordsGenerator.prototype.getBoostFactor=function(a){for(var b=0,c=null,d=0;d<this.charSet.length;d++){var e=this.charSet[d];e.charCode==a&&(c=e.f),b=Math.max(b,e.f)}if(null==c)throw new Error;return b/c},LanguageModel.cache={},LanguageModel.get=function(a){var b=LanguageModel.cache[a];return b||(LanguageModel.cache[a]=b=new LanguageModel(a)),b};var LANGUAGE={en:new Language("en","English"),de:new Language("de","German"),fr:new Language("fr","French"),it:new Language("it","Italian"),es:new Language("es","Spanish"),pt:new Language("pt","Portuguese"),ru:new Language("ru","Russian")},VK_Name=[],VK=Object.freeze({BACK_SPACE:8,TAB:9,CLEAR:12,RETURN:13,SHIFT:16,CONTROL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,N0:48,N1:49,N2:50,N3:51,N4:52,N5:53,N6:54,N7:55,N8:56,N9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,CONTEXT_MENU:93,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,ADD:107,SEPARATOR:108,SUBTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,BACK_QUOTE:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,QUOTE:222,META:224,OEM_102:226,ALT_SEMICOLON:59,ALT_EQUALS:61,ALT_HYPHEN_MINUS:173,normalizeKeyCode:function(a){switch(a){case VK.ALT_SEMICOLON:return VK.SEMICOLON;case VK.ALT_EQUALS:return VK.EQUALS;case VK.ALT_HYPHEN_MINUS:return VK.DASH}return a},name:function(a){if(0==VK_Name.length)for(var b in this)VK_Name[this[b]]=b;var c=VK_Name[a];if(void 0===c)throw new Error("undefined key code: "+a);return c},isSpecialKey:function(a){return a.ctrlKey||a.metaKey||a.keyCode==VK.SHIFT||a.keyCode==VK.CONTROL||a.keyCode==VK.ALT||a.keyCode==VK.META||a.keyCode==VK.CAPS_LOCK||a.keyCode==VK.CONTEXT_MENU||a.keyCode==VK.F1||a.keyCode==VK.F2||a.keyCode==VK.F3||a.keyCode==VK.F4||a.keyCode==VK.F5||a.keyCode==VK.F6||a.keyCode==VK.F7||a.keyCode==VK.F8||a.keyCode==VK.F9||a.keyCode==VK.F10||a.keyCode==VK.F11||a.keyCode==VK.F12||a.keyCode==VK.F13||a.keyCode==VK.F14||a.keyCode==VK.F15||a.keyCode==VK.F16||a.keyCode==VK.INSERT||a.keyCode==VK.HOME||a.keyCode==VK.PAGE_UP||a.keyCode==VK.DELETE||a.keyCode==VK.END||a.keyCode==VK.PAGE_DOWN||a.keyCode==VK.UP||a.keyCode==VK.LEFT||a.keyCode==VK.DOWN||a.keyCode==VK.RIGHT||a.keyCode==VK.NUM_LOCK||a.keyCode==VK.SCROLL_LOCK}});CustomKeyboardEvent.prototype={preventDefault:function(){this.ev.preventDefault()},stopPropagation:function(){this.ev.stopPropagation()}},LayoutKey.prototype.charCode=function(a,b){function c(a,b,c,d){return d>0?d:c>0?c:b>0?b:a}return b?a?c(this.primary,this.primaryShift,this.secondary,this.secondaryShift):c(this.primary,this.secondary,0,0):a?c(this.primary,this.primaryShift,0,9):this.primary},LayoutKey.std=function(a,b,c,d,e,f){return new LayoutKey(a,a,b,c,d,e,f)},LayoutKey.ext=function(a,b,c,d,e,f,g){return new LayoutKey(a,b,c,d,e,f,g)},KeyCombo.prototype.applyDeadKey=function(a,b,c,d){return new KeyCombo(a,this.key,this.shift,this.alt,b,c,d)},Layout.prototype.configure=function(a){this.config.emulate=a.emulateLayout},Layout.prototype.createEventHandler=function(a){return new KeyboardEventHandler(this,a)},Layout.prototype.keyCombo=function(a){return this.comboMap[a]},Layout.prototype.hasCharacter=function(a){return null!=this.keyCombo(a)},Layout.prototype.complexity=function(a){for(var b=0,c=[],d=0;d<a.length;d++){var e=a.charCodeAt(d);if(-1==c.indexOf(e)){c.push(e);var f=this.keyCombo(e);f?b+=f.complexity:b++}}return b},Layout.prototype.getKeyPosition=function(a){var b=(KeyboardEvent.DOM_KEY_LOCATION_LEFT||1,KeyboardEvent.DOM_KEY_LOCATION_RIGHT||2),c=KeyboardEvent.DOM_KEY_LOCATION_NUMPAD||3;if(a.location==c)switch(a.keyCode){case VK.BACK_SPACE:return"numpad-backspace";case VK.RETURN:return"numpad-enter";case VK.INSERT:return VK.NUMPAD0;case VK.DELETE:return VK.DECIMAL;case VK.END:return VK.NUMPAD1;case VK.DOWN:return VK.NUMPAD2;case VK.PAGE_DOWN:return VK.NUMPAD3;case VK.LEFT:return VK.NUMPAD4;case VK.CLEAR:return VK.NUMPAD5;case VK.RIGHT:return VK.NUMPAD6;case VK.HOME:return VK.NUMPAD7;case VK.UP:return VK.NUMPAD8;case VK.PAGE_UP:return VK.NUMPAD9}switch(a.keyCode){case VK.SHIFT:return a.location==b?"rshift":"lshift";case VK.CONTROL:return a.location==b?"rctrl":"lctrl";case VK.ALT:return a.location==b?"ralt":"Lalt";case VK.BACK_SPACE:return VK.BACK_SPACE;case VK.TAB:return VK.TAB;case VK.RETURN:return VK.RETURN;case VK.CAPS_LOCK:return VK.CAPS_LOCK;case VK.SPACE:return VK.SPACE}if(this.config.emulate)return a.keyCode;var d=this.byKeyCode[a.keyCode];return d?d.position:a.keyCode},KeyboardEventHandler.prototype.keyDown=function(a){if(!(a.ctrlKey||a.altKey||a.metaKey)){switch(a.keyCode){case VK.BACK_SPACE:return this.sink(8),!0;case VK.TAB:return this.sink(9),!0;case VK.RETURN:return this.sink(10),!0;case VK.SPACE:return this.sink(32),!0;case VK.MULTIPLY:return this.sink(42),!0;case VK.ADD:return this.sink(43),!0;case VK.SUBTRACT:return this.sink(45),!0;case VK.DECIMAL:return this.sink(46),!0;case VK.DIVIDE:return this.sink(47),!0;case VK.NUMPAD0:return this.sink(48),!0;case VK.NUMPAD1:return this.sink(49),!0;case VK.NUMPAD2:return this.sink(50),!0;case VK.NUMPAD3:return this.sink(51),!0;case VK.NUMPAD4:return this.sink(52),!0;case VK.NUMPAD5:return this.sink(53),!0;case VK.NUMPAD6:return this.sink(54),!0;case VK.NUMPAD7:return this.sink(55),!0;case VK.NUMPAD8:return this.sink(56),!0;case VK.NUMPAD9:return this.sink(57),!0}var b;return b=this.layout.config.emulate?this.layout.byPosition[a.keyCode]:this.layout.byKeyCode[a.keyCode],b?a.shiftKey?(this.sink(b.primaryShift),!0):(this.sink(b.primary),!0):!1}},KeyboardEventHandler.prototype.keyUp=function(){},KeyboardShakeAnimation.prototype={init:function(){for(var a in this.keyMap)this.keyMap[a].initShake()},step:function(a){for(var b in this.keyMap)this.keyMap[b].stepShake(a)},reset:function(){for(var a in this.keyMap)this.keyMap[a].resetShake()}};var KeyboardUi=function(){function a(a){return"string"==typeof a&&(a=document.getElementById(a)),a=a.cloneNode(!0),a.setAttribute("id",SVG.eid("x")),a}function b(){}function c(a){return Unicode.isCombining(a)&&(a=Unicode.combinerImage(a)),String.fromCharCode(a)}return SVG.Key=function(b,c){SVG.Parent.call(this,a(c.ref)),this._layout=b,this._pos=c,this._key=this._layout.byPosition[this._pos.id],this.init(),this.move(this._pos.x,this._pos.y),this._pos.c&&_svg.classList.add(this.node,this._pos.c)},SVG.Key.prototype=new SVG.Parent,SVG.Key.prototype.init=function(){var a=this.node.querySelector(".symbol"),b=this.node.querySelector(".symbol-primary-shift"),d=this.node.querySelector(".symbol-primary"),e=this.node.querySelector(".symbol-secondary-shift"),f=this.node.querySelector(".symbol-secondary");this._key&&(this._key.alpha?(a.textContent=c(this._key.primary).toUpperCase(),this.node.removeChild(b),this.node.removeChild(d),this.node.removeChild(e),this.node.removeChild(f)):(this.node.removeChild(a),this._key.primaryShift?b.textContent=c(this._key.primaryShift):this.node.removeChild(b),this._key.primary?d.textContent=c(this._key.primary):this.node.removeChild(d),this._key.secondaryShift?e.textContent=c(this._key.secondaryShift):this.node.removeChild(e),this._key.secondary?f.textContent=c(this._key.secondary):this.node.removeChild(f)))},SVG.Key.prototype.state=function(a){a?_svg.classList.add(this.node,"down"):_svg.classList.remove(this.node,"down")},SVG.Key.prototype.initShake=function(){this._anim={x:this._pos.x,y:this._pos.y,rx:Math.randomInt(5,20)*(Math.randomInt(0,1)>0?1:-1),ry:Math.randomInt(5,20)*(Math.randomInt(0,1)>0?1:-1),sx:Math.randomInt(80,200),sy:Math.randomInt(80,200)}},SVG.Key.prototype.stepShake=function(a){this.move(this._anim.x+Math.sin(a/this._anim.sx)*this._anim.rx,this._anim.y+Math.cos(a/this._anim.sy)*this._anim.ry)},SVG.Key.prototype.resetShake=function(){this._anim=null,this.move(this._pos.x,this._pos.y)},b.prototype={init:function(a,b,c){function d(a,c,d){for(var e=0;e<d.length;e++){var f=d[e],g=new SVG.Key(b,f);a.add(g),c[f.id]=g}}this.layout=b,this.keyMap=[];var e=a.instance||new SVG.Container(a);e.clear(),d(e,this.keyMap,this.layout.geometry),c&&(d(e,this.keyMap,LAYOUT_GEOMETRY.CURSOR),d(e,this.keyMap,LAYOUT_GEOMETRY.NUMPAD))},keyDown:function(a){var b=this.layout.getKeyPosition(a),c=this.keyMap[b];c&&c.state(!0),this.unpressSpecial(a)},keyUp:function(a){var b=this.layout.getKeyPosition(a),c=this.keyMap[b];c&&c.state(!1),this.unpressSpecial(a)},unpressSpecial:function(a){a.ctrlKey||(this.keyMap.lctrl.state(!1),this.keyMap.rctrl.state(!1)),a.altKey||(this.keyMap.lalt.state(!1),this.keyMap.ralt.state(!1)),a.shiftKey||(this.keyMap.lshift.state(!1),this.keyMap.rshift.state(!1))},highlight:function(a,b){if(_dom.empty(a),b){var c=this.layout.geometryMap;switch(b){case 8:return this._highlight(a,c[VK.TAB]),void 0;case 10:return this._highlight(a,c[VK.RETURN]),void 0;case 32:return this._highlight(a,c[VK.SPACE]),void 0}var d=this.layout.keyCombo(b);d&&(this._highlight(a,c[d.key.position]),d.shift&&this._highlight(a,c.lshift),d.alt&&this._highlight(a,c.ralt),d.deadKey&&(this._highlight(a,c[d.deadKey.position]),d.deadShift&&!d.shift&&this._highlight(a,c.lshift),d.deadAlt&&!d.alt&&this._highlight(a,c.ralt)))}},_highlight:function(b,c){var d=this.keyMap[c.id],e=d.bbox(),f=(Math.min(e.width,e.height)/2+10,c.x+e.width/2),g=c.y+e.height/2,h=a("key-hl");h.setAttribute("x",f),h.setAttribute("y",g),b.appendChild(h)},reset:function(){for(var a in this.keyMap)this.keyMap[a].state(!1)},animation:null,createShakeAnimation:function(){return new KeyboardShakeAnimation(this.keyMap)}},b}(),LAYOUT_KEY_SET=function(){var a=Object.freeze([LayoutKey.std(VK.BACK_QUOTE,!1,96,126,null,null),LayoutKey.std(VK.N1,!1,49,33,null,null),LayoutKey.std(VK.N2,!1,50,64,null,null),LayoutKey.std(VK.N3,!1,51,35,null,null),LayoutKey.std(VK.N4,!1,52,36,null,null),LayoutKey.std(VK.N5,!1,53,37,null,null),LayoutKey.std(VK.N6,!1,54,94,null,null),LayoutKey.std(VK.N7,!1,55,38,null,null),LayoutKey.std(VK.N8,!1,56,42,null,null),LayoutKey.std(VK.N9,!1,57,40,null,null),LayoutKey.std(VK.N0,!1,48,41,null,null),LayoutKey.std(VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.EQUALS,!1,61,43,null,null),LayoutKey.std(VK.Q,!0,113,81,null,null),LayoutKey.std(VK.W,!0,119,87,null,null),LayoutKey.std(VK.E,!0,101,69,null,null),LayoutKey.std(VK.R,!0,114,82,null,null),LayoutKey.std(VK.T,!0,116,84,null,null),LayoutKey.std(VK.Y,!0,121,89,null,null),LayoutKey.std(VK.U,!0,117,85,null,null),LayoutKey.std(VK.I,!0,105,73,null,null),LayoutKey.std(VK.O,!0,111,79,null,null),LayoutKey.std(VK.P,!0,112,80,null,null),LayoutKey.std(VK.OPEN_BRACKET,!1,91,123,null,null),LayoutKey.std(VK.CLOSE_BRACKET,!1,93,125,null,null),LayoutKey.std(VK.BACK_SLASH,!1,92,124,null,null),LayoutKey.std(VK.A,!0,97,65,null,null),LayoutKey.std(VK.S,!0,115,83,null,null),LayoutKey.std(VK.D,!0,100,68,null,null),LayoutKey.std(VK.F,!0,102,70,null,null),LayoutKey.std(VK.G,!0,103,71,null,null),LayoutKey.std(VK.H,!0,104,72,null,null),LayoutKey.std(VK.J,!0,106,74,null,null),LayoutKey.std(VK.K,!0,107,75,null,null),LayoutKey.std(VK.L,!0,108,76,null,null),LayoutKey.std(VK.SEMICOLON,!1,59,58,null,null),LayoutKey.std(VK.QUOTE,!1,39,34,null,null),LayoutKey.std(VK.Z,!0,122,90,null,null),LayoutKey.std(VK.X,!0,120,88,null,null),LayoutKey.std(VK.C,!0,99,67,null,null),LayoutKey.std(VK.V,!0,118,86,null,null),LayoutKey.std(VK.B,!0,98,66,null,null),LayoutKey.std(VK.N,!0,110,78,null,null),LayoutKey.std(VK.M,!0,109,77,null,null),LayoutKey.std(VK.COMMA,!1,44,60,null,null),LayoutKey.std(VK.PERIOD,!1,46,62,null,null),LayoutKey.std(VK.SLASH,!1,47,63,null,null)]),b=Object.freeze([LayoutKey.std(VK.BACK_QUOTE,!1,96,172,166,null),LayoutKey.std(VK.N1,!1,49,33,null,null),LayoutKey.std(VK.N2,!1,50,34,null,null),LayoutKey.std(VK.N3,!1,51,163,null,null),LayoutKey.std(VK.N4,!1,52,36,8364,null),LayoutKey.std(VK.N5,!1,53,37,null,null),LayoutKey.std(VK.N6,!1,54,94,null,null),LayoutKey.std(VK.N7,!1,55,38,null,null),LayoutKey.std(VK.N8,!1,56,42,null,null),LayoutKey.std(VK.N9,!1,57,40,null,null),LayoutKey.std(VK.N0,!1,48,41,null,null),LayoutKey.std(VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.EQUALS,!1,61,43,null,null),LayoutKey.std(VK.Q,!0,113,81,null,null),LayoutKey.std(VK.W,!0,119,87,null,null),LayoutKey.std(VK.E,!0,101,69,201,null),LayoutKey.std(VK.R,!0,114,82,null,null),LayoutKey.std(VK.T,!0,116,84,null,null),LayoutKey.std(VK.Y,!0,121,89,null,null),LayoutKey.std(VK.U,!0,117,85,218,null),LayoutKey.std(VK.I,!0,105,73,205,null),LayoutKey.std(VK.O,!0,111,79,211,null),LayoutKey.std(VK.P,!0,112,80,null,null),LayoutKey.std(VK.OPEN_BRACKET,!1,91,123,null,null),LayoutKey.std(VK.CLOSE_BRACKET,!1,93,125,null,null),LayoutKey.std(VK.BACK_SLASH,!1,35,126,null,null),LayoutKey.std(VK.A,!0,97,65,193,null),LayoutKey.std(VK.S,!0,115,83,null,null),LayoutKey.std(VK.D,!0,100,68,null,null),LayoutKey.std(VK.F,!0,102,70,null,null),LayoutKey.std(VK.G,!0,103,71,null,null),LayoutKey.std(VK.H,!0,104,72,null,null),LayoutKey.std(VK.J,!0,106,74,null,null),LayoutKey.std(VK.K,!0,107,75,null,null),LayoutKey.std(VK.L,!0,108,76,null,null),LayoutKey.std(VK.SEMICOLON,!1,59,58,null,null),LayoutKey.std(VK.QUOTE,!1,39,64,null,null),LayoutKey.std(VK.Z,!0,122,90,null,null),LayoutKey.std(VK.X,!0,120,88,null,null),LayoutKey.std(VK.C,!0,99,67,null,null),LayoutKey.std(VK.V,!0,118,86,null,null),LayoutKey.std(VK.B,!0,98,66,null,null),LayoutKey.std(VK.N,!0,110,78,null,null),LayoutKey.std(VK.M,!0,109,77,null,null),LayoutKey.std(VK.COMMA,!1,44,60,null,null),LayoutKey.std(VK.PERIOD,!1,46,62,null,null),LayoutKey.std(VK.SLASH,!1,47,63,null,null),LayoutKey.std(VK.OEM_102,!1,92,124,null,null)]),c=Object.freeze([LayoutKey.std(VK.BACK_QUOTE,!1,96,126,null,null),LayoutKey.std(VK.N1,!1,49,33,null,null),LayoutKey.std(VK.N2,!1,50,64,null,null),LayoutKey.std(VK.N3,!1,51,163,null,null),LayoutKey.std(VK.N4,!1,52,36,null,null),LayoutKey.std(VK.N5,!1,53,37,null,null),LayoutKey.std(VK.N6,!1,54,94,null,null),LayoutKey.std(VK.N7,!1,55,38,null,null),LayoutKey.std(VK.N8,!1,56,42,null,null),LayoutKey.std(VK.N9,!1,57,40,null,null),LayoutKey.std(VK.N0,!1,48,41,null,null),LayoutKey.std(VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.EQUALS,!1,61,43,null,null),LayoutKey.std(VK.Q,!0,113,81,null,null),LayoutKey.std(VK.W,!0,119,87,null,null),LayoutKey.std(VK.E,!0,101,69,201,null),LayoutKey.std(VK.R,!0,114,82,null,null),LayoutKey.std(VK.T,!0,116,84,null,null),LayoutKey.std(VK.Y,!0,121,89,null,null),LayoutKey.std(VK.U,!0,117,85,null,null),LayoutKey.std(VK.I,!0,105,73,null,null),LayoutKey.std(VK.O,!0,111,79,null,null),LayoutKey.std(VK.P,!0,112,80,null,null),LayoutKey.std(VK.OPEN_BRACKET,!1,91,123,null,null),LayoutKey.std(VK.CLOSE_BRACKET,!1,93,125,null,null),LayoutKey.std(VK.BACK_SLASH,!1,92,124,null,null),LayoutKey.std(VK.A,!0,97,65,null,null),LayoutKey.std(VK.S,!0,115,83,null,null),LayoutKey.std(VK.D,!0,100,68,null,null),LayoutKey.std(VK.F,!0,102,70,null,null),LayoutKey.std(VK.G,!0,103,71,null,null),LayoutKey.std(VK.H,!0,104,72,null,null),LayoutKey.std(VK.J,!0,106,74,null,null),LayoutKey.std(VK.K,!0,107,75,null,null),LayoutKey.std(VK.L,!0,108,76,null,null),LayoutKey.std(VK.SEMICOLON,!1,59,58,null,null),LayoutKey.std(VK.QUOTE,!1,39,34,null,null),LayoutKey.std(VK.Z,!0,122,90,null,null),LayoutKey.std(VK.X,!0,120,88,null,null),LayoutKey.std(VK.C,!0,99,67,null,null),LayoutKey.std(VK.V,!0,118,86,null,null),LayoutKey.std(VK.B,!0,98,66,null,null),LayoutKey.std(VK.N,!0,110,78,null,null),LayoutKey.std(VK.M,!0,109,77,null,null),LayoutKey.std(VK.COMMA,!1,44,60,null,null),LayoutKey.std(VK.PERIOD,!1,46,62,null,null),LayoutKey.std(VK.SLASH,!1,47,63,null,null)]),d=Object.freeze([LayoutKey.std(VK.BACK_QUOTE,!1,"`","~",null,null),LayoutKey.std(VK.N1,!1,"1","!",null,null),LayoutKey.std(VK.N2,!1,"2","@",null,null),LayoutKey.std(VK.N3,!1,"3","#",null,null),LayoutKey.std(VK.N4,!1,"4","$",null,null),LayoutKey.std(VK.N5,!1,"5","%",null,null),LayoutKey.std(VK.N6,!1,"6","^",null,null),LayoutKey.std(VK.N7,!1,"7","&",null,null),LayoutKey.std(VK.N8,!1,"8","*",null,null),LayoutKey.std(VK.N9,!1,"9","(",null,null),LayoutKey.std(VK.N0,!1,"0",")",null,null),LayoutKey.ext(VK.DASH,VK.OPEN_BRACKET,!1,"[","{",null,null),LayoutKey.ext(VK.EQUALS,VK.CLOSE_BRACKET,!1,"]","}",null,null),LayoutKey.ext(VK.Q,VK.QUOTE,!1,"'",'"',null,null),LayoutKey.ext(VK.W,VK.COMMA,!1,",","<",null,null),LayoutKey.ext(VK.E,VK.PERIOD,!1,".",">",null,null),LayoutKey.ext(VK.R,VK.P,!0,"p","P",null,null),LayoutKey.ext(VK.T,VK.Y,!0,"y","Y",null,null),LayoutKey.ext(VK.Y,VK.F,!0,"f","F",null,null),LayoutKey.ext(VK.U,VK.G,!0,"g","G",null,null),LayoutKey.ext(VK.I,VK.C,!0,"c","C",null,null),LayoutKey.ext(VK.O,VK.R,!0,"r","R",null,null),LayoutKey.ext(VK.P,VK.L,!0,"l","L",null,null),LayoutKey.ext(VK.OPEN_BRACKET,VK.SLASH,!1,"/","?",null,null),LayoutKey.ext(VK.CLOSE_BRACKET,VK.EQUALS,!1,"=","+",null,null),LayoutKey.std(VK.BACK_SLASH,!1,"\\","|",null,null),LayoutKey.std(VK.A,!0,"a","A",null,null),LayoutKey.ext(VK.S,VK.O,!0,"o","O",null,null),LayoutKey.ext(VK.D,VK.E,!0,"e","E",null,null),LayoutKey.ext(VK.F,VK.U,!0,"u","U",null,null),LayoutKey.ext(VK.G,VK.I,!0,"i","I",null,null),LayoutKey.ext(VK.H,VK.D,!0,"d","D",null,null),LayoutKey.ext(VK.J,VK.H,!0,"h","H",null,null),LayoutKey.ext(VK.K,VK.T,!0,"t","T",null,null),LayoutKey.ext(VK.L,VK.N,!0,"n","N",null,null),LayoutKey.ext(VK.SEMICOLON,VK.S,!0,"s","S",null,null),LayoutKey.ext(VK.QUOTE,VK.DASH,!1,"-","_",null,null),LayoutKey.ext(VK.Z,VK.SEMICOLON,!1,";",":",null,null),LayoutKey.ext(VK.X,VK.Q,!0,"q","Q",null,null),LayoutKey.ext(VK.C,VK.J,!0,"j","J",null,null),LayoutKey.ext(VK.V,VK.K,!0,"k","K",null,null),LayoutKey.ext(VK.B,VK.X,!0,"x","X",null,null),LayoutKey.ext(VK.N,VK.B,!0,"b","B",null,null),LayoutKey.std(VK.M,!0,"m","M",null,null),LayoutKey.ext(VK.COMMA,VK.W,!0,"w","W",null,null),LayoutKey.ext(VK.PERIOD,VK.V,!0,"v","V",null,null),LayoutKey.ext(VK.SLASH,VK.Z,!0,"z","Z",null,null)]),e=Object.freeze([LayoutKey.std(VK.BACK_QUOTE,!1,"`","~",null,null),LayoutKey.std(VK.N1,!1,"1","!",null,null),LayoutKey.std(VK.N2,!1,"2","@",null,null),LayoutKey.std(VK.N3,!1,"3","#",null,null),LayoutKey.std(VK.N4,!1,"4","$",null,null),LayoutKey.std(VK.N5,!1,"5","%",null,null),LayoutKey.std(VK.N6,!1,"6","^",null,null),LayoutKey.std(VK.N7,!1,"7","&",null,null),LayoutKey.std(VK.N8,!1,"8","*",null,null),LayoutKey.std(VK.N9,!1,"9","(",null,null),LayoutKey.std(VK.N0,!1,"0",")",null,null),LayoutKey.std(VK.DASH,!1,"[","{",null,null),LayoutKey.std(VK.EQUALS,!1,"]","}",null,null),LayoutKey.ext(VK.Q,VK.QUOTE,!1,"'",'"',null,null),LayoutKey.ext(VK.W,VK.COMMA,!1,",","<",null,null),LayoutKey.ext(VK.E,VK.PERIOD,!1,".",">",null,null),LayoutKey.ext(VK.R,VK.P,!0,"p","P",null,null),LayoutKey.ext(VK.T,VK.Y,!0,"y","Y",null,null),LayoutKey.ext(VK.Y,VK.F,!0,"f","F",null,null),LayoutKey.ext(VK.U,VK.G,!0,"g","G",null,null),LayoutKey.ext(VK.I,VK.C,!0,"c","C",null,null),LayoutKey.ext(VK.O,VK.R,!0,"r","R",null,null),LayoutKey.ext(VK.P,VK.L,!0,"l","L",null,null),LayoutKey.std(VK.OPEN_BRACKET,!1,"/","?",null,null),LayoutKey.std(VK.CLOSE_BRACKET,!1,"=","+",null,null),LayoutKey.std(VK.BACK_SLASH,!1,"\\","|",null,null),LayoutKey.std(VK.A,!0,"a","A",null,null),LayoutKey.ext(VK.S,VK.O,!0,"o","O",null,null),LayoutKey.ext(VK.D,VK.E,!0,"e","E",null,null),LayoutKey.ext(VK.F,VK.U,!0,"u","U",null,null),LayoutKey.ext(VK.G,VK.I,!0,"i","I",null,null),LayoutKey.ext(VK.H,VK.D,!0,"d","D",null,null),LayoutKey.ext(VK.J,VK.H,!0,"h","H",null,null),LayoutKey.ext(VK.K,VK.T,!0,"t","T",null,null),LayoutKey.ext(VK.L,VK.N,!0,"n","N",null,null),LayoutKey.std(VK.SEMICOLON,!0,"s","S",null,null),LayoutKey.std(VK.QUOTE,!1,"-","_",null,null),LayoutKey.ext(VK.Z,VK.SEMICOLON,!1,";",":",null,null),LayoutKey.ext(VK.X,VK.Q,!0,"q","Q",null,null),LayoutKey.ext(VK.C,VK.J,!0,"j","J",null,null),LayoutKey.ext(VK.V,VK.K,!0,"k","K",null,null),LayoutKey.ext(VK.B,VK.X,!0,"x","X",null,null),LayoutKey.ext(VK.N,VK.B,!0,"b","B",null,null),LayoutKey.std(VK.M,!0,"m","M",null,null),LayoutKey.std(VK.COMMA,!0,"w","W",null,null),LayoutKey.std(VK.PERIOD,!0,"v","V",null,null),LayoutKey.std(VK.SLASH,!0,"z","Z",null,null)]),f=Object.freeze([LayoutKey.std(VK.BACK_QUOTE,!1,"`","~",null,null),LayoutKey.std(VK.N1,!1,"1","!",null,null),LayoutKey.std(VK.N2,!1,"2","@",null,null),LayoutKey.std(VK.N3,!1,"3","#",null,null),LayoutKey.std(VK.N4,!1,"4","$",null,null),LayoutKey.std(VK.N5,!1,"5","%",null,null),LayoutKey.std(VK.N6,!1,"6","^",null,null),LayoutKey.std(VK.N7,!1,"7","&",null,null),LayoutKey.std(VK.N8,!1,"8","*",null,null),LayoutKey.std(VK.N9,!1,"9","(",null,null),LayoutKey.std(VK.N0,!1,"0",")",null,null),LayoutKey.std(VK.DASH,!1,"-","_",null,null),LayoutKey.std(VK.EQUALS,!1,"=","+",null,null),LayoutKey.std(VK.Q,!0,"q","Q",null,null),LayoutKey.std(VK.W,!0,"w","W",null,null),LayoutKey.ext(VK.E,VK.F,!0,"f","F",null,null),LayoutKey.ext(VK.R,VK.P,!0,"p","P",null,null),LayoutKey.ext(VK.T,VK.G,!0,"g","G",null,null),LayoutKey.ext(VK.Y,VK.J,!0,"j","J",null,null),LayoutKey.ext(VK.U,VK.L,!0,"l","L",null,null),LayoutKey.ext(VK.I,VK.U,!0,"u","U",null,null),LayoutKey.ext(VK.O,VK.Y,!0,"y","Y",null,null),LayoutKey.ext(VK.P,VK.SEMICOLON,!1,";",":",null,null),LayoutKey.std(VK.OPEN_BRACKET,!1,"[","{",null,null),LayoutKey.std(VK.CLOSE_BRACKET,!1,"]","}",null,null),LayoutKey.std(VK.BACK_SLASH,!1,"\\","|",null,null),LayoutKey.std(VK.A,!0,"a","A",null,null),LayoutKey.ext(VK.S,VK.R,!0,"r","R",null,null),LayoutKey.ext(VK.D,VK.S,!0,"s","S",null,null),LayoutKey.ext(VK.F,VK.T,!0,"t","T",null,null),LayoutKey.ext(VK.G,VK.D,!0,"d","D",null,null),LayoutKey.std(VK.H,!0,"h","H",null,null),LayoutKey.ext(VK.J,VK.N,!0,"n","N",null,null),LayoutKey.ext(VK.K,VK.E,!0,"e","E",null,null),LayoutKey.ext(VK.L,VK.I,!0,"i","I",null,null),LayoutKey.ext(VK.SEMICOLON,VK.O,!0,"o","O",null,null),LayoutKey.std(VK.QUOTE,!1,"'",'"',null,null),LayoutKey.std(VK.Z,!0,"z","Z",null,null),LayoutKey.std(VK.X,!0,"x","X",null,null),LayoutKey.std(VK.C,!0,"c","C",null,null),LayoutKey.std(VK.V,!0,"v","V",null,null),LayoutKey.std(VK.B,!0,"b","B",null,null),LayoutKey.ext(VK.N,VK.K,!0,"k","K",null,null),LayoutKey.std(VK.M,!0,"m","M",null,null),LayoutKey.std(VK.COMMA,!1,",","<",null,null),LayoutKey.std(VK.PERIOD,!1,".",">",null,null),LayoutKey.std(VK.SLASH,!1,"/","?",null,null)]),g=Object.freeze([LayoutKey.std(VK.BACK_QUOTE,!1,"`","~",null,null),LayoutKey.std(VK.N1,!1,"1","!",null,null),LayoutKey.std(VK.N2,!1,"2","@",null,null),LayoutKey.std(VK.N3,!1,"3","#",null,null),LayoutKey.std(VK.N4,!1,"4","$",null,null),LayoutKey.std(VK.N5,!1,"5","%",null,null),LayoutKey.std(VK.N6,!1,"6","^",null,null),LayoutKey.std(VK.N7,!1,"7","&",null,null),LayoutKey.std(VK.N8,!1,"8","*",null,null),LayoutKey.std(VK.N9,!1,"9","(",null,null),LayoutKey.std(VK.N0,!1,"0",")",null,null),LayoutKey.std(VK.DASH,!1,"-","_",null,null),LayoutKey.std(VK.EQUALS,!1,"=","+",null,null),LayoutKey.std(VK.Q,!0,"q","Q",null,null),LayoutKey.std(VK.W,!0,"w","W",null,null),LayoutKey.ext(VK.E,VK.F,!0,"f","F",null,null),LayoutKey.ext(VK.R,VK.P,!0,"p","P",null,null),LayoutKey.ext(VK.T,VK.G,!0,"g","G",null,null),LayoutKey.ext(VK.Y,VK.J,!0,"j","J",null,null),LayoutKey.ext(VK.U,VK.L,!0,"l","L",null,null),LayoutKey.ext(VK.I,VK.U,!0,"u","U",null,null),LayoutKey.ext(VK.O,VK.Y,!0,"y","Y",null,null),LayoutKey.ext(VK.P,VK.SEMICOLON,!1,";",":",null,null),LayoutKey.std(VK.OPEN_BRACKET,!1,"[","{",null,null),LayoutKey.std(VK.CLOSE_BRACKET,!1,"]","}",null,null),LayoutKey.std(VK.BACK_SLASH,!1,"\\","|",null,null),LayoutKey.std(VK.A,!0,"a","A",null,null),LayoutKey.ext(VK.S,VK.R,!0,"r","R",null,null),LayoutKey.ext(VK.D,VK.S,!0,"s","S",null,null),LayoutKey.ext(VK.F,VK.T,!0,"t","T",null,null),LayoutKey.ext(VK.G,VK.D,!0,"d","D",null,null),LayoutKey.std(VK.H,!0,"h","H",null,null),LayoutKey.ext(VK.J,VK.N,!0,"n","N",null,null),LayoutKey.ext(VK.K,VK.E,!0,"e","E",null,null),LayoutKey.ext(VK.L,VK.I,!0,"i","I",null,null),LayoutKey.std(VK.SEMICOLON,!0,"o","O",null,null),LayoutKey.std(VK.QUOTE,!1,"'",'"',null,null),LayoutKey.std(VK.Z,!0,"z","Z",null,null),LayoutKey.std(VK.X,!0,"x","X",null,null),LayoutKey.std(VK.C,!0,"c","C",null,null),LayoutKey.std(VK.V,!0,"v","V",null,null),LayoutKey.std(VK.B,!0,"b","B",null,null),LayoutKey.ext(VK.N,VK.K,!0,"k","K",null,null),LayoutKey.std(VK.M,!0,"m","M",null,null),LayoutKey.std(VK.COMMA,!1,",","<",null,null),LayoutKey.std(VK.PERIOD,!1,".",">",null,null),LayoutKey.std(VK.SLASH,!1,"/","?",null,null)]),h=Object.freeze([LayoutKey.ext(VK.BACK_QUOTE,VK.BACK_SLASH,!1,770,176,null,null),LayoutKey.std(VK.N1,!1,49,33,null,null),LayoutKey.std(VK.N2,!1,50,34,178,null),LayoutKey.std(VK.N3,!1,51,167,179,null),LayoutKey.std(VK.N4,!1,52,36,null,null),LayoutKey.std(VK.N5,!1,53,37,null,null),LayoutKey.std(VK.N6,!1,54,38,null,null),LayoutKey.std(VK.N7,!1,55,47,123,null),LayoutKey.std(VK.N8,!1,56,40,91,null),LayoutKey.std(VK.N9,!1,57,41,93,null),LayoutKey.std(VK.N0,!1,48,61,125,null),LayoutKey.ext(VK.DASH,VK.OPEN_BRACKET,!1,223,63,92,null),LayoutKey.ext(VK.EQUALS,VK.CLOSE_BRACKET,!1,769,768,null,null),LayoutKey.std(VK.Q,!0,113,81,64,null),LayoutKey.std(VK.W,!0,119,87,null,null),LayoutKey.std(VK.E,!0,101,69,8364,null),LayoutKey.std(VK.R,!0,114,82,null,null),LayoutKey.std(VK.T,!0,116,84,null,null),LayoutKey.ext(VK.Y,VK.Z,!0,122,90,null,null),LayoutKey.std(VK.U,!0,117,85,null,null),LayoutKey.std(VK.I,!0,105,73,null,null),LayoutKey.std(VK.O,!0,111,79,null,null),LayoutKey.std(VK.P,!0,112,80,null,null),LayoutKey.ext(VK.OPEN_BRACKET,VK.SEMICOLON,!0,252,220,null,null),LayoutKey.ext(VK.CLOSE_BRACKET,VK.EQUALS,!1,43,42,771,null),LayoutKey.ext(VK.BACK_SLASH,VK.SLASH,!1,35,39,null,null),LayoutKey.std(VK.A,!0,97,65,null,null),LayoutKey.std(VK.S,!0,115,83,null,null),LayoutKey.std(VK.D,!0,100,68,null,null),LayoutKey.std(VK.F,!0,102,70,null,null),LayoutKey.std(VK.G,!0,103,71,null,null),LayoutKey.std(VK.H,!0,104,72,null,null),LayoutKey.std(VK.J,!0,106,74,null,null),LayoutKey.std(VK.K,!0,107,75,null,null),LayoutKey.std(VK.L,!0,108,76,null,null),LayoutKey.ext(VK.SEMICOLON,VK.BACK_QUOTE,!0,246,214,null,null),LayoutKey.std(VK.QUOTE,!0,228,196,null,null),LayoutKey.ext(VK.Z,VK.Y,!0,121,89,null,null),LayoutKey.std(VK.X,!0,120,88,null,null),LayoutKey.std(VK.C,!0,99,67,null,null),LayoutKey.std(VK.V,!0,118,86,null,null),LayoutKey.std(VK.B,!0,98,66,null,null),LayoutKey.std(VK.N,!0,110,78,null,null),LayoutKey.std(VK.M,!0,109,77,181,null),LayoutKey.std(VK.COMMA,!1,44,59,null,null),LayoutKey.std(VK.PERIOD,!1,46,58,null,null),LayoutKey.ext(VK.SLASH,VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.OEM_102,!1,60,62,124,null)]),i=Object.freeze([LayoutKey.ext(VK.BACK_QUOTE,VK.SLASH,!1,167,176,null,null),LayoutKey.std(VK.N1,!1,49,43,166,null),LayoutKey.std(VK.N2,!1,50,34,64,null),LayoutKey.std(VK.N3,!1,51,42,35,null),LayoutKey.std(VK.N4,!1,52,231,null,null),LayoutKey.std(VK.N5,!1,53,37,null,null),LayoutKey.std(VK.N6,!1,54,38,172,null),LayoutKey.std(VK.N7,!1,55,47,124,null),LayoutKey.std(VK.N8,!1,56,40,162,null),LayoutKey.std(VK.N9,!1,57,41,null,null),LayoutKey.std(VK.N0,!1,48,61,null,null),LayoutKey.ext(VK.DASH,VK.OPEN_BRACKET,!1,39,63,769,null),LayoutKey.ext(VK.EQUALS,VK.CLOSE_BRACKET,!1,770,768,771,null),LayoutKey.std(VK.Q,!0,113,81,null,null),LayoutKey.std(VK.W,!0,119,87,null,null),LayoutKey.std(VK.E,!0,101,69,8364,null),LayoutKey.std(VK.R,!0,114,82,null,null),LayoutKey.std(VK.T,!0,116,84,null,null),LayoutKey.ext(VK.Y,VK.Z,!0,122,90,null,null),LayoutKey.std(VK.U,!0,117,85,null,null),LayoutKey.std(VK.I,!0,105,73,null,null),LayoutKey.std(VK.O,!0,111,79,null,null),LayoutKey.std(VK.P,!0,112,80,null,null),LayoutKey.ext(VK.OPEN_BRACKET,VK.SEMICOLON,!1,252,232,91,null),LayoutKey.ext(VK.CLOSE_BRACKET,VK.BACK_QUOTE,!1,776,33,93,null),LayoutKey.std(VK.A,!0,97,65,null,null),LayoutKey.std(VK.S,!0,115,83,null,null),LayoutKey.std(VK.D,!0,100,68,null,null),LayoutKey.std(VK.F,!0,102,70,null,null),LayoutKey.std(VK.G,!0,103,71,null,null),LayoutKey.std(VK.H,!0,104,72,null,null),LayoutKey.std(VK.J,!0,106,74,null,null),LayoutKey.std(VK.K,!0,107,75,null,null),LayoutKey.std(VK.L,!0,108,76,null,null),LayoutKey.ext(VK.SEMICOLON,VK.QUOTE,!1,246,233,null,null),LayoutKey.ext(VK.QUOTE,VK.BACK_SLASH,!1,228,224,123,null),LayoutKey.ext(VK.BACK_SLASH,223,!1,36,163,125,null),LayoutKey.ext(VK.Z,VK.Y,!0,121,89,null,null),LayoutKey.std(VK.X,!0,120,88,null,null),LayoutKey.std(VK.C,!0,99,67,null,null),LayoutKey.std(VK.V,!0,118,86,null,null),LayoutKey.std(VK.B,!0,98,66,null,null),LayoutKey.std(VK.N,!0,110,78,null,null),LayoutKey.std(VK.M,!0,109,77,null,null),LayoutKey.std(VK.COMMA,!1,44,59,null,null),LayoutKey.std(VK.PERIOD,!1,46,58,null,null),LayoutKey.ext(VK.SLASH,VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.OEM_102,!1,60,62,92,null)]),j=Object.freeze([LayoutKey.ext(VK.BACK_QUOTE,VK.QUOTE,!1,178,null,null,null),LayoutKey.std(VK.N1,!1,38,49,null,null),LayoutKey.std(VK.N2,!1,233,50,771,null),LayoutKey.std(VK.N3,!1,34,51,35,null),LayoutKey.std(VK.N4,!1,39,52,123,null),LayoutKey.std(VK.N5,!1,40,53,91,null),LayoutKey.std(VK.N6,!1,45,54,124,null),LayoutKey.std(VK.N7,!1,232,55,768,null),LayoutKey.std(VK.N8,!1,95,56,92,null),LayoutKey.std(VK.N9,!1,231,57,94,null),LayoutKey.std(VK.N0,!1,224,48,64,null),LayoutKey.ext(VK.DASH,VK.OPEN_BRACKET,!1,41,176,93,null),LayoutKey.std(VK.EQUALS,!1,61,43,125,null),LayoutKey.ext(VK.Q,VK.A,!0,97,65,null,null),LayoutKey.ext(VK.W,VK.Z,!0,122,90,null,null),LayoutKey.std(VK.E,!0,101,69,8364,null),LayoutKey.std(VK.R,!0,114,82,null,null),LayoutKey.std(VK.T,!0,116,84,null,null),LayoutKey.std(VK.Y,!0,121,89,null,null),LayoutKey.std(VK.U,!0,117,85,null,null),LayoutKey.std(VK.I,!0,105,73,null,null),LayoutKey.std(VK.O,!0,111,79,null,null),LayoutKey.std(VK.P,!0,112,80,null,null),LayoutKey.ext(VK.OPEN_BRACKET,VK.CLOSE_BRACKET,!1,770,776,null,null),LayoutKey.ext(VK.CLOSE_BRACKET,VK.SEMICOLON,!1,36,163,null,null),LayoutKey.std(VK.BACK_SLASH,!1,42,181,null,null),LayoutKey.ext(VK.A,VK.Q,!0,113,81,null,null),LayoutKey.std(VK.S,!0,115,83,null,null),LayoutKey.std(VK.D,!0,100,68,null,null),LayoutKey.std(VK.F,!0,102,70,null,null),LayoutKey.std(VK.G,!0,103,71,null,null),LayoutKey.std(VK.H,!0,104,72,null,null),LayoutKey.std(VK.J,!0,106,74,null,null),LayoutKey.std(VK.K,!0,107,75,null,null),LayoutKey.std(VK.L,!0,108,76,null,null),LayoutKey.ext(VK.SEMICOLON,VK.M,!0,109,77,null,null),LayoutKey.ext(VK.QUOTE,VK.BACK_QUOTE,!1,249,37,null,null),LayoutKey.ext(VK.Z,VK.W,!0,119,87,null,null),LayoutKey.std(VK.X,!0,120,88,null,null),LayoutKey.std(VK.C,!0,99,67,null,null),LayoutKey.std(VK.V,!0,118,86,null,null),LayoutKey.std(VK.B,!0,98,66,null,null),LayoutKey.std(VK.N,!0,110,78,null,null),LayoutKey.ext(VK.M,VK.COMMA,!1,44,63,null,null),LayoutKey.ext(VK.COMMA,VK.PERIOD,!1,59,46,null,null),LayoutKey.ext(VK.PERIOD,VK.SLASH,!1,58,47,null,null),LayoutKey.ext(VK.SLASH,223,!1,33,167,null,null),LayoutKey.std(VK.OEM_102,!1,60,62,null,null)]),k=Object.freeze([LayoutKey.ext(VK.BACK_QUOTE,VK.QUOTE,!1,47,92,124,null),LayoutKey.std(VK.N1,!1,49,33,null,null),LayoutKey.std(VK.N2,!1,50,64,null,null),LayoutKey.std(VK.N3,!1,51,35,null,null),LayoutKey.std(VK.N4,!1,52,36,164,null),LayoutKey.std(VK.N5,!1,53,37,null,null),LayoutKey.std(VK.N6,!1,54,63,null,null),LayoutKey.std(VK.N7,!1,55,38,123,null),LayoutKey.std(VK.N8,!1,56,42,125,null),LayoutKey.std(VK.N9,!1,57,40,91,null),LayoutKey.std(VK.N0,!1,48,41,93,null),LayoutKey.std(VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.EQUALS,!1,61,43,172,null),LayoutKey.std(VK.Q,!0,113,81,null,null),LayoutKey.std(VK.W,!0,119,87,null,null),LayoutKey.std(VK.E,!0,101,69,8364,null),LayoutKey.std(VK.R,!0,114,82,null,null),LayoutKey.std(VK.T,!0,116,84,null,null),LayoutKey.std(VK.Y,!0,121,89,null,null),LayoutKey.std(VK.U,!0,117,85,null,null),LayoutKey.std(VK.I,!0,105,73,null,null),LayoutKey.std(VK.O,!0,111,79,null,null),LayoutKey.std(VK.P,!0,112,80,null,null),LayoutKey.std(VK.OPEN_BRACKET,!1,770,776,768,null),LayoutKey.std(VK.CLOSE_BRACKET,!0,231,199,771,null),LayoutKey.std(VK.BACK_SLASH,!0,224,192,null,null),LayoutKey.std(VK.A,!0,97,65,null,null),LayoutKey.std(VK.S,!0,115,83,null,null),LayoutKey.std(VK.D,!0,100,68,null,null),LayoutKey.std(VK.F,!0,102,70,null,null),LayoutKey.std(VK.G,!0,103,71,null,null),LayoutKey.std(VK.H,!0,104,72,null,null),LayoutKey.std(VK.J,!0,106,74,null,null),LayoutKey.std(VK.K,!0,107,75,null,null),LayoutKey.std(VK.L,!0,108,76,null,null),LayoutKey.std(VK.SEMICOLON,!1,59,58,176,null),LayoutKey.ext(VK.QUOTE,VK.BACK_QUOTE,!0,232,200,null,null),LayoutKey.std(VK.Z,!0,122,90,171,null),LayoutKey.std(VK.X,!0,120,88,187,null),LayoutKey.std(VK.C,!0,99,67,null,null),LayoutKey.std(VK.V,!0,118,86,null,null),LayoutKey.std(VK.B,!0,98,66,null,null),LayoutKey.std(VK.N,!0,110,78,null,null),LayoutKey.std(VK.M,!0,109,77,null,null),LayoutKey.std(VK.COMMA,!1,44,39,60,null),LayoutKey.std(VK.PERIOD,!1,46,34,62,null),LayoutKey.std(VK.SLASH,!0,233,201,null,null),LayoutKey.std(VK.OEM_102,!0,249,217,null,null)]),l=Object.freeze([LayoutKey.ext(VK.BACK_QUOTE,VK.SLASH,!1,167,176,null,null),LayoutKey.std(VK.N1,!1,49,43,166,null),LayoutKey.std(VK.N2,!1,50,34,64,null),LayoutKey.std(VK.N3,!1,51,42,35,null),LayoutKey.std(VK.N4,!1,52,231,null,null),LayoutKey.std(VK.N5,!1,53,37,null,null),LayoutKey.std(VK.N6,!1,54,38,172,null),LayoutKey.std(VK.N7,!1,55,47,124,null),LayoutKey.std(VK.N8,!1,56,40,162,null),LayoutKey.std(VK.N9,!1,57,41,null,null),LayoutKey.std(VK.N0,!1,48,61,null,null),LayoutKey.ext(VK.DASH,VK.OPEN_BRACKET,!1,39,63,769,null),LayoutKey.ext(VK.EQUALS,VK.CLOSE_BRACKET,!1,770,768,771,null),LayoutKey.std(VK.Q,!0,113,81,null,null),LayoutKey.std(VK.W,!0,119,87,null,null),LayoutKey.std(VK.E,!0,101,69,8364,null),LayoutKey.std(VK.R,!0,114,82,null,null),LayoutKey.std(VK.T,!0,116,84,null,null),LayoutKey.ext(VK.Y,VK.Z,!0,122,90,null,null),LayoutKey.std(VK.U,!0,117,85,null,null),LayoutKey.std(VK.I,!0,105,73,null,null),LayoutKey.std(VK.O,!0,111,79,null,null),LayoutKey.std(VK.P,!0,112,80,null,null),LayoutKey.ext(VK.OPEN_BRACKET,VK.SEMICOLON,!1,232,252,91,null),LayoutKey.ext(VK.CLOSE_BRACKET,VK.BACK_QUOTE,!1,776,33,93,null),LayoutKey.std(VK.A,!0,97,65,null,null),LayoutKey.std(VK.S,!0,115,83,null,null),LayoutKey.std(VK.D,!0,100,68,null,null),LayoutKey.std(VK.F,!0,102,70,null,null),LayoutKey.std(VK.G,!0,103,71,null,null),LayoutKey.std(VK.H,!0,104,72,null,null),LayoutKey.std(VK.J,!0,106,74,null,null),LayoutKey.std(VK.K,!0,107,75,null,null),LayoutKey.std(VK.L,!0,108,76,null,null),LayoutKey.ext(VK.SEMICOLON,VK.QUOTE,!1,233,246,null,null),LayoutKey.ext(VK.QUOTE,VK.BACK_SLASH,!1,224,228,123,null),LayoutKey.ext(VK.BACK_SLASH,223,!1,36,163,125,null),LayoutKey.ext(VK.Z,VK.Y,!0,121,89,null,null),LayoutKey.std(VK.X,!0,120,88,null,null),LayoutKey.std(VK.C,!0,99,67,null,null),LayoutKey.std(VK.V,!0,118,86,null,null),LayoutKey.std(VK.B,!0,98,66,null,null),LayoutKey.std(VK.N,!0,110,78,null,null),LayoutKey.std(VK.M,!0,109,77,null,null),LayoutKey.std(VK.COMMA,!1,44,59,null,null),LayoutKey.std(VK.PERIOD,!1,46,58,null,null),LayoutKey.ext(VK.SLASH,VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.OEM_102,!1,60,62,92,null)]),m=Object.freeze([LayoutKey.ext(VK.BACK_QUOTE,VK.BACK_SLASH,!1,92,124,null,null),LayoutKey.std(VK.N1,!1,49,33,null,null),LayoutKey.std(VK.N2,!1,50,34,null,null),LayoutKey.std(VK.N3,!1,51,163,null,null),LayoutKey.std(VK.N4,!1,52,36,null,null),LayoutKey.std(VK.N5,!1,53,37,8364,null),LayoutKey.std(VK.N6,!1,54,38,null,null),LayoutKey.std(VK.N7,!1,55,47,null,null),LayoutKey.std(VK.N8,!1,56,40,null,null),LayoutKey.std(VK.N9,!1,57,41,null,null),LayoutKey.std(VK.N0,!1,48,61,null,null),LayoutKey.ext(VK.DASH,VK.OPEN_BRACKET,!1,39,63,null,null),LayoutKey.ext(VK.EQUALS,VK.CLOSE_BRACKET,!1,236,94,null,null),LayoutKey.std(VK.Q,!0,113,81,null,null),LayoutKey.std(VK.W,!0,119,87,null,null),LayoutKey.std(VK.E,!0,101,69,8364,null),LayoutKey.std(VK.R,!0,114,82,null,null),LayoutKey.std(VK.T,!0,116,84,null,null),LayoutKey.std(VK.Y,!0,121,89,null,null),LayoutKey.std(VK.U,!0,117,85,null,null),LayoutKey.std(VK.I,!0,105,73,null,null),LayoutKey.std(VK.O,!0,111,79,null,null),LayoutKey.std(VK.P,!0,112,80,null,null),LayoutKey.ext(VK.OPEN_BRACKET,VK.SEMICOLON,!1,232,233,91,123),LayoutKey.ext(VK.CLOSE_BRACKET,VK.EQUALS,!1,43,42,93,125),LayoutKey.ext(VK.BACK_SLASH,VK.SLASH,!1,249,167,null,null),LayoutKey.std(VK.A,!0,97,65,null,null),LayoutKey.std(VK.S,!0,115,83,null,null),LayoutKey.std(VK.D,!0,100,68,null,null),LayoutKey.std(VK.F,!0,102,70,null,null),LayoutKey.std(VK.G,!0,103,71,null,null),LayoutKey.std(VK.H,!0,104,72,null,null),LayoutKey.std(VK.J,!0,106,74,null,null),LayoutKey.std(VK.K,!0,107,75,null,null),LayoutKey.std(VK.L,!0,108,76,null,null),LayoutKey.ext(VK.SEMICOLON,VK.BACK_QUOTE,!1,242,231,64,null),LayoutKey.std(VK.QUOTE,!1,224,176,35,null),LayoutKey.std(VK.Z,!0,122,90,null,null),LayoutKey.std(VK.X,!0,120,88,null,null),LayoutKey.std(VK.C,!0,99,67,null,null),LayoutKey.std(VK.V,!0,118,86,null,null),LayoutKey.std(VK.B,!0,98,66,null,null),LayoutKey.std(VK.N,!0,110,78,null,null),LayoutKey.std(VK.M,!0,109,77,null,null),LayoutKey.std(VK.COMMA,!1,44,59,null,null),LayoutKey.std(VK.PERIOD,!1,46,58,null,null),LayoutKey.ext(VK.SLASH,VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.OEM_102,!1,60,62,null,null)]),n=Object.freeze([LayoutKey.std(VK.BACK_QUOTE,!1,39,34,null,null),LayoutKey.std(VK.N1,!1,49,33,185,null),LayoutKey.std(VK.N2,!1,50,64,178,null),LayoutKey.std(VK.N3,!1,51,35,179,null),LayoutKey.std(VK.N4,!1,52,36,163,null),LayoutKey.std(VK.N5,!1,53,37,162,null),LayoutKey.std(VK.N6,!1,54,776,172,null),LayoutKey.std(VK.N7,!1,55,38,null,null),LayoutKey.std(VK.N8,!1,56,42,null,null),LayoutKey.std(VK.N9,!1,57,40,null,null),LayoutKey.std(VK.N0,!1,48,41,null,null),LayoutKey.std(VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.EQUALS,!1,61,43,167,null),LayoutKey.std(VK.Q,!0,113,81,47,null),LayoutKey.std(VK.W,!0,119,87,63,null),LayoutKey.std(VK.E,!0,101,69,8364,null),LayoutKey.std(VK.R,!0,114,82,null,null),LayoutKey.std(VK.T,!0,116,84,null,null),LayoutKey.std(VK.Y,!0,121,89,null,null),LayoutKey.std(VK.U,!0,117,85,null,null),LayoutKey.std(VK.I,!0,105,73,null,null),LayoutKey.std(VK.O,!0,111,79,null,null),LayoutKey.std(VK.P,!0,112,80,null,null),LayoutKey.std(VK.OPEN_BRACKET,!1,769,768,null,null),LayoutKey.std(VK.CLOSE_BRACKET,!1,91,123,170,null),LayoutKey.std(VK.A,!0,97,65,null,null),LayoutKey.std(VK.S,!0,115,83,null,null),LayoutKey.std(VK.D,!0,100,68,null,null),LayoutKey.std(VK.F,!0,102,70,null,null),LayoutKey.std(VK.G,!0,103,71,null,null),LayoutKey.std(VK.H,!0,104,72,null,null),LayoutKey.std(VK.J,!0,106,74,null,null),LayoutKey.std(VK.K,!0,107,75,null,null),LayoutKey.std(VK.L,!0,108,76,null,null),LayoutKey.std(VK.SEMICOLON,!0,231,199,null,null),LayoutKey.std(VK.QUOTE,!1,771,770,null,null),LayoutKey.std(VK.BACK_SLASH,!1,93,125,186,null),LayoutKey.std(VK.Z,!0,122,90,null,null),LayoutKey.std(VK.X,!0,120,88,null,null),LayoutKey.std(VK.C,!0,99,67,null,null),LayoutKey.std(VK.V,!0,118,86,null,null),LayoutKey.std(VK.B,!0,98,66,null,null),LayoutKey.std(VK.N,!0,110,78,null,null),LayoutKey.std(VK.M,!0,109,77,null,null),LayoutKey.std(VK.COMMA,!1,44,60,null,null),LayoutKey.std(VK.PERIOD,!1,46,62,null,null),LayoutKey.std(VK.SLASH,!1,59,58,null,null),LayoutKey.std(VK.OEM_102,!1,92,124,null,null)]),o=Object.freeze([LayoutKey.std(VK.BACK_QUOTE,!0,1105,1025,null,null),LayoutKey.std(VK.N1,!1,49,33,null,null),LayoutKey.std(VK.N2,!1,50,34,null,null),LayoutKey.std(VK.N3,!1,51,8470,null,null),LayoutKey.std(VK.N4,!1,52,59,null,null),LayoutKey.std(VK.N5,!1,53,37,null,null),LayoutKey.std(VK.N6,!1,54,58,null,null),LayoutKey.std(VK.N7,!1,55,63,null,null),LayoutKey.std(VK.N8,!1,56,42,null,null),LayoutKey.std(VK.N9,!1,57,40,null,null),LayoutKey.std(VK.N0,!1,48,41,null,null),LayoutKey.std(VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.EQUALS,!1,61,43,null,null),LayoutKey.std(VK.Q,!0,1081,1049,null,null),LayoutKey.std(VK.W,!0,1094,1062,null,null),LayoutKey.std(VK.E,!0,1091,1059,null,null),LayoutKey.std(VK.R,!0,1082,1050,null,null),LayoutKey.std(VK.T,!0,1077,1045,null,null),LayoutKey.std(VK.Y,!0,1085,1053,null,null),LayoutKey.std(VK.U,!0,1075,1043,null,null),LayoutKey.std(VK.I,!0,1096,1064,null,null),LayoutKey.std(VK.O,!0,1097,1065,null,null),LayoutKey.std(VK.P,!0,1079,1047,null,null),LayoutKey.std(VK.OPEN_BRACKET,!0,1093,1061,null,null),LayoutKey.std(VK.CLOSE_BRACKET,!0,1098,1066,null,null),LayoutKey.std(VK.BACK_SLASH,!1,92,47,null,null),LayoutKey.std(VK.A,!0,1092,1060,null,null),LayoutKey.std(VK.S,!0,1099,1067,null,null),LayoutKey.std(VK.D,!0,1074,1042,null,null),LayoutKey.std(VK.F,!0,1072,1040,null,null),LayoutKey.std(VK.G,!0,1087,1055,null,null),LayoutKey.std(VK.H,!0,1088,1056,null,null),LayoutKey.std(VK.J,!0,1086,1054,null,null),LayoutKey.std(VK.K,!0,1083,1051,null,null),LayoutKey.std(VK.L,!0,1076,1044,null,null),LayoutKey.std(VK.SEMICOLON,!0,1078,1046,null,null),LayoutKey.std(VK.QUOTE,!0,1101,1069,null,null),LayoutKey.std(VK.Z,!0,1103,1071,null,null),LayoutKey.std(VK.X,!0,1095,1063,null,null),LayoutKey.std(VK.C,!0,1089,1057,null,null),LayoutKey.std(VK.V,!0,1084,1052,null,null),LayoutKey.std(VK.B,!0,1080,1048,null,null),LayoutKey.std(VK.N,!0,1090,1058,null,null),LayoutKey.std(VK.M,!0,1100,1068,null,null),LayoutKey.std(VK.COMMA,!0,1073,1041,null,null),LayoutKey.std(VK.PERIOD,!0,1102,1070,null,null),LayoutKey.std(VK.SLASH,!1,46,44,null,null)]),p=Object.freeze([LayoutKey.std(VK.BACK_QUOTE,!1,93,91,null,null),LayoutKey.std(VK.N1,!1,49,33,null,null),LayoutKey.std(VK.N2,!1,50,34,null,null),LayoutKey.std(VK.N3,!1,51,8470,null,null),LayoutKey.std(VK.N4,!1,52,37,null,null),LayoutKey.std(VK.N5,!1,53,58,null,null),LayoutKey.std(VK.N6,!1,54,44,null,null),LayoutKey.std(VK.N7,!1,55,46,null,null),LayoutKey.std(VK.N8,!1,56,59,null,null),LayoutKey.std(VK.N9,!1,57,40,null,null),LayoutKey.std(VK.N0,!1,48,41,null,null),LayoutKey.std(VK.DASH,!1,45,95,null,null),LayoutKey.std(VK.EQUALS,!1,61,43,null,null),LayoutKey.std(VK.Q,!0,1081,1049,null,null),LayoutKey.std(VK.W,!0,1094,1062,null,null),LayoutKey.std(VK.E,!0,1091,1059,null,null),LayoutKey.std(VK.R,!0,1082,1050,null,null),LayoutKey.std(VK.T,!0,1077,1045,null,null),LayoutKey.std(VK.Y,!0,1085,1053,null,null),LayoutKey.std(VK.U,!0,1075,1043,null,null),LayoutKey.std(VK.I,!0,1096,1064,null,null),LayoutKey.std(VK.O,!0,1097,1065,null,null),LayoutKey.std(VK.P,!0,1079,1047,null,null),LayoutKey.std(VK.OPEN_BRACKET,!0,1093,1061,null,null),LayoutKey.std(VK.CLOSE_BRACKET,!0,1098,1066,null,null),LayoutKey.std(VK.BACK_SLASH,!0,1105,1025,null,null),LayoutKey.std(VK.A,!0,1092,1060,null,null),LayoutKey.std(VK.S,!0,1099,1067,null,null),LayoutKey.std(VK.D,!0,1074,1042,null,null),LayoutKey.std(VK.F,!0,1072,1040,null,null),LayoutKey.std(VK.G,!0,1087,1055,null,null),LayoutKey.std(VK.H,!0,1088,1056,null,null),LayoutKey.std(VK.J,!0,1086,1054,null,null),LayoutKey.std(VK.K,!0,1083,1051,null,null),LayoutKey.std(VK.L,!0,1076,1044,null,null),LayoutKey.std(VK.SEMICOLON,!0,1078,1046,null,null),LayoutKey.std(VK.QUOTE,!0,1101,1069,null,null),LayoutKey.std(VK.Z,!0,1103,1071,null,null),LayoutKey.std(VK.X,!0,1095,1063,null,null),LayoutKey.std(VK.C,!0,1089,1057,null,null),LayoutKey.std(VK.V,!0,1084,1052,null,null),LayoutKey.std(VK.B,!0,1080,1048,null,null),LayoutKey.std(VK.N,!0,1090,1058,null,null),LayoutKey.std(VK.M,!0,1100,1068,null,null),LayoutKey.std(VK.COMMA,!0,1073,1041,null,null),LayoutKey.std(VK.PERIOD,!0,1102,1070,null,null),LayoutKey.std(VK.SLASH,!1,47,63,null,null)]);
return Object.freeze({ENGLISH_US_STANDARD:a,ENGLISH_UK_STANDARD_WIN:b,ENGLISH_UK_STANDARD_MAC:c,ENGLISH_US_DVORAK_WIN:d,ENGLISH_US_DVORAK_MAC:e,ENGLISH_US_COLEMAK_WIN:f,ENGLISH_US_COLEMAK_MAC:g,GERMAN_STANDARD:h,GERMAN_SWITZERLAND:i,FRENCH_STANDARD:j,FRENCH_CANADA:k,FRENCH_SWITZERLAND:l,ITALIAN_STANDARD:m,PORTUGUESE_BRAZIL:n,RUSSIAN_WIN:o,RUSSIAN_MAC:p})}(),LAYOUT_GEOMETRY=function(){var a=[{id:VK.BACK_QUOTE,x:0,y:0,ref:"key",c:"z1"},{id:VK.N1,x:42,y:0,ref:"key",c:"z1"},{id:VK.N2,x:84,y:0,ref:"key",c:"z2"},{id:VK.N3,x:126,y:0,ref:"key",c:"z3"},{id:VK.N4,x:168,y:0,ref:"key",c:"z4"},{id:VK.N5,x:210,y:0,ref:"key",c:"z4"},{id:VK.N6,x:252,y:0,ref:"key",c:"z5"},{id:VK.N7,x:294,y:0,ref:"key",c:"z5"},{id:VK.N8,x:336,y:0,ref:"key",c:"z6"},{id:VK.N9,x:378,y:0,ref:"key",c:"z7"},{id:VK.N0,x:420,y:0,ref:"key",c:"z8"},{id:VK.DASH,x:462,y:0,ref:"key",c:"z8"},{id:VK.EQUALS,x:504,y:0,ref:"key",c:"z8"},{id:VK.BACK_SPACE,x:546,y:0,ref:"key-backspace"},{id:VK.TAB,x:0,y:42,ref:"key-tab"},{id:VK.Q,x:65,y:42,ref:"key",c:"z1"},{id:VK.W,x:107,y:42,ref:"key",c:"z2"},{id:VK.E,x:149,y:42,ref:"key",c:"z3"},{id:VK.R,x:191,y:42,ref:"key",c:"z4"},{id:VK.T,x:233,y:42,ref:"key",c:"z4"},{id:VK.Y,x:275,y:42,ref:"key",c:"z5"},{id:VK.U,x:317,y:42,ref:"key",c:"z5"},{id:VK.I,x:359,y:42,ref:"key",c:"z6"},{id:VK.O,x:401,y:42,ref:"key",c:"z7"},{id:VK.P,x:443,y:42,ref:"key",c:"z8"},{id:VK.OPEN_BRACKET,x:485,y:42,ref:"key",c:"z8"},{id:VK.CLOSE_BRACKET,x:527,y:42,ref:"key",c:"z8"},{id:VK.CAPS_LOCK,x:0,y:84,ref:"key-caps-lock"},{id:VK.A,x:72,y:84,ref:"key",c:"z1"},{id:VK.S,x:114,y:84,ref:"key",c:"z2"},{id:VK.D,x:156,y:84,ref:"key",c:"z3"},{id:VK.F,x:198,y:84,ref:"key",c:"z4"},{id:VK.G,x:240,y:84,ref:"key",c:"z4"},{id:VK.H,x:282,y:84,ref:"key",c:"z5"},{id:VK.J,x:324,y:84,ref:"key",c:"z5"},{id:VK.K,x:366,y:84,ref:"key",c:"z6"},{id:VK.L,x:408,y:84,ref:"key",c:"z7"},{id:VK.SEMICOLON,x:450,y:84,ref:"key",c:"z8"},{id:VK.QUOTE,x:492,y:84,ref:"key",c:"z8"},{id:VK.BACK_SLASH,x:534,y:84,ref:"key",c:"z8"},{id:VK.RETURN,x:569,y:42,ref:"key-enter"},{id:"lshift",x:0,y:126,ref:"key-left-shift"},{id:VK.Z,x:94,y:126,ref:"key",c:"z1"},{id:VK.X,x:136,y:126,ref:"key",c:"z2"},{id:VK.C,x:178,y:126,ref:"key",c:"z3"},{id:VK.V,x:220,y:126,ref:"key",c:"z4"},{id:VK.B,x:262,y:126,ref:"key",c:"z4"},{id:VK.N,x:304,y:126,ref:"key",c:"z5"},{id:VK.M,x:346,y:126,ref:"key",c:"z5"},{id:VK.COMMA,x:388,y:126,ref:"key",c:"z6"},{id:VK.PERIOD,x:430,y:126,ref:"key",c:"z7"},{id:VK.SLASH,x:472,y:126,ref:"key",c:"z8"},{id:"rshift",x:514,y:126,ref:"key-right-shift"},{id:"lctrl",x:0,y:168,ref:"key-ctrl"},{id:"lalt",x:65,y:168,ref:"key-alt"},{id:VK.SPACE,x:130,y:168,ref:"key-space"},{id:"ralt",x:501,y:168,ref:"key-alt"},{id:"rctrl",x:566,y:168,ref:"key-ctrl"}],b=[{id:VK.BACK_QUOTE,x:0,y:0,ref:"key",c:"z1"},{id:VK.N1,x:42,y:0,ref:"key",c:"z1"},{id:VK.N2,x:84,y:0,ref:"key",c:"z2"},{id:VK.N3,x:126,y:0,ref:"key",c:"z3"},{id:VK.N4,x:168,y:0,ref:"key",c:"z4"},{id:VK.N5,x:210,y:0,ref:"key",c:"z4"},{id:VK.N6,x:252,y:0,ref:"key",c:"z5"},{id:VK.N7,x:294,y:0,ref:"key",c:"z5"},{id:VK.N8,x:336,y:0,ref:"key",c:"z6"},{id:VK.N9,x:378,y:0,ref:"key",c:"z7"},{id:VK.N0,x:420,y:0,ref:"key",c:"z8"},{id:VK.DASH,x:462,y:0,ref:"key",c:"z8"},{id:VK.EQUALS,x:504,y:0,ref:"key",c:"z8"},{id:VK.BACK_SPACE,x:546,y:0,ref:"key-backspace"},{id:VK.TAB,x:0,y:42,ref:"key-tab"},{id:VK.Q,x:65,y:42,ref:"key",c:"z1"},{id:VK.W,x:107,y:42,ref:"key",c:"z2"},{id:VK.E,x:149,y:42,ref:"key",c:"z3"},{id:VK.R,x:191,y:42,ref:"key",c:"z4"},{id:VK.T,x:233,y:42,ref:"key",c:"z4"},{id:VK.Y,x:275,y:42,ref:"key",c:"z5"},{id:VK.U,x:317,y:42,ref:"key",c:"z5"},{id:VK.I,x:359,y:42,ref:"key",c:"z6"},{id:VK.O,x:401,y:42,ref:"key",c:"z7"},{id:VK.P,x:443,y:42,ref:"key",c:"z8"},{id:VK.OPEN_BRACKET,x:485,y:42,ref:"key",c:"z8"},{id:VK.CLOSE_BRACKET,x:527,y:42,ref:"key",c:"z8"},{id:VK.CAPS_LOCK,x:0,y:84,ref:"key-caps-lock"},{id:VK.A,x:72,y:84,ref:"key",c:"z1"},{id:VK.S,x:114,y:84,ref:"key",c:"z2"},{id:VK.D,x:156,y:84,ref:"key",c:"z3"},{id:VK.F,x:198,y:84,ref:"key",c:"z4"},{id:VK.G,x:240,y:84,ref:"key",c:"z4"},{id:VK.H,x:282,y:84,ref:"key",c:"z5"},{id:VK.J,x:324,y:84,ref:"key",c:"z5"},{id:VK.K,x:366,y:84,ref:"key",c:"z6"},{id:VK.L,x:408,y:84,ref:"key",c:"z7"},{id:VK.SEMICOLON,x:450,y:84,ref:"key",c:"z8"},{id:VK.QUOTE,x:492,y:84,ref:"key",c:"z8"},{id:VK.BACK_SLASH,x:534,y:84,ref:"key",c:"z8"},{id:VK.RETURN,x:569,y:42,ref:"key-enter"},{id:"lshift",x:0,y:126,ref:"key-left-shift-small"},{id:VK.OEM_102,x:52,y:126,ref:"key",c:"z1"},{id:VK.Z,x:94,y:126,ref:"key",c:"z1"},{id:VK.X,x:136,y:126,ref:"key",c:"z2"},{id:VK.C,x:178,y:126,ref:"key",c:"z3"},{id:VK.V,x:220,y:126,ref:"key",c:"z4"},{id:VK.B,x:262,y:126,ref:"key",c:"z4"},{id:VK.N,x:304,y:126,ref:"key",c:"z5"},{id:VK.M,x:346,y:126,ref:"key",c:"z5"},{id:VK.COMMA,x:388,y:126,ref:"key",c:"z6"},{id:VK.PERIOD,x:430,y:126,ref:"key",c:"z7"},{id:VK.SLASH,x:472,y:126,ref:"key",c:"z8"},{id:"rshift",x:514,y:126,ref:"key-right-shift"},{id:"lctrl",x:0,y:168,ref:"key-ctrl"},{id:"lalt",x:65,y:168,ref:"key-alt"},{id:VK.SPACE,x:130,y:168,ref:"key-space"},{id:"ralt",x:501,y:168,ref:"key-alt-gr"},{id:"rctrl",x:566,y:168,ref:"key-ctrl"}],c=[{id:VK.BACK_QUOTE,x:0,y:0,ref:"key",c:"z1"},{id:VK.N1,x:42,y:0,ref:"key",c:"z1"},{id:VK.N2,x:84,y:0,ref:"key",c:"z2"},{id:VK.N3,x:126,y:0,ref:"key",c:"z3"},{id:VK.N4,x:168,y:0,ref:"key",c:"z4"},{id:VK.N5,x:210,y:0,ref:"key",c:"z4"},{id:VK.N6,x:252,y:0,ref:"key",c:"z5"},{id:VK.N7,x:294,y:0,ref:"key",c:"z5"},{id:VK.N8,x:336,y:0,ref:"key",c:"z6"},{id:VK.N9,x:378,y:0,ref:"key",c:"z7"},{id:VK.N0,x:420,y:0,ref:"key",c:"z8"},{id:VK.DASH,x:462,y:0,ref:"key",c:"z8"},{id:VK.EQUALS,x:504,y:0,ref:"key",c:"z8"},{id:VK.BACK_SPACE,x:546,y:0,ref:"key-backspace"},{id:VK.TAB,x:0,y:42,ref:"key-tab"},{id:VK.Q,x:65,y:42,ref:"key",c:"z1"},{id:VK.W,x:107,y:42,ref:"key",c:"z2"},{id:VK.E,x:149,y:42,ref:"key",c:"z3"},{id:VK.R,x:191,y:42,ref:"key",c:"z4"},{id:VK.T,x:233,y:42,ref:"key",c:"z4"},{id:VK.Y,x:275,y:42,ref:"key",c:"z5"},{id:VK.U,x:317,y:42,ref:"key",c:"z5"},{id:VK.I,x:359,y:42,ref:"key",c:"z6"},{id:VK.O,x:401,y:42,ref:"key",c:"z7"},{id:VK.P,x:443,y:42,ref:"key",c:"z8"},{id:VK.OPEN_BRACKET,x:485,y:42,ref:"key",c:"z8"},{id:VK.CLOSE_BRACKET,x:527,y:42,ref:"key",c:"z8"},{id:VK.BACK_SLASH,x:569,y:42,ref:"key-wide",c:"z8"},{id:VK.CAPS_LOCK,x:0,y:84,ref:"key-caps-lock"},{id:VK.A,x:72,y:84,ref:"key",c:"z1"},{id:VK.S,x:114,y:84,ref:"key",c:"z2"},{id:VK.D,x:156,y:84,ref:"key",c:"z3"},{id:VK.F,x:198,y:84,ref:"key",c:"z4"},{id:VK.G,x:240,y:84,ref:"key",c:"z4"},{id:VK.H,x:282,y:84,ref:"key",c:"z5"},{id:VK.J,x:324,y:84,ref:"key",c:"z5"},{id:VK.K,x:366,y:84,ref:"key",c:"z6"},{id:VK.L,x:408,y:84,ref:"key",c:"z7"},{id:VK.SEMICOLON,x:450,y:84,ref:"key",c:"z8"},{id:VK.QUOTE,x:492,y:84,ref:"key",c:"z8"},{id:VK.RETURN,x:534,y:84,ref:"key-enter-small"},{id:"lshift",x:0,y:126,ref:"key-left-shift"},{id:VK.Z,x:94,y:126,ref:"key",c:"z1"},{id:VK.X,x:136,y:126,ref:"key",c:"z2"},{id:VK.C,x:178,y:126,ref:"key",c:"z3"},{id:VK.V,x:220,y:126,ref:"key",c:"z4"},{id:VK.B,x:262,y:126,ref:"key",c:"z4"},{id:VK.N,x:304,y:126,ref:"key",c:"z5"},{id:VK.M,x:346,y:126,ref:"key",c:"z5"},{id:VK.COMMA,x:388,y:126,ref:"key",c:"z6"},{id:VK.PERIOD,x:430,y:126,ref:"key",c:"z7"},{id:VK.SLASH,x:472,y:126,ref:"key",c:"z8"},{id:"rshift",x:514,y:126,ref:"key-right-shift"},{id:"lctrl",x:0,y:168,ref:"key-ctrl"},{id:"lalt",x:65,y:168,ref:"key-alt"},{id:VK.SPACE,x:130,y:168,ref:"key-space"},{id:"ralt",x:501,y:168,ref:"key-alt"},{id:"rctrl",x:566,y:168,ref:"key-ctrl"}],d=[{id:VK.INSERT,x:648,y:0,ref:"key-insert"},{id:VK.HOME,x:690,y:0,ref:"key-home"},{id:VK.PAGE_UP,x:732,y:0,ref:"key-page-up"},{id:VK.DELETE,x:648,y:42,ref:"key-delete"},{id:VK.END,x:690,y:42,ref:"key-end"},{id:VK.PAGE_DOWN,x:732,y:42,ref:"key-page-down"},{id:VK.UP,x:690,y:126,ref:"key-up"},{id:VK.LEFT,x:648,y:168,ref:"key-left"},{id:VK.DOWN,x:690,y:168,ref:"key-down"},{id:VK.RIGHT,x:732,y:168,ref:"key-right"}],e=[{id:VK.NUM_LOCK,x:792,y:0,ref:"key-np-num-lock"},{id:VK.DIVIDE,x:834,y:0,ref:"key-np-divide"},{id:VK.MULTIPLY,x:876,y:0,ref:"key-np-multiply"},{id:VK.SUBTRACT,x:918,y:0,ref:"key-np-subtract"},{id:VK.NUMPAD7,x:792,y:42,ref:"key-np-7"},{id:VK.NUMPAD8,x:834,y:42,ref:"key-np-8"},{id:VK.NUMPAD9,x:876,y:42,ref:"key-np-9"},{id:VK.ADD,x:918,y:42,ref:"key-np-add"},{id:VK.NUMPAD4,x:792,y:84,ref:"key-np-4"},{id:VK.NUMPAD5,x:834,y:84,ref:"key-np-5"},{id:VK.NUMPAD6,x:876,y:84,ref:"key-np-6"},{id:VK.NUMPAD1,x:792,y:126,ref:"key-np-1"},{id:VK.NUMPAD2,x:834,y:126,ref:"key-np-2"},{id:VK.NUMPAD3,x:876,y:126,ref:"key-np-3"},{id:"numpad-enter",x:918,y:126,ref:"key-np-enter"},{id:VK.NUMPAD0,x:792,y:168,ref:"key-np-0"},{id:VK.DECIMAL,x:876,y:168,ref:"key-np-decimal"}];return Object.freeze({TYPE_A:a,TYPE_B:b,TYPE_C:c,CURSOR:d,NUMPAD:e})}(),LAYOUT=function(){var a=new Layout("us","English/US","en",LAYOUT_KEY_SET.ENGLISH_US_STANDARD,LAYOUT_GEOMETRY.TYPE_C,null),b=new Layout("uk","English/UK","en",LAYOUT_KEY_SET.ENGLISH_UK_STANDARD_WIN,LAYOUT_GEOMETRY.TYPE_B,null),c=new Layout("uk","English/UK","en",LAYOUT_KEY_SET.ENGLISH_UK_STANDARD_MAC,LAYOUT_GEOMETRY.TYPE_B,a),d=new Layout("us-dvorak","English/US - Dvorak","en",LAYOUT_KEY_SET.ENGLISH_US_DVORAK_WIN,LAYOUT_GEOMETRY.TYPE_C,a),e=new Layout("us-dvorak","English/US - Dvorak","en",LAYOUT_KEY_SET.ENGLISH_US_DVORAK_MAC,LAYOUT_GEOMETRY.TYPE_C,a),f=new Layout("us-colemak","English/US - Colemak","en",LAYOUT_KEY_SET.ENGLISH_US_COLEMAK_WIN,LAYOUT_GEOMETRY.TYPE_C,a),g=new Layout("us-colemak","English/US - Colemak","en",LAYOUT_KEY_SET.ENGLISH_US_COLEMAK_MAC,LAYOUT_GEOMETRY.TYPE_C,a),h=new Layout("de","German/Germany","de",LAYOUT_KEY_SET.GERMAN_STANDARD,LAYOUT_GEOMETRY.TYPE_B,null),i=new Layout("de-ch","German/Switzerland","de",LAYOUT_KEY_SET.GERMAN_SWITZERLAND,LAYOUT_GEOMETRY.TYPE_B,null),j=new Layout("fr","French/France","fr",LAYOUT_KEY_SET.FRENCH_STANDARD,LAYOUT_GEOMETRY.TYPE_B,null),k=new Layout("fr-ca","French/Canada","fr",LAYOUT_KEY_SET.FRENCH_CANADA,LAYOUT_GEOMETRY.TYPE_B,null),l=new Layout("fr-ch","French/Switzerland","fr",LAYOUT_KEY_SET.FRENCH_SWITZERLAND,LAYOUT_GEOMETRY.TYPE_B,null),m=new Layout("it","Italian/Italy","it",LAYOUT_KEY_SET.ITALIAN_STANDARD,LAYOUT_GEOMETRY.TYPE_B,null),n=new Layout("pt-br","Portuguese/Brazil","pt",LAYOUT_KEY_SET.PORTUGUESE_BRAZIL,LAYOUT_GEOMETRY.TYPE_B,null),o=new Layout("ru","Cyrillic/Russia (Win)","ru",LAYOUT_KEY_SET.RUSSIAN_WIN,LAYOUT_GEOMETRY.TYPE_A,null),p=new Layout("ru","Cyrillic/Russia (Mac)","ru",LAYOUT_KEY_SET.RUSSIAN_MAC,LAYOUT_GEOMETRY.TYPE_C,null),q=navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)?!0:!1;return Object.freeze({ENGLISH_US_STANDARD:a,ENGLISH_UK_STANDARD:q?c:b,ENGLISH_US_DVORAK:q?e:d,ENGLISH_US_COLEMAK:q?g:f,GERMAN_STANDARD:h,GERMAN_SWITZERLAND:i,FRENCH_STANDARD:j,FRENCH_CANADA:k,FRENCH_SWITZERLAND:l,ITALIAN_STANDARD:m,PORTUGUESE_BRAZIL:n,RUSSIAN:q?p:o})}();Sounds.prototype={init:function(a){function b(a){return[c+a+".ogg",c+a+".mp3",c+a+".wav"]}var c="/res/sound/";if(a.enableSound){if(null==this.library){this.library=Object.create(null);for(var d=["click","blip","correct","wrong","tada"],e=0;e<d.length;e++)this.library[d[e]]=new Howl({urls:b(d[e])})}}else this.library=null},play:function(a){if(this.library){var b=this.library[a];if(!b)throw new Error;b.stop(),b.play()}}};var sounds=new Sounds,__now=function(){return window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()}}(),MODE_TYPE=function(){return Object.freeze({AUTO:new ModeType("auto","Computer-generated lessons"),CUSTOM:new ModeType("custom","User-provided lessons")})}(),MODE=function(){return Object.freeze({GUIDED:new Mode("guided",MODE_TYPE.AUTO),IMPORT_WEBSITE:new Mode("import_website",MODE_TYPE.CUSTOM),IMPORT_TEXT:new Mode("import_text",MODE_TYPE.CUSTOM)})}(),SPEED_UNIT=function(){var a=new SpeedUnit("wpm","Words per minute",function(a){return a/5}),b=new SpeedUnit("cpm","Characters per minute",function(a){return a});return Object.freeze({WPM:a,CPM:b})}();Settings.DEFAULT_LAYOUT=LAYOUT.ENGLISH_US_STANDARD,Settings.DEFAULT_MODE=MODE.GUIDED,Settings.prototype.reload=function(){function a(a,b){return null==a?!!b:!!a}var b=window.localStorage.getObject("settings");null==b?b={}:this.newSettings=!1,b.layout=b.layout||"",b.mode=b.mode||"",b.lesson=b.lesson||{},b.text=b.text||{},b.text.mangle=b.text.mangle||{},this.layout=fromCode(LAYOUT,b.layout,Settings.DEFAULT_LAYOUT),this.emulateLayout=a(b.emulateLayout,!1),this.mode=fromCode(MODE,b.mode,Settings.DEFAULT_MODE),this.lesson.complexity=Math.max(0,Math.min(1,parseFloat(b.lesson.complexity)||0)),this.lesson.length=Math.max(0,Math.min(1,parseFloat(b.lesson.length)||0)),this.lesson.capitals=a(b.lesson.capitals,!1),this.lesson.punctuators=a(b.lesson.punctuators,!1),this.speedUnit=fromCode(SPEED_UNIT,b.speedUnit,SPEED_UNIT.WPM),this.enableSound=a(b.enableSound,!1),this.textConfig.url=b.text.url||"",this.textConfig.text=b.text.text||"",this.textConfig.mangle.simplify=a(b.text.mangle.simplify,!0),this.textConfig.mangle.lowercase=a(b.text.mangle.lowercase,!0),this.textConfig.mangle.censor=a(b.text.mangle.censor,!0)},Settings.prototype.persist=function(){window.localStorage.setObject("settings",{layout:this.layout.id,emulateLayout:this.emulateLayout,mode:this.mode.id,lesson:{complexity:this.lesson.complexity,length:this.lesson.length,capitals:this.lesson.capitals,punctuators:this.lesson.punctuators},speedUnit:this.speedUnit.id,enableSound:this.enableSound,text:{mangle:{simplify:this.textConfig.mangle.simplify,lowercase:this.textConfig.mangle.lowercase,censor:this.textConfig.mangle.censor},url:this.textConfig.url,text:this.textConfig.text}})},Settings.prototype.remove=function(){window.localStorage.removeItem("settings")},Settings.prototype.loadLesson=function(a){var b=this;switch(b.mode){case MODE.GUIDED:LanguageModel.get(b.layout.lang).load(function(c){a(new Lesson(b,c))}.bind(b));break;case MODE.IMPORT_WEBSITE:var c=window.location.protocol+"//"+window.location.host+"/fetch?url="+encodeURIComponent(b.textConfig.url),d=new XMLHttpRequest;d.onload=function(){a(new StaticLesson(b,new StaticTextGenerator(d.responseText,b.textConfig.mangle,b.layout)))}.bind(b),d.onerror=function(){a(new StaticLesson(b,new DummyGenerator("cannot load text")))}.bind(b),watchProgress(d),d.open("GET",c,!0),d.send();break;case MODE.IMPORT_TEXT:a(new StaticLesson(b,new StaticTextGenerator(b.textConfig.text,b.textConfig.mangle,b.layout)));break;default:throw new Error}},ResultArray.prototype=[],ResultArray.prototype.statistics=function(){var a=0,b=0,c=0,d=0,e=0,f=0;if(this.length>0){for(var g=0;g<this.length;g++){var h=this[g];a+=h.time,b=Math.max(b,h.speed),c+=h.speed,d=Math.max(d,h.score),e+=h.score,f+=h.errors}c/=this.length,e/=this.length,f/=this.length}return{count:this.length,totalTime:a,topSpeed:b,avgSpeed:c,topScore:d,avgScore:e,avgErrors:f}},ResultArray.prototype.keyAverageTimes=function(a){function b(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}for(var c,d=Object.create(null),e=0;e<this.length;e++){var f=this[e].histogram;for(c in f){var g=f[c].t;if(g){var h=d[c];h||(d[c]=h=[]),h.push(g),a&&h.length>a&&h.shift()}}}for(c in d)d[c]=b(d[c]);return Object.freeze(d)},ResultArray.prototype.linearRegression=function(a){var b,c,d=this,e=d.length,f=.5*(e+1),g=0;for(b=0;e>b;b++)g+=a(d[b]);var h=g/e,i=0;for(b=0;e>b;b++)c=a(d[b])-h,i+=c*c;var j=Math.sqrt(i/(e-1)),k=0,l=0;for(b=0;e>b;b++)c=b-f,k+=c*(a(d[b])-h),l+=c*c;var m=k/l,n=h-m*f;return{mean:h,stdDev:j,alpha:n,beta:m,fn:function(a){return n+a*m}}},ResultArray.prototype.today=function(){var a=new Date;a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a=a.getTime();for(var b=new ResultArray,c=0;c<this.length;c++){var d=this[c];d.timeStamp>a&&b.push(d)}return b},ResultArray.prototype.filter=function(a,b){for(var c=new ResultArray,d=0;d<this.length;d++){var e=this[d];null!=a&&e.modeType!==a.id||null!=b&&e.layout!==b.id||c.push(e)}return c},ResultArray.prototype.group=function(){for(var a=Object.create(null),b=0;b<this.length;b++){var c=this[b],d=a[c.modeType];void 0===d&&(a[c.modeType]=d=Object.create(null));var e=d[c.layout];void 0===e&&(d[c.layout]=e=new ResultArray),e.push(c)}return a},ResultArray.prototype.groupByDate=function(){for(var a=Object.create(null),b=0;b<this.length;b++){var c=this[b],d=new DateX(c.timeStamp),e=a[d];void 0===e&&(a[d]=e={date:d,data:new ResultArray}),e.data.push(c)}return mapValues(a).sort(function(a,b){return a.timeStamp-b.timeStamp})},ResultArray.prototype.groupByDateHierarchical=function(){for(var a=Object.create(null),b=0;b<this.length;b++){var c=this[b],d=new DateX(c.timeStamp),e=a[d.year];void 0===e&&(a[d.year]=e=Object.create(null));var f=e[d.month];void 0===f&&(e[d.month]=f=Object.create(null));var g=f[d.day];void 0===g&&(f[d.day]=g=new ResultArray),g.push(c)}return a},Histogram.prototype.add=function(a){var b=a.histogram;for(var c in b){var d=b[c],e=this.data[c];e||(this.data[c]=e={h:0,m:0}),e.h+=0|d.h,e.m+=0|d.m}},History.prototype._onerror=function(a){console.log(a)},History.prototype.open=function(a){var b=window.indexedDB.open("history",1);b.onerror=this._onerror.bind(this),b.onblocked=function(a){console.log("indexed db blocked",a)}.bind(this),b.onupgradeneeded=function(){{var a=b.result,c=a.createObjectStore("history",{autoIncrement:!0});c.createIndex("by_layout","layout")}}.bind(this),b.onsuccess=function(){this.db=b.result,this.read(a)}.bind(this)},History.prototype.read=function(a){this.data=new ResultArray;var b=this.db.transaction("history"),c=b.objectStore("history"),d=c.openCursor();d.onerror=this._onerror.bind(this),d.onsuccess=function(){var b=d.result;if(b){var c=b.value;try{c.tx&&(c.n=c.tx.length),"string"==typeof c.l&&"string"==typeof c.m&&this.data.push(new Result(c.l,c.m,c.ts,c.n,c.t,c.e,c.c,c.h))}catch(e){}b.continue()}else a&&a()}.bind(this)},History.prototype.add=function(a,b){this.data.push(a);var c=this.db.transaction("history","readwrite"),d=c.objectStore("history"),e=d.add({l:a.layout,m:a.modeType,ts:a.timeStamp,n:a.length,t:a.time,e:a.errors,c:a.complexity,h:a.histogram});e.onerror=this._onerror.bind(this),e.onsuccess=function(){b&&b()}.bind(this)},History.prototype.delete=function(a){this.db.close(),this.db=null;var b=window.indexedDB.deleteDatabase("history");b.onerror=this._onerror.bind(this),b.onblocked=function(a){console.log(a)}.bind(this),b.onupgradeneeded=function(a){console.log(a)}.bind(this),b.onsuccess=function(){this.open(a)}.bind(this)},History.prototype.generateSampleData=function(){throw new Error("not implemented")};var ACH_ID=function(){return Object.freeze({MAX_SPEED:"max-speed",MAX_SCORE:"max-score",SPEED_STREAK:"speed-streak",SCORE_STREAK:"score-streak",ERRORS_STREAK:"errors-streak"})}(),ACH_VALUE=function(){return Object.freeze({SILVER:"silver",BRONZE:"gold",GOLD:"gold",RUBY:"ruby"})}();Achievement.prototype={equals:function(a){return this.id===a.id&&this.value===a.value},toString:function(){return this.value?"["+this.value+"] "+this.description():this.description()},description:function(){switch(this.id){case ACH_ID.MAX_SPEED:return"Top speed so far";case ACH_ID.MAX_SCORE:return"Best score so far";case ACH_ID.SPEED_STREAK:return"Increasing speed sequence";case ACH_ID.SCORE_STREAK:return"Increasing score sequence";case ACH_ID.ERRORS_STREAK:return"Sequence without errors"}throw new Error}},AchievementsAnalyzer.prototype={last:null,maxSpeed:0,maxScore:0,speedStreak:0,scoreStreak:0,errorsStreak:0,count:0,reset:function(){this.last=null,this.maxSpeed=0,this.maxScore=0,this.speedStreak=0,this.scoreStreak=0,this.errorsStreak=0,this.count=0},add:function(a){var b=[];return this.last&&(a.speed>=this.last.speed?(this.speedStreak++,7==this.speedStreak?b.push(new Achievement(ACH_ID.SPEED_STREAK,ACH_VALUE.GOLD)):5==this.speedStreak?b.push(new Achievement(ACH_ID.SPEED_STREAK,ACH_VALUE.BRONZE)):3==this.speedStreak&&b.push(new Achievement(ACH_ID.SPEED_STREAK,ACH_VALUE.SILVER))):this.speedStreak=0,a.score>=this.last.score?(this.scoreStreak++,7==this.scoreStreak?b.push(new Achievement(ACH_ID.SCORE_STREAK,ACH_VALUE.GOLD)):3==this.scoreStreak?b.push(new Achievement(ACH_ID.SCORE_STREAK,ACH_VALUE.BRONZE)):5==this.scoreStreak&&b.push(new Achievement(ACH_ID.SCORE_STREAK,ACH_VALUE.SILVER))):this.scoreStreak=0),0==a.errors?(this.errorsStreak++,17==this.errorsStreak?b.push(new Achievement(ACH_ID.ERRORS_STREAK,ACH_VALUE.RUBY)):12==this.errorsStreak?b.push(new Achievement(ACH_ID.ERRORS_STREAK,ACH_VALUE.GOLD)):8==this.errorsStreak?b.push(new Achievement(ACH_ID.ERRORS_STREAK,ACH_VALUE.BRONZE)):5==this.errorsStreak&&b.push(new Achievement(ACH_ID.ERRORS_STREAK,ACH_VALUE.SILVER))):this.errorsStreak=0,this.count>=10&&(a.speed>this.maxSpeed&&(this.maxSpeed=a.speed,b.push(new Achievement(ACH_ID.MAX_SPEED,null))),a.score>this.maxScore&&(this.maxScore=a.score,b.push(new Achievement(ACH_ID.MAX_SCORE,null)))),this.last=a,this.count++,b.length>0?{layout:a.layout,mode:a.mode,timeStamp:a.timeStamp,list:b}:null},analyze:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=this.add(d);e&&b.push(e)}return b}},StaticLesson.prototype={generate:function(){return this.generator.nextFragment()},update:function(){}},Lesson.getCharSet=function(a,b){for(var c=a.charSet.orderBy(ORDER_BY.FREQUENCY),d=[],e=0;e<c.length;e++){var f=c[e],g=b.keyCombo(f.charCode);g&&!g.deadKey&&d.push(f)}return Object.freeze(d)},Lesson.t0=300,Lesson.t1=1e3,Lesson.isConfident=function(a){return null==a?!1:a<=Lesson.t0},Lesson.confidenceLevel=function(a){return null==a?null:(a=Math.max(a,Lesson.t0),a=Math.min(a,Lesson.t1),1-(a-Lesson.t0)/(Lesson.t1-Lesson.t0))},Lesson.prototype={includeCharSet:[],excludeCharSet:[],boost:null,generate:function(){if(this.includeCharSet.length){for(var a=[],b=0;b<this.includeCharSet.length;b++)a.push(this.includeCharSet[b].charCode);this.generator.subSet=a}else this.generator.subSet=null;return this.generator.boost=this.boost,this.generator.wordLimit=4+Math.round(4*this.settings.lesson.length),this.generator.fragmentLimit=30+Math.round(70*this.settings.lesson.length),this.generator.enableCapitals=this.settings.lesson.capitals,this.generator.enablePunctuators=this.settings.lesson.punctuators,this.generator.nextFragment()},update:function(a){var b=6,c=b+Math.round((this.charSet.length-b)*this.settings.lesson.complexity);this.includeCharSet=[],this.excludeCharSet=[],this.boost=null;for(var d=[],e=Object.create(null),f=a.keyAverageTimes(20),g=0,h=0;h<this.charSet.length;h++){var i=this.charSet[h].charCode,j=f[i];j=j?j:null;var k={charCode:i,n:h,t:j,isConfident:Lesson.isConfident(j),confidenceLevel:Lesson.confidenceLevel(j),isForced:h>=b&&c>h,isBoosted:!1};b>h?(this.includeCharSet.push(k),k.isConfident||g++):k.isConfident?this.includeCharSet.push(k):(d.push(k),e[i]=k)}for(d.length>0&&1>g&&(k=d.shift(),k.isBoosted=!0,this.includeCharSet.push(k),this.boost={charCode:k.charCode,factor:this.generator.getBoostFactor(k.charCode)});d.length>0;)k=d.shift(),k.isForced?this.includeCharSet.push(k):this.excludeCharSet.push(k)}},LessonUi.COLOR_MIN_CONFIDENCE=new Color(13369344),LessonUi.COLOR_MAX_CONFIDENCE=new Color(7334996),LessonUi.confidenceColor=function(a){var b=LessonUi.COLOR_MIN_CONFIDENCE,c=LessonUi.COLOR_MAX_CONFIDENCE;return new Color(Math.round((c.r-b.r)*a+b.r),Math.round((c.g-b.g)*a+b.g),Math.round((c.b-b.b)*a+b.b))},Fragment.prototype.reset=function(){this.started=null,this.finished=null,this.errors=0,this.position=0,this.buffer=[],this.errorPos=[],this.histogram=Object.create(null),this.lastKeyTime=0,this.keyTimesMap=Object.create(null),this.result=null},Fragment.prototype.put=function(a){if(0==this.position&&(13==a||32==a))return!1;var b=this.position;if(8==a)this.back();else{null==this.started&&(this.started=this.getTime());var c=this.advance(a);c===!0&&sounds.play("click"),c===!1&&sounds.play("blip")}if(this.isCompleted()){this.finished=this.getTime();for(var d in this.histogram){var e=this.histogram[d],f=this.keyTimesMap[d];if(f){for(var g=0,h=0;h<f.length;h++)g+=f[h];g/=f.length,e.t=Math.round(1e3*g)/1e3}}var i=this.finished-this.started;this.result=new Result(this.layout.id,this.modeType.id,this.started,this.text.length,i,this.errors,this.complexity,this.histogram)}return b!=this.position},Fragment.prototype.getTime=function(){return Date.now()},Fragment.prototype.isCompleted=function(){return this.position==this.text.length},Fragment.prototype.nextChar=function(){return this.position<this.text.length?this.text.charCodeAt(this.position):0},Fragment.prototype.back=function(){this.lastKeyTime=0,this.position>0&&this.position--,this.buffer=[];for(var a=this.errorPos.length;a>0;a--){var b=this.errorPos[a-1];if(b<this.position)break}this.errorPos.splice(a)},Fragment.prototype.advance=function(a){var b=3,c=this.text.charCodeAt(this.position);if(0==this.buffer.length){if(c==a)return this.hit(c),this.measureTime(c),this.position++,!0;this.errors++,this.errorPos.push(this.position)}this.lastKeyTime=0,this.buffer.push(a);var d;if(this.position+b<this.text.length&&this.buffer.length==b&&this.isSkipped()){for(this.miss(c),d=0;d<this.buffer.length;d++)this.hit(this.buffer[d]);return this.buffer=[],this.position+=b+1,this.lastKeyTime=__now(),null}if(this.position+b<this.text.length&&this.buffer.length==b+1&&this.isReplaced()){for(this.miss(c),d=1;d<this.buffer.length;d++)this.hit(this.buffer[d]);return this.buffer=[],this.position+=b+1,this.lastKeyTime=__now(),null}if(c==a){for(d=0;d<this.buffer.length-1;d++)this.miss(c);return this.hit(c),this.buffer=[],this.position++,this.lastKeyTime=__now(),!0}return!1},Fragment.prototype.isSkipped=function(){for(var a=0;a<this.buffer.length;a++){var b=this.text.charCodeAt(this.position+1+a);if(b!=this.buffer[a])return!1}return!0},Fragment.prototype.isReplaced=function(){for(var a=1;a<this.buffer.length;a++){var b=this.text.charCodeAt(this.position+a);if(b!=this.buffer[a])return!1}return!0},Fragment.prototype.hit=function(a){var b=this.histogram[a];b||(this.histogram[a]=b={h:0,m:0,t:0}),b.h++},Fragment.prototype.miss=function(a){var b=this.histogram[a];b||(this.histogram[a]=b={h:0,m:0,t:0}),b.m++},Fragment.prototype.measureTime=function(a){var b=__now();if(this.lastKeyTime>0){var c=this.keyTimesMap[a];c||(this.keyTimesMap[a]=c=[]),c.push(b-this.lastKeyTime)}this.lastKeyTime=b},FragmentUi.prototype={attach:function(a){a.appendChild(this.fragmentEl)},detach:function(){this.fragmentEl.parentNode.removeChild(this.fragmentEl)},updateUi:function(){var a,b,c,d=this.fragment.text,e=this.fragment.position,f=this.fragment.errorPos,g=-1;for(a=0;e>a;a++)c=this.itemEl[a],c.classList.add("down"),c.classList.remove("cursor");for(a=e;a<d.length;a++)c=this.itemEl[a],c.classList.remove("down"),a==e?c.classList.add("cursor"):c.classList.remove("cursor");for(a=0,b=0;a<d.length;a++){if(c=this.itemEl[a],a>g)for(;b<f.length&&(g=f[b],!(g>=a));b++);g==a&&g!=e?c.classList.add("error"):c.classList.remove("error")}},createShakeAnimation:function(){return new FragmentShakeAnimation(this.itemEl)}},LessonDetailsUi.prototype={update:function(a){function b(a){var b=String.fromCharCode(a.charCode).toUpperCase(),c=["Character '"+b+"'"];return a.t?(c.push("Time to type: "+round(a.t,100)+"ms"),c.push("Confidence level: "+round(a.confidenceLevel,100))):c.push("Not calibrated"),a.isForced&&c.push("Added by user"),a.isBoosted&&c.push("Boosted frequency"),c.join("; ")}var c,d,e,f,g;if(this.$el.empty(),a.includeCharSet&&a.includeCharSet){var h=$("<span></span>").addClass("include");for(c=0;c<a.includeCharSet.length;c++)d=a.includeCharSet[c],e=String.fromCharCode(d.charCode).toUpperCase(),g=null==d.confidenceLevel?new Color(14540253):LessonUi.confidenceColor(d.confidenceLevel),f=$("<span></span>").text(e).attr("title",b(d)).css("background-color",g.toString()),d.isForced&&f.addClass("forced"),d.isBoosted&&f.addClass("boosted"),h.append(f);c>0&&this.$el.append(h);var i=$("<span></span>").addClass("exclude");for(c=0;c<a.excludeCharSet.length;c++)d=a.excludeCharSet[c],e=String.fromCharCode(d.charCode).toUpperCase(),f=$("<span></span>").text(e).attr("title",b(d)).css("background-color","#F3F3F3"),i.append(f);c>0&&this.$el.append(i)}else this.$el.append($("<span></span>").text("manual mode"))}},FragmentShakeAnimation.prototype={init:function(){for(var a=0;a<this.elArray.length;a++){var b=this.elArray[a];b._anim={x:b.offsetLeft,y:b.offsetTop,rx:Math.randomInt(5,20)*(Math.randomInt(0,1)>0?1:-1),ry:Math.randomInt(5,20)*(Math.randomInt(0,1)>0?1:-1),sx:Math.randomInt(80,200),sy:Math.randomInt(80,200)}}for(a=0;a<this.elArray.length;a++)b=this.elArray[a],b.style.position="absolute"},step:function(a){for(var b=0;b<this.elArray.length;b++){var c=this.elArray[b],d=c._anim,e=d.x+Math.sin(a/d.sx)*d.rx,f=d.y+Math.cos(a/d.sy)*d.ry;c.style.left=e+"px",c.style.top=f+"px"}},reset:function(){for(var a=0;a<this.elArray.length;a++){var b=this.elArray[a];delete b._anim,b.style.position="",b.style.left="",b.style.top=""}}};var Game=function(){function a(){m.text("0"),n.text("0"),o.text("0"),p.text("0"),q.text("0"),r.text("0"),l.empty(),s.text("-"),t.text("-")}function b(a,b){0>b?(b=round(b,1e3),a.text(b),a.removeClass("more"),a.addClass("less")):(b=round(b,1e3),a.text("+"+b),a.removeClass("less"),a.addClass("more"))}function c(a){if(l.empty(),a)for(var b=0;b<a.list.length;b++){var c=a.list[b],d=$("<div></div>").addClass("badge");d.attr("title",c),d.addClass(c.id),d.addClass(c.value),d.addClass("animated"),d.addClass("shake"),l.append(d)}}function d(a){if(s.empty(),0==a.length)s.text("-");else for(var b=0;b<a.length;b++){var c=a[b],d=String.fromCharCode(c.key).toUpperCase();if(" "!=d&&"\n"!=d){var e=$("<span></span>").addClass("key");e.append($("<span></span>").addClass("name").text(d+":"));var f=$("<span></span>").addClass("value"),g=round(c.delta,1);c.delta<0?(f.text(g),f.addClass("less")):(f.text("+"+g),f.addClass("more")),e.append(f),s.append(e)}}}function e(a){new LessonDetailsUi(t).update(a)}function f(a,b){this.history=a,this.settings=b,this.analyzer=new AchievementsAnalyzer,this.data=this.history.data.filter(this.settings.mode.type,this.settings.layout),this.analyzer.analyze(this.data)}function g(a){this.settings=a,this.history=new History}var h,i=(document.getElementById("game"),document.getElementById("text")),j=document.getElementById("layout"),k=document.getElementById("overlay"),l=$("#g-achievements"),m=$("#g-speed"),n=$("#g-speed-gain"),o=$("#g-errors"),p=$("#g-errors-gain"),q=$("#g-score"),r=$("#g-score-gain"),s=$("#g-key-times-gain"),t=$("#g-lesson-details");return f.prototype={init:function(a){a.update(this.data),e(a)},add:function(a,e,f){this.history.add(e,function(){f()}.bind(this));var g=this.data.statistics(),h=this.data.keyAverageTimes(100);this.data.push(e);var i=[];for(var j in e.histogram){var k=e.histogram[j].t,l=h[j];k&&l&&i.push({key:j,delta:l-k})}i.sort(function(a,b){return b.delta-a.delta});var s=this.analyzer.add(e),t=this.settings.speedUnit,u=e.speed-g.avgSpeed,v=e.score-g.avgScore,w=-(e.errors-g.avgErrors);m.text(Math.round(t.measure(e.speed))),o.text(Math.round(e.errors)),q.text(Math.round(e.score)),b(n,t.measure(u)),b(r,v),b(p,w),c(s),d(i),s&&s.list.length?sounds.play("tada"):0==e.errors&&sounds.play("correct")}},g.prototype={settings:null,history:null,lesson:null,fragment:null,progressNotifier:null,handler:null,keyboardUi:null,fragmentUi:null,active:!1,shake:null,init:function(a){h=window.setInterval(function(){i.classList.toggle("blink")},300),window.addEventListener("blur",function(){this.reset(),document.body.classList.add("pause")}.bind(this)),window.addEventListener("focus",function(){this.reset(),document.body.classList.remove("pause")}.bind(this)),document.addEventListener("keydown",function(a){this.active&&this.keyDown(new CustomKeyboardEvent(a))}.bind(this),!0),document.addEventListener("keyup",function(a){this.active&&this.keyUp(new CustomKeyboardEvent(a))}.bind(this),!0),document.addEventListener("reveal-page",function(a){"#game"==a.detail.url?this.unpause():this.pause()}.bind(this)),this.keyboardUi=new KeyboardUi,this.history.open(function(){a&&a()}.bind(this))},start:function(a){this.lesson=a,this.settings.layout.configure(this.settings),this.keyboardUi.init(j,this.settings.layout,!0),this.progressNotifier=new f(this.history,this.settings),sounds.init(this.settings),this.next()
},reset:function(){this.fragment&&(this.fragment.reset(),this._update(this.fragment))},next:function(){this._update(null)},_update:function(a){this.progressNotifier.init(this.lesson),this.fragment=a?a:new Fragment(this.settings.layout,this.settings.mode.type,this.lesson);var b=function(a){this.fragment.put(a)}.bind(this);this.handler=this.settings.layout.createEventHandler(b),this.fragmentUi&&this.fragmentUi.detach(),this.fragmentUi=new FragmentUi(this.fragment),this.fragmentUi.attach(i),this.keyboardUi.reset(),this.highlight(),this.delayShake()},completed:function(a){this.progressNotifier.add(this.lesson,a,function(){this.next()}.bind(this)),document.dispatchEvent(new CustomEvent("fragment-complete",{detail:{result:a},bubbles:!0,cancelable:!1}))},highlight:function(){this.keyboardUi.highlight(k,this.fragment.nextChar())},pause:function(){this.active=!1,this.cancelShake()},unpause:function(){this.active=!0,a(),this.reset()},timeoutId:null,delayShake:function(){this.cancelShake(),this.timeoutId=window.setTimeout(function(){this.kickShake()}.bind(this),3e4)},kickShake:function(){this.cancelShake(),document.body.classList.add("shake"),this.shake=new Shake([this.keyboardUi.createShakeAnimation(),this.fragmentUi.createShakeAnimation()]),this.shake.start()},cancelShake:function(){this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=null),document.body.classList.remove("shake"),this.shake&&(this.shake.cancel(),this.shake=null)},lastKeyCode:-1,keyDown:function(a){this.lastKeyCode!=a.keyCode&&(this.lastKeyCode=a.keyCode,this.shake?(this.cancelShake(),this.reset()):(this.keyboardUi.keyDown(a),a.keyCode==VK.ESCAPE?this.kickShake():a.keyCode==VK.LEFT&&a.ctrlKey?(this.reset(),a.preventDefault(),a.stopPropagation()):a.keyCode==VK.RIGHT&&a.ctrlKey?(this.next(),a.preventDefault(),a.stopPropagation()):VK.isSpecialKey(a)||(this.handler.keyDown(a),this.fragmentUi.updateUi(),this.highlight(),this.fragment.isCompleted()&&this.completed(this.fragment.result),this.delayShake(),a.preventDefault(),a.stopPropagation())))},keyUp:function(a){this.lastKeyCode==a.keyCode&&(this.lastKeyCode=-1),this.keyboardUi.keyUp(a),this.handler.keyUp(a)}},g}();Shake.prototype={start:function(){this._init(),this._schedule()},cancel:function(){this._unschedule(),this._reset()},_timerId:null,_schedule:function(){this._timerId=window.requestAnimationFrame(function(a){this._step(a)}.bind(this))},_unschedule:function(){this._timerId&&(window.cancelAnimationFrame(this._timerId),this._timerId=null)},_init:function(){for(var a=0;a<this.a.length;a++)this.a[a].init()},_started:null,_n:0,_step:function(a){var b;null===this._started&&(this._started=a),this._n++,b=a-this._started;for(var c=0;c<this.a.length;c++)this.a[c].step(b);if(this._schedule(),100==this._n){this._n/b*1e3}},_reset:function(){for(var a=0;a<this.a.length;a++)this.a[a].reset()}},ShakeAnimation.prototype={init:function(){},step:function(){},reset:function(){}};var shape={empty:{w:0,h:0,p:[]},invader:{w:11,h:8,p:[{y:0,x:1},{y:0,x:8},{y:1,x:3},{y:1,x:7},{y:2,x:2},{y:2,x:3},{y:2,x:4},{y:2,x:5},{y:2,x:6},{y:2,x:7},{y:2,x:8},{y:3,x:1},{y:2,x:2},{y:3,x:4},{y:3,x:5},{y:3,x:6},{y:3,x:8},{y:3,x:9},{y:4,x:0},{y:4,x:1},{y:4,x:2},{y:4,x:3},{y:4,x:4},{y:4,x:5},{y:4,x:6},{y:4,x:7},{y:4,x:8},{y:4,x:9},{y:4,x:10},{y:5,x:0},{y:5,x:2},{y:5,x:3},{y:5,x:4},{y:5,x:5},{y:5,x:6},{y:5,x:7},{y:5,x:8},{y:5,x:10},{y:6,x:0},{y:6,x:2},{y:6,x:8},{y:6,x:10},{y:7,x:3},{y:7,x:4},{y:7,x:6},{y:7,x:7}]}};!function(){if(!("__killme__"in window)){redirect(),polyfill();var a="\n      ___      __   __     __   __        \n|__/ |__  \\ / |__) |__)   /    /  \\  |\\/| \n|  \\ |___  |  |__) |  \\ . \\__  \\__/  |  | \n\n";console.log(a);try{var b=window.document.domain;"string"==typeof b&&b.startsWith("www.")&&(Cookies.defaults.domain=window.document.domain=b=b.substring(4))}catch(c){console.log("Cannot change document.domain",c)}if(!("__test__"in window)){SVG.eid=function(a){return"svg-"+a+"-"+(SVG.did++).toString(36)};var d=new ParamMap;if(!d.flag("noinit")){var e=clientId();init(e,d)}}}}();
//# sourceMappingURL=js-1389796812181.min.map