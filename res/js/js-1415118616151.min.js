!function(){function a(){return global.user||{id:null,email:null,name:null,fullName:null,firstName:null,lastName:null,externalId:{}}}function b(a,b){var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}function c(a){var b=[];for(var c in a)b.push(a[c]);return b}function d(a){var b=$(a);if(1!=b.length)throw new Error("Invalid match: "+a);return b}function e(a,b){var c=b.find(a);if(1!=c.length)throw new Error("Invalid match: "+a);return c}function f(a){var b=document.querySelectorAll(a);if(1!=b.length)throw new Error("Invalid match: "+a);return b[0]}function g(a,b){var c=b.querySelectorAll(a);if(1!=c.length)throw new Error("Invalid match: "+a);return c[0]}function h(a){var b=$(a);if(0==b.length)throw new Error("Empty match: "+a);return b}function i(a,b){return Math.round(a*b)/b}function j(a){var b=this;try{var c=window.localStorage;if(c instanceof Storage)return{persistent:!0,getObject:function(){try{return JSON.parse(c.getItem(a))}catch(b){return null}},setObject:function(b){try{c.setItem(a,JSON.stringify(b))}catch(d){console.error(d)}},deleteObject:function(){try{c.removeItem(a)}catch(b){console.error(b)}}}}catch(d){console.error(d)}return{persistent:!1,object:null,getObject:function(){return b.object},setObject:function(a){b.object=a},deleteObject:function(){b.object=null}}}function k(a){try{var b=window.indexedDB;if(b instanceof IDBFactory)return new Pb(a,b)}catch(c){console.error(c)}var d=[];return{persistent:!1,read:function(){return Y.resolve(d)},add:function(a){return d.push(a),Y.resolve(a)},clear:function(){return d=[],Y.resolve({})}}}function l(a){var b=this;return a&&a.id?new Qb(a):{enabled:!1,send:function(){return b.reject},receive:function(){return b.reject},clear:function(){return b.reject},reject:Y.reject({message:"disabled"})}}function m(a){return"object"==typeof a&&(a=a.charCode),String.fromCharCode(a).toUpperCase()}function n(){jc.text("0"),kc.text("0"),lc.text("0"),mc.text("0"),nc.text("0"),oc.text("0"),ic.empty(),pc.text("-"),qc.text("-")}function o(a,b){0>b?(b=i(b,1e3),a.text(b),a.removeClass("more"),a.addClass("less")):(b=i(b,1e3),a.text("+"+b),a.removeClass("less"),a.addClass("more"))}function p(a){if(ic.empty(),a)for(var b=0;b<a.list.length;b++){var c=a.list[b],d=$("<div></div>").addClass("badge");d.attr("title",String(c)),d.addClass(c.id),d.addClass(c.value),ic.append(d)}}function q(a){if(pc.empty(),0==a.length)pc.text("-");else for(var b=0;b<a.length;b++){var c=a[b];if(c.charCode>32){var d=$("<span></span>").addClass("name").text(m(c)+":"),e=$("<span></span>").addClass("value"),f=String(i(c.delta,1));c.delta<0?(e.addClass("less"),e.text(f)):(e.addClass("more"),e.text("+"+f));var g=$("<span></span>").addClass("key");g.append(d),g.append(e),pc.append(g)}}}function r(a,b){new cc(qc).update(a,b)}function s(a){d("#ctl-reset").on("click",function(){a.reset()}),d("#ctl-skip").on("click",function(){a.next()})}function t(a){function c(a){function b(){kb.load(s.layout.lang).done(function(a){var b=new bc(s,a),c=t.get(Kb.get2(s.layout,Fb.AUTO)),d=new Zb(b.letters,c);b.update(d),new cc(x).update(d,b),y.text(b.generate())}).fail(B)}bb&&(window.clearTimeout(bb),bb=null),a?b():bb=window.setTimeout(function(){bb=null,b()},100)}function f(){W.text(s.speedUnit.id),W.attr("title",s.speedUnit.name),X.attr("title",s.speedUnit.name)}function i(){c(!0)}function j(){}function k(){}function l(){}function m(){}function n(){}function o(){switch(Z.reveal("_form-1"),A.val(String(Math.round(100*s.lesson.complexity))),C.val(String(Math.round(100*s.lesson.length))),D.attr({checked:s.lesson.capitals}),E.attr({checked:s.lesson.punctuators}),F.val(s.text.url),G.val(s.text.content),L.attr({checked:s.text.mangle.simplify}),M.attr({checked:s.text.mangle.lowercase}),s.mode){case Hb.GUIDED:_.reveal("_fieldset-mode-1");break;case Hb.IMPORT_WEBSITE:_.reveal("_fieldset-mode-2");break;case Hb.IMPORT_TEXT:_.reveal("_fieldset-mode-3")}switch(s.speedUnit){case Jb.WPM:Q.attr({checked:!0}),R.attr({checked:!1});break;default:Q.attr({checked:!1}),R.attr({checked:!0})}S.attr({checked:s.sound}),ab.reset(),Y.reset(),U.listen(Y.keyEventListener())}function p(){U.listen(null)}function q(){switch(s.layout=ab.layout,s.emulateLayout=ab.emulateLayout,_.mode){case"_fieldset-mode-1":s.mode=Hb.GUIDED;break;case"_fieldset-mode-2":s.mode=Hb.IMPORT_WEBSITE;break;case"_fieldset-mode-3":s.mode=Hb.IMPORT_TEXT}return s.lesson.capitals=D.is(":checked"),s.lesson.punctuators=E.is(":checked"),s.text.url=F.val().trim(),s.text.content=G.val().trim(),s.text.mangle.simplify=L.is(":checked"),s.text.mangle.lowercase=M.is(":checked"),s.speedUnit=Q.is(":checked")?Jb.WPM:Jb.CPM,s.sound=S.is(":checked"),f(),r()}function r(){switch(s.mode){case Hb.IMPORT_WEBSITE:if(0==s.text.url.length)return Z.reveal("_form-1"),_.reveal("_fieldset-mode-2"),F.focus(),!1;break;case Hb.IMPORT_TEXT:if(0==s.text.content.length)return Z.reveal("_form-1"),_.reveal("_fieldset-mode-3"),G.focus(),!1}return!0}var s=a.settings,t=a.database,u=d("section.settings"),v=e("#settings",u),w=e("#_form-1",v),x=(e("#_form-2",v),e("#_form-3",v),e("#_lesson-key-details",v)),y=e("#_lesson-example",v),A=e("#_range-lesson-complexity",v),C=e("#_range-lesson-length",v),D=e("#_cb-enable-capitals",v),E=e("#_cb-enable-punctuators",v),F=e("#_url",v),G=e("#_text",v),H=e("#_t0",$(document.body)),I=e("#_t1",v),J=e("#_t2",v),K=e(".field-list",H),L=e("#_cb-simplify",H),M=e("#_cb-lowercase",H),N=e("#_language-list",v),O=e("#_layout-list",v),P=e("#_cb-emulate-layout",v),Q=e("#_rb-speed-unit-wpm",v),R=e("#_rb-speed-unit-cpm",v),S=e("#_cb-enable-sound",v),T=g("svg.keyboard",v[0]),V=e("#submit",v),W=h(".js-speed-unit-text"),X=h(".js-speed-unit-description"),Y=new sb(T),Z={$items:v.find("ul.menu > li"),$forms:v.find("form"),init:function(){var a=this;this.$items.on("click",function(b){var c=$(b.target);a.reveal(c.data("for"))})},reveal:function(a){switch(this.$items.each(function(b,c){var d=$(c);d.data("for")==a?d.addClass("active"):d.removeClass("active")}),this.$forms.each(function(b,c){var d=$(c);c.id==a?d.show():d.hide()}),a){case"_form-1":i();break;case"_form-2":j();break;case"_form-3":k();break;default:throw new Error("unknown id: "+a)}}};Z.init();var _={mode:null,$items:w.find("input[name=mode]"),$forms:w.find("fieldset"),init:function(){var a=this;this.$items.on("click",function(b){var c=$(b.target);a.mode=c.val(),a.reveal(c.val())})},reveal:function(a){switch(this.$items.each(function(b,c){var d=$(c);d.attr(d.val()==a?{checked:!0}:{checked:!1})}),this.$forms.each(function(b,c){var d=$(c);c.id==a?d.show():d.hide()}),a){case"_fieldset-mode-1":H.append(K),l();break;case"_fieldset-mode-2":I.append(K),m();break;case"_fieldset-mode-3":J.append(K),n();break;default:throw new Error("unknown id: "+a)}}};_.init();var ab={map:Object.create(null),layout:null,emulateLayout:null,init:function(){var a=this;this.languageList=new vb.DropDown(N);for(var b in Db){var c=Db[b],d=c.lang,e=this.map[d.id];null==e&&(this.map[d.id]=e=[],this.languageList.add(d.name,d.id)),e.push(c)}this.languageList.listen(function(b,c){a.switchLanguage(c)}),P.on("click",function(){a.emulateLayout=P.is(":checked"),a.update()})},reset:function(){this.layout=s.layout,this.emulateLayout=s.emulateLayout,this.switchLanguage(this.layout.lang),this.update()},switchLanguage:function(a){var b=this;O.empty();var c=$();$.each(this.map[a],function(a,d){var e=$("<span></span>").addClass("ui radio").text(d.name);O.append($("<li></li>").append(e)),c=c.add(e),d==b.layout&&e.addClass("checked"),e.on("click",function(){c.removeClass("checked"),e.addClass("checked"),b.layout=d,b.update()})})},update:function(){var a=this;this.languageList.select(this.layout.lang),this.layout.config.emulate=this.emulateLayout,Y.init(this.layout),P.each(function(b,c){c.disabled=a.layout.variantOf?!1:!0,c.checked=a.emulateLayout})}};ab.init();var bb;A.on("change",function(){s.lesson.complexity=A.val()/100,c(!1)}),C.on("change",function(){s.lesson.length=C.val()/100,c(!1)}),D.on("change",function(){s.lesson.capitals=D.is(":checked"),c(!0)}),E.on("change",function(){s.lesson.punctuators=E.is(":checked"),c(!0)}),f(),w.find("a.example-url").each(function(a,b){var c=$(b);c.on("click",function(){return F.val(c.data("url")),!1})}),w.find("a.example-text").each(function(a,b){var c=$(b),d=$(c.data("content-select"));c.html(d.attr("title")),c.on("click",function(){var a=d.text().replace(/[ \n\t]+/g," ").split("\\n").map(function(a){return a.trim()}).join("\n");return G.val(a),!1})}),V.on("click",function(){return q()?(document.dispatchEvent(b(eb,{detail:{settings:s},bubbles:!0,cancelable:!1})),s.persist(),a.start(),!0):!1}),z({path:"settings",onShow:function(){o()},onHide:function(){p()}})}function u(a){function b(){h.init(a.settings.layout)}function c(){}var d=f("section.help"),e=g("svg.keyboard",d),h=new sb(e);z({path:"help",onShow:function(){b()},onHide:function(){c()}})}function v(a){function b(a){var b=new Date;b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0);for(var c=b.getTime(),d=[],e=0;e<a.length;e++){var f=a[e];f.timeStamp>c&&d.push(f)}return d}function f(a){for(var b=Object.create(null),d=0;d<a.length;d++){var e=a[d],f=new N(e.timeStamp),g=b[String(f)];void 0===g&&(b[String(f)]=g={date:f,list:[]}),g.list.push(e)}return c(b).sort(function(a,b){return a.timeStamp-b.timeStamp})}function h(){var a=new Vb,b=a.analyze(db.data);if(E.empty(),b.length)for(var c=0;c<b.length;c++)for(var d=b[c],e=0;e<d.list.length;e++){var f=d.list[e];if(f.id!=Sb.MAX_SPEED&&f.id!=Sb.MAX_SCORE){var g=$("<div></div>").addClass("badge");g.attr("title",f+" "+new Date(d.timeStamp).toLocaleString()),g.addClass(f.id),g.addClass(f.value),E.append(g)}}}function j(){function a(){i.rect(d.width,d.height).move(d.x(0),d.y(0)).attr("class","f");for(var a=0;a<e.length;a++){var b=e[a];i.plain(m(b)).font({anchor:"middle"}).x(d.x(0)-20).cy(d.y(a*h)+f/2).attr("class","l")}i.plain(String(db.data.length)).font({anchor:"middle"}).x(d.x(d.width)).y(d.y(d.height)+3).attr("class","v")}function b(){for(var a=0;a<e.length;a++)for(var b=e[a],i=0;i<db.data.length;i++){var j=db.data[i],k=j.histogram[b.charCode];if(k){var l=Yb.confidenceLevel(k.t),m=cc.confidenceColor(l);c.context.fillStyle=m.toString(),c.context.fillRect(d.x(i*g),d.y(a*h),g,f)}}}var c=new zc(Q);c.clear();var d=new xc(c.size,40,50),e=Wb.sort(db.letters,Wb.SORT_BY_FREQUENCY),f=8,g=Math.min(d.width/db.data.length,30),h=(d.height-f)/(e.length-1),i=c.svg.group();a(),db.data.length>2?b():c.noDataLabel(i,d)}function k(){function b(){function a(a){var b=["Character '"+m(a)+"'"];return a.t?(b.push("Typing speed: "+i(o.fromTime(a.t),1)+o.id),b.push("Time to type: "+i(a.t,1)+"ms"),b.push("Confidence level: "+i(a.confidenceLevel,100))):b.push("Not calibrated"),b.join("; ")}L.empty();for(var b=0;b<n.length;b++){var d=n[b],e=db.forecast.map[d.charCode],f={charCode:d.charCode,f:d.f,t:e.meanTime(),confidenceLevel:e.confidenceLevel(),isConfident:e.isConfident(),isForced:!1,isBoosted:!1},g=$("<span></span>").addClass("key").css("background-color",String(cc.confidenceColor(f.confidenceLevel))).text(m(d)).attr("title",a(f)).data("item",f);L.append(g),p[d.charCode]=g}var h=L.children();h.on("click",function(a){c(db.charCode=$(a.target).data("item").charCode)})}function c(a){function b(a){return e.x(a/m.length*e.width)}function c(a){return e.y(e.height-a/s*e.height)}for(var f in p)p[f].removeClass("current");p[a].addClass("current");var m,n=db.forecast.map[a],q=o.fromTime(bc.MIN_TIME);m=l?n.st:n.t;var r=null,s=0;if(m.length>0&&(r=X.linearRegression(m.map(function(a){return o.fromTime(a)})),s=Math.max(r.max,q)),h.plain(String(i(s,1))+o.id),j.plain(String(i(s/2,1))+o.id),k.plain(String(n.t.length)),d.context.clearRect(0,0,d.size.width,d.size.height),m.length>0){var t=n.learningRate(o),u="~"+String(i(t.perSample,1e3))+o.id+"/sample",v="~"+String(i(t.perHour,1))+o.id+"/hour";M.text(u+", "+v),g.y(c(q));for(var w=Math.max(Math.min(e.width/m.length,12),6),x=0;x<m.length;x++){var y=m[x];d.context.fillStyle="#6FB48C",d.context.beginPath(),d.context.arc(b(x),c(o.fromTime(y)),w,0,2*Math.PI,!0),d.context.closePath(),d.context.fill()}d.context.lineWidth=14,d.context.strokeStyle="rgba(111,180,140,0.7)",d.context.beginPath(),d.context.moveTo(b(0),c(r.fn(0))),d.context.lineTo(b(m.length),c(r.fn(m.length))),d.context.stroke()}else M.text("-"),g.y(e.y(0))}var d=new zc(R);d.clear();var e=new xc(d.size,40,50),f=d.svg.group(),g=f.line(e.x(0),e.y(0),e.x(e.width),e.y(0)).attr("class","threshold");f.rect(e.width,e.height).move(e.x(0),e.y(0)).attr("class","f"),f.line(e.x(0),e.y(.25*e.height),e.x(e.width),e.y(.25*e.height)).attr("class","f"),f.line(e.x(0),e.y(.5*e.height),e.x(e.width),e.y(.5*e.height)).attr("class","f"),f.line(e.x(0),e.y(.75*e.height),e.x(e.width),e.y(.75*e.height)).attr("class","f"),f.line(e.x(0),e.y(0),e.x(e.height),e.y(0)).attr("class","f"),f.line(e.x(.25*e.width),e.y(0),e.x(.25*e.width),e.y(e.height)).attr("class","f"),f.line(e.x(.5*e.width),e.y(0),e.x(.5*e.width),e.y(e.height)).attr("class","f"),f.line(e.x(.75*e.width),e.y(0),e.x(.75*e.width),e.y(e.height)).attr("class","f"),f.line(e.x(-20),e.y(e.height),e.x(e.width+20),e.y(e.height)).attr("class","f axis"),f.line(e.x(0),e.y(-20),e.x(0),e.y(e.height+20)).attr("class","f axis");var h=f.plain("?").font({anchor:"end"}).x(e.x(0)-3).cy(e.y(0)).attr("class","v"),j=f.plain("?").font({anchor:"end"}).x(e.x(0)-3).cy(e.y(e.height/2)).attr("class","v"),k=f.plain("?").font({anchor:"middle"}).x(e.x(e.width)).y(e.y(e.height)+3).attr("class","v"),l=O.is(":checked"),n=Wb.sort(db.letters,Wb.SORT_BY_FREQUENCY),o=a.settings.speedUnit,p=Object.create(null);b(),db.data.length>2?(0==db.charCode&&(db.charCode=n[0].charCode),c(db.charCode)):(M.text("-"),d.noDataLabel(f,e))}function l(){function b(a){return g.x(a/o.length*g.width)}function c(a){return g.y(g.height-a/q.max*g.height)}function d(a){return g.y(g.height-a/r.max*g.height)}function e(){for(var a=Math.max(Math.min(g.width/o.length,12),6),e=0;e<o.length;e++){var h=b(e),i=c(o[e]),j=d(p[e]),k=Math.abs(i-j)<1;f.context.fillStyle="rgba(172,113,208,1)",f.context.beginPath(),f.context.arc(h,i,k?a+1:a,0,2*Math.PI,!0),f.context.closePath(),f.context.fill(),f.context.fillStyle="rgba(111,180,140,1)",f.context.beginPath(),f.context.arc(h,j,k?a-1:a,0,2*Math.PI,!0),f.context.closePath(),f.context.fill()}f.context.lineWidth=14,f.context.strokeStyle="rgba(172,113,208,0.7)",f.context.beginPath(),f.context.moveTo(b(0),c(q.fn(0))),f.context.lineTo(b(o.length),c(q.fn(o.length))),f.context.stroke(),f.context.lineWidth=14,f.context.strokeStyle="rgba(111,180,140,0.7)",f.context.beginPath(),f.context.moveTo(b(0),d(r.fn(0))),f.context.lineTo(b(o.length),d(r.fn(o.length))),f.context.stroke()}var f=new zc(S);f.clear();var g=new xc(f.size,40,50),h=f.svg.group();h.rect(g.width,g.height).move(g.x(0),g.y(0)).attr("class","f"),h.line(g.x(0),g.y(.25*g.height),g.x(g.width),g.y(.25*g.height)).attr("class","f"),h.line(g.x(0),g.y(.5*g.height),g.x(g.width),g.y(.5*g.height)).attr("class","f"),h.line(g.x(0),g.y(.75*g.height),g.x(g.width),g.y(.75*g.height)).attr("class","f"),h.line(g.x(0),g.y(0),g.x(g.height),g.y(0)).attr("class","f"),h.line(g.x(.25*g.width),g.y(0),g.x(.25*g.width),g.y(g.height)).attr("class","f"),h.line(g.x(.5*g.width),g.y(0),g.x(.5*g.width),g.y(g.height)).attr("class","f"),h.line(g.x(.75*g.width),g.y(0),g.x(.75*g.width),g.y(g.height)).attr("class","f"),h.line(g.x(-20),g.y(g.height),g.x(g.width+20),g.y(g.height)).attr("class","f axis"),h.line(g.x(0),g.y(-20),g.x(0),g.y(g.height+20)).attr("class","f axis");var j=h.plain("?").font({anchor:"end"}).x(g.x(0)-3).cy(g.y(0)).attr("class","v"),k=h.plain("?").font({anchor:"end"}).x(g.x(0)-3).cy(g.y(g.height/2)).attr("class","v"),l=h.plain("?").font({anchor:"middle"}).x(g.x(g.width)).y(g.y(g.height)+3).attr("class","v"),m=P.is(":checked"),n=a.settings.speedUnit,o=db.data.map(function(a){return a.score}),p=db.data.map(function(a){return n.measure(a.speed)});m&&(o=X.movingMeanSmooth(bc.WINDOW_SIZE,o),p=X.movingMeanSmooth(bc.WINDOW_SIZE,p));var q=X.linearRegression(o),r=X.linearRegression(p);j.plain(String(i(r.max,1))+n.id),k.plain(String(i(r.max/2,1))+n.id),l.plain(String(db.data.length)),db.data.length>2?e():f.noDataLabel(h,g)}function n(){function b(){for(var a=0,b=0;b<f.length;b++){var c=f[b],d=db.forecast.map[c.charCode],e=d.meanTime();e&&(a=Math.max(a,g.fromTime(e)))}return a}function c(){for(var a=0;a<f.length;a++){var b,c=f[a],d=db.forecast.map[c.charCode],n=d.meanTime(),o=e.x(a*j);if(n){var p=g.fromTime(n),q=p/k*e.height;l.rect(j-h,q).move(o,e.y(e.height-q)).attr("class","b").title(String(i(p,1))+g.id),b="l"}else b="l empty";l.plain(m(f[a])).font({anchor:"middle"}).move(o+j/2-h/2,e.y(e.height)).attr("class",b)}}var d=new yc(T);d.clear();var e=new xc(d.size,40,50),f=Wb.sort(db.letters,Wb.SORT_BY_INDEX),g=a.settings.speedUnit,h=5,j=(e.width+h)/f.length,k=b(),l=d.svg.group(),n=d.svg.group();n.rect(e.width,e.height).move(e.x(0),e.y(0)).attr("class","f"),n.plain(String(i(k,1))+g.id).font({anchor:"end"}).x(e.x(0)-3).cy(e.y(0)).attr("class","v"),n.plain(String(i(k/2,1))+g.id).font({anchor:"end"}).x(e.x(0)-3).cy(e.y(e.height/2)).attr("class","v"),db.data.length>0?c():d.noDataLabel(n,e)}function o(){var a=new yc(U);a.clear();var b=new xc(a.size,40,50),c=Wb.sort(db.letters,Wb.SORT_BY_INDEX),d=5,e=(b.width+d)/c.length,f=.5*b.height,g=.25*b.height-10,h=.25*b.height-10,j=a.svg.group(),k=a.svg.group();if(k.rect(b.width,f).move(b.x(0),b.y(0)).attr("class","f"),k.rect(b.width,g).move(b.x(0),b.y(f+10)).attr("class","f"),k.rect(b.width,h).move(b.x(0),b.y(f+g+20)).attr("class","f"),db.data.length>0)for(var l=0;l<c.length;l++){var n=b.x(l*e),o=db.histogram.map[c[l].charCode],p="l";if(o.h){var q=o.h/db.histogram.maxh*f,r=o.m/db.histogram.maxm*g,s=o.r/db.histogram.maxr*h;j.rect(e-d,q).move(n,b.y(f-q)).attr("class","b h").title(String(o.h)),j.rect(e-d,r).move(n,b.y(f+g-r+10)).attr("class","b m").title(String(o.m)),j.rect(e-d,s).move(n,b.y(f+g+h-s+20)).attr("class","b r").title(String(i(o.r,100))),p="l"}else p="l empty";j.plain(m(c[l])).font({anchor:"middle"}).move(n+e/2-d/2,b.y(b.height)).attr("class",p)}else a.noDataLabel(k,b)}function p(){var a=SVG(W);a.clear();var b=SVG(Y);b.clear();for(var c,d=db.letters,e=db.histogram.minh,f=db.histogram.maxh,g=db.histogram.minm,h=db.histogram.maxm,i=f-e,j=h-g,k=0;k<d.length;k++){var l=d[k],m=db.modeKey.layout.keyCombo(l.charCode);if(m&&!m.deadKey){var n=cb.getKeyPoint(m.key.id),o=db.histogram.map[d[k].charCode];o.h&&(c=Math.round((o.h-e)/i*30)+20,a.circle(c).center(n.cx,n.cy).attr("class","h")),o.m&&(c=Math.round((o.m-g)/j*20)+5,b.circle(c).center(n.cx,n.cy).attr("class","m"))}}}function q(){for(var a=new N(Date.now()),b=Object.create(null),d=f(db.data),e=0;e<d.length;e++){var g=d[e],h=g.date.year+"-"+g.date.month,i=b[h];void 0===i&&(b[h]=i=new s(g.date.year,g.date.month));for(var j=0;j<g.list.length;j++)i.add(g.date.day,g.list[j])}var k=c(b).sort(function(a,b){return a.timeStamp-b.timeStamp});0==k.length&&k.push(new s(a.year,a.month)),Z.empty();for(var l=0;l<k.length;l++)Z.append($(k[l].build()))}function r(a){this.day=a,this.count=0,this.time=0}function s(a,b){this.year=a,this.month=b,this.cell=[];var c=new Date(this.year,this.month-1,1,12,0,0,0);this.timeStamp=c.getTime(),this.dayOffset=0==c.getDay()?6:c.getDay()-1;for(var d=0;42>d;d++)if(d<this.dayOffset)this.cell[d]=null;else{var e=d-this.dayOffset,f=new Date(c.getTime()+1e3*e*60*60*24);this.cell[d]=c.getMonth()==f.getMonth()?new r(e+1):null}}function t(a){function b(a){return 10>a?"0"+a:a}var c=a/3600|0;a-=3600*c;var d=a/60|0;a-=60*d;var e=0|a;return b(c)+":"+b(d)+":"+b(e)}function u(){var c=a.settings.speedUnit,d=Xb.statistics(db.data);if(d.count){F.text(t(d.totalTime/1e3)),G.text(d.count),I.text(i(c.measure(d.topSpeed),1)),J.text(i(c.measure(d.avgSpeed),1));var e=Xb.statistics(b(db.data));K.text(e.count?i(c.measure(e.avgSpeed),1):"N/A")}else F.text(t(0)),G.text("0"),I.text("N/A"),J.text("N/A"),K.text("N/A");var f=db.data.length>bc.WINDOW_SIZE;O.attr({checked:f}),O.attr({disabled:!f}),P.attr({checked:f}),P.attr({disabled:!f}),h(),j(),k(),l(),n(),o(),p(),q()}function v(){function b(a,b){var c=Kb.get(a);d[a]={modeKey:c,data:b},bb.add(c.name,a)}var c=a.database.data,d=Object.create(null);bb.clear(),$.each(c,function(a,c){b(a,c)});var e=String(a.settings.modeKey);void 0===d[e]&&b(e,[]),bb.listen(function(a,b){var c=d[b],e=c.modeKey.layout;cb.init(e),kb.load(e.lang).done(function(a){var b=a.letters.filter(Wb.predicate(e));db={letters:b,modeKey:c.modeKey,data:c.data,forecast:new Zb(b,c.data),histogram:new wc(b,c.data),charCode:0},u()}).fail(B)}),bb.select(e),y(),x(c)}function w(){y()}function x(a){eb=new Blob([JSON.stringify(A(a))],{type:"application/json"}),fb=window.URL.createObjectURL(eb),_.attr({href:fb,download:"typing-data.json"})}function y(){eb=null,fb&&(window.URL.revokeObjectURL(fb),fb=null)}function A(a){var b=Object.create(null);for(var c in a)b[c]={layout:Kb.get(c).layout.name,mode:Kb.get(c).modeType.name,data:a[c].map(function(a){return{timeStamp:a.timeStamp,length:a.length,time:a.time,errors:a.errors,complexity:a.complexity,speed:i(a.speed,1e3),score:i(a.score,1e3),histogram:a.histogram}})};return b}var C=d("section.profile"),D=e("#group-list",C),E=e("#achievements",C),F=e("#g-s-total-time",C),G=e("#g-s-total-samples",C),I=e("#g-s-top-speed",C),J=e("#g-s-avg-speed",C),K=e("#g-s-avg-speed-today",C),L=e("#key-list",C),M=e("#g-learning-rate",C),O=e("#cb-smooth-progress-details",C),P=e("#cb-smooth-speed",C),Q=g("#chart-progress-overview",C[0]),R=g("#chart-progress-details",C[0]),S=g("#chart-speed",C[0]),T=g("#histogram-key-speed",C[0]),U=g("#histogram-key-frequency",C[0]),V=g("#keyboard-heatmap",C[0]),W=g("#keyboard-heatmap .heatmap-overlay.h",C[0]),Y=g("#keyboard-heatmap .heatmap-overlay.m",C[0]),Z=e("#calendar",C),_=e("#_profile-download-data",C),ab=e("#_profile-reset-data",C),bb=new vb.DropDown(D),cb=new sb(V),db=null;r.prototype.add=function(a){this.count++,this.time+=a.time},r.prototype.className=function(){return this.count>30?"s3":this.count>20?"s2":this.count>10?"s1":this.count>0?"s0":"z"},s.prototype.add=function(a,b){this.cell[a+this.dayOffset-1].add(b)},s.prototype.build=function(){var a=H.make("div","calendar"),b=H.make("table"),c=H.make("caption",null,this.year+"/"+this.month);b.appendChild(c);var d=H.make("tr");d.appendChild(H.make("th",null,"M")),d.appendChild(H.make("th",null,"T")),d.appendChild(H.make("th",null,"W")),d.appendChild(H.make("th",null,"T")),d.appendChild(H.make("th",null,"F")),d.appendChild(H.make("th",null,"S")),d.appendChild(H.make("th",null,"S")),b.appendChild(d);for(var e=0;6>e;e++){for(var f=H.make("tr"),g=0;7>g;g++){var h,i=this.cell[7*e+g];null==i?h=H.make("td",null,null):(h=H.make("td",i.className(),i.day),i.count>0&&(h.title=i.count+" sample(s)")),f.appendChild(h)}b.appendChild(f)}return a.appendChild(b),a};var eb=null,fb=null;O.on("click",function(){k()}),P.on("click",function(){l()}),_.on("click",function(){return fb&&window.navigator.msSaveBlob?(window.navigator.msSaveBlob(eb,"typing-data.json"),!1):void 0}),ab.on("click",function(){var b=["Are you sure you want to reset all your learning statistics?","This operation cannon be undone, you will lose data permanently!"].join("\n");confirm(b)&&a.database.clear().done(function(){v(),a.progressNotifier.refresh()}).fail(function(){})}),z({path:"profile",onShow:function(){v()},onHide:function(){w()}})}function w(a){function b(){i.text(m.modeKey.name),h.addClass("loading"),j.hide(),k.show(),g().always(function(){h.removeClass("loading"),j.show(),k.hide()}).done(function(a){c(a)}).fail(B)}function c(a){var b=m.mode,c=m.layout,d=m.speedUnit;l.empty();for(var e=a.collection[c.xid+":"+b.type.xid]||[],f=0;f<e.length;f++){var g=e[f],h=g.user||{id:0,name:"Unknown",fullName:"Unknown",firstName:"Unknown",lastName:"Unknown",externalId:{}},i=h.fullName,j=null;for(var k in h.externalId){var n=h.externalId[k];"facebook"==k&&n.imageUrl&&(n.imageUrl=n.imageUrl+"?type=large"),i=i||n.name,j=j||n.imageUrl}i=i||h.name,j=j||"/res/image/face.svg";var o=$("<tr></tr>");o.append($("<td></td>").addClass("position").text(String(f+1))),o.append($("<td></td>").addClass("avatar").append($("<img>").attr({src:j}))),o.append($("<td></td>").addClass("user").append($("<span></span>").text(i))),o.append($("<td></td>").addClass("speed").text(Math.round(d.measure(g.speed))+" "+d.id)),o.append($("<td></td>").addClass("score").text(Math.round(g.score))),o.append($("<td></td>").addClass("extra").text(String(g.length+"/"+g.complexity+"/"+g.errors))),l.append(o)}}function f(){}function g(){var a=Y.defer();return Z.GET("/highscores/table").send().done(function(b){b.isJson?a.resolve(b.json):a.reject(Y.because("Invalid data"))}).fail(function(b){a.reject(b)}),Y.explain(a.promise(),"Cannot load high scores")}var h=d("section.high-scores"),i=e(".high-scores-name",h),j=e(".high-scores-table",h),k=e(".indicator",h),l=e("tbody",j),m=a.settings;z({path:"high-scores",onShow:function(){b()},onHide:function(){f()}})}function x(a){function b(a){var b=a.fullName,c=null;for(var d in a.externalId){var e=a.externalId[d];"facebook"==d&&e.imageUrl&&(e.imageUrl=e.imageUrl+"?type=large"),b=b||e.name,c=c||e.imageUrl}return b=b||a.name,c=c||"/res/image/face.svg",{name:b,email:a.email,imageUrl:c}}function c(a){Z.POST("/auth/login/register-email").sendForm({email:a}).done(function(b){var c=b.json;c.status?c.newUser?window.location.reload():i.html(["<p>We have sent you an e-mail with login link to address <strong>",a,"</strong>.</p>","<p>It should arrive soon. Please check you inbox in a minute or two.</p>"].join("")):alert("Error sending e-mail. Did you provide a valid e-mail address?")}).fail(B)}var f=$(document.body),g=d("section.account"),i=e("#_login-options",g),j=e("#_login-bth-persona",g),k=e("#_login-txt-email",g),l=e("#_login-bth-email",g),m=e("#_login-btn-logout",g),n=h(".js-have-user"),o=h(".js-need-user"),p=h(".js-user-name"),q=h(".js-user-email"),r=h(".js-user-avatar");if(a.id){console.log("Found authenticated user:",a),f.removeClass("js-user-off").addClass("js-user-on"),o.remove();var s=b(a);p.text(s.name),q.text(s.email),r.attr("src",s.imageUrl)}else console.log("Found anonymous user"),f.removeClass("js-user-on").addClass("js-user-off"),n.remove(),p.text(""),q.text(""),l.on("click",function(){var a=k.val().trim();a&&c(a)});var t=y(a);a.id?t.enabled?m.on("click",function(){t.logout().always(function(){window.location.href="/auth/logout"})}):m.on("click",function(){window.location.href="/auth/logout"}):t.enabled?j.on("click",function(){t.login().done(function(){window.location.reload()}).fail(B)}):j.on("click",function(){alert(["Mozilla Persona API not is available.","Does your browser block domain 'persona.org'?"].join("\n"))})}function y(a){var b=navigator.id;return b instanceof Object?new Bc(a,b):(console.error("Mozilla Persona API not loaded"),{enabled:!1,login:function(){return Y.resolve(null)},logout:function(){return Y.resolve(null)}})}function z(a){document.addEventListener(bb,function(b){var c=b.detail.path;c==a.path&&a.onShow()}),document.addEventListener(db,function(b){var c=b.detail.path;c==a.path&&a.onHide()})}function A(a){function c(a){return document.dispatchEvent(b(db,{detail:{path:a},bubbles:!0,cancelable:!0}))}function e(a){return document.dispatchEvent(b(bb,{detail:{path:a},bubbles:!0,cancelable:!1}))}function f(a){return document.dispatchEvent(b(cb,{detail:{path:a},bubbles:!0,cancelable:!1}))}function g(a,b,c){b.detach(),a.append(c)}function i(a,b,c){function d(){b.off(h),j=!0,k&&g()}function e(){c.off(h),k=!0,j&&g()}function g(){b.detach(),i.detach(),c.detach(),$(document.body).removeClass("animating"),b.removeClass("anim-page-out"),c.removeClass("anim-page-in"),a.append(c),f(p.path)}var h=m.eventName("animation-end"),i=$("<div>").addClass("backstage"),j=!1,k=!1;$(document.body).addClass("animating"),b.addClass("anim-page-out").on(h,d),c.addClass("anim-page-in").on(h,e),i.append(c),a.append(i)}function j(){var a=window.location.hash;return a.startsWith("#")&&(a=a.substring(1)),a.startsWith("!")&&(a=a.substring(1)),a}function k(a){return a.startsWith("!")?a:"!"+a}var l=this,m=P.animationSupport();a=a&&null!=m;var n=d("#perspective"),o=h("section.page[data-path]"),p={path:"null",$page:n.children()},q=null,r=Object.create(null);this.reveal=function(b){if(b=b||q,p.path!=b){var d=r[b]||r[q];d&&c(p.path)&&($("a[href='#"+k(p.path)+"']").removeClass("current"),a?i(n,p.$page,d.$page):g(n,p.$page,d.$page),p=d,$("a[href='#"+k(p.path)+"']").addClass("current"),e(p.path),a||f(p.path),window.location.hash=k(p.path))}},this.init=function(){o.each(function(a,b){var c=$(b),d=c.data("path");d&&(c.detach(),r[d]={path:d,$page:c},q=q||d)}),window.addEventListener("hashchange",function(){l.reveal(j())}),l.reveal(j())}}function B(a){function b(a){return a.message}function c(a){var c=[];for(c.push(b(a));a=a.cause;)c.push("Because: "+b(a));return c}console.error(a),alert(c(a).join("\n"))}function C(){function a(){document.dispatchEvent(b(ab,{detail:{},bubbles:!0,cancelable:!1}))}var c=h(".theme-size"),e=h(".theme-color"),f=d("html");c.on("click",function(b){c.each(function(a,b){f.removeClass($(b).data("theme-class"))}),f.addClass($(b.target).data("theme-class")),b.preventDefault(),a()}),e.on("click",function(b){e.each(function(a,b){f.removeClass($(b).data("theme-color"))}),f.addClass($(b.target).data("theme-color")),b.preventDefault(),a()})}function D(a,b){x(a);var c=new A(b.flag("animate",!0)),d=new Lb(j("settings")),e=new Ob(k("history"),l(a));e.open().done(function(){d.update(b);var a=new tc(d,e);t(a),v(a),w(a),u(a),s(a),a.init(),c.init(),a.start(),E()}).fail(B)}function E(){var a=document.querySelectorAll(".ad-block iframe");0==a.length&&document.addEventListener(hb,function(){})}function F(a){$("#perspective").empty().html(['<div class="veil"><div>',a,"</div></div>"].join("\n"))}function G(){try{C(),D(a(),new L)}catch(b){throw F(["<h1>JavaScript Error</h1>","<p>Cannot initialize application because of JavaScript error:</p>","<p>",P.escapeHtml(b.message),"</p>"].join("\n")),Dc.log(b),b}}SVG.ForeignObject=function(){this.constructor.call(this,SVG.create("foreignObject")),this.type="foreignObject"},SVG.ForeignObject.prototype=new SVG.Shape,SVG.extend(SVG.ForeignObject,{appendChild:function(a,b){var c="string"==typeof a?document.createElement(a):a;if("object"==typeof b)for(var d in b)c[d]=b[d];return this.node.appendChild(c),this},getChild:function(a){return this.node.childNodes[a]}}),SVG.extend(SVG.Container,{foreignObject:function(a,b){return this.put(new SVG.ForeignObject).size(null==a?100:a,null==b?100:b)}}),SVG.extend(SVG.Element,{title:function(a){var b=SVG.create("title");return b.textContent=a,this.node.insertBefore(b,this.node.firstChild),this}}),SVG.defaults.attrs["font-family"]=null,"requestAnimationFrame"in window||(window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame),"cancelAnimationFrame"in window||(window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame),"URL"in window||(window.URL=window.URL||window.webkitURL||window.mozURL),"startsWith"in String.prototype||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(a,b){var c=b||0;if(a.length+c>this.length)return!1;for(var d=0;d<a.length;d++)if(this.charCodeAt(c+d)!=a.charCodeAt(d))return!1;return!0}}),"endsWith"in String.prototype||Object.defineProperty(String.prototype,"endsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(a,b){var c=(b||this.length)-a.length;if(a.length+c>this.length)return!1;for(var d=0;d<a.length;d++)if(this.charCodeAt(c+d)!=a.charCodeAt(d))return!1;return!0}});var H,I=function(){function a(){}return a.now=function(){return a.now=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()},a.now()},a.getTime=function(){return Date.now()},a}(),J=function(){function a(){}return a.fromCode=function(a,b,c){for(var d in a){var e=a[d];
if(e.id===b)return e}if(void 0===c)throw new Error;return c},a.fromXCode=function(a,b,c){for(var d in a){var e=a[d];if(e.xid===b)return e}if(void 0===c)throw new Error;return c},a}(),K=function(){function a(a){this.map=Object.create(null),this.fn=a}return a.prototype.get=function(a){var b=this.map[a];return null==b&&(b=this.map[a]=this.fn(a)),b},a.prototype.pub=function(a,b){this.map[a]=b},a}(),L=function(){function a(){var a=this,b=window.location.search;b.startsWith("?")&&(b=b.substring(1)),b.split("&").map(function(b){var c,d=b.split("="),e=decodeURIComponent(d[0]);c=void 0==d[1]?null:decodeURIComponent(d[1]),a[e]=c},this)}return a.prototype.flag=function(a,b){return b=!!b,a in this?"false"!=this[a]:b},a}(),M=function(){function a(a){if(3==arguments.length)return this.r=arguments[0],this.g=arguments[1],this.b=arguments[2],this;if("number"==typeof a)return this.r=a>>16&255,this.g=a>>8&255,this.b=255&a,this;if("string"==typeof a){var b;if(b=a.match(/^#([a-z0-9]{2})([a-z0-9]{2})([a-z0-9]{2})$/i))return this.r=parseInt(b[1],16),this.g=parseInt(b[2],16),this.b=parseInt(b[3],16),this;if(b=a.match(/^rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)$/i))return this.r=parseInt(b[1],10),this.g=parseInt(b[2],10),this.b=parseInt(b[3],10),this}throw new Error}return a.prototype.shade=function(a){function b(a,b){return a+=b,a>255?255:0>a?0:a}return this.r=b(this.r,a),this.g=b(this.g,a),this.b=b(this.b,a),this},a.prototype.toHex=function(){function a(a){return 16>a?"0"+a.toString(16):a.toString(16)}return("#"+a(this.r)+a(this.g)+a(this.b)).toUpperCase()},a.prototype.toRgb=function(){return"rgb("+this.r+","+this.g+","+this.b+")"},a.prototype.toString=function(){return this.toHex()},a}(),N=function(){function a(a){return"number"==typeof a&&(a=new Date(a)),this.year=a.getFullYear(),this.month=a.getMonth()+1,this.day=a.getDate(),this.s=this.year+"-"+this.month+"-"+this.day,Object.freeze(this)}return a.prototype.toString=function(){return this.s},a}(),O=function(){function a(){}return a.toFlat=function(a){return a.split("-").map(function(a){return a.toLowerCase()}).join("")},a.toPascalCase=function(a){return a.split("-").map(function(a){return a.substring(0,1).toUpperCase()+a.substring(1).toLowerCase()}).join("")},a.toCamelCase=function(a){return a.split("-").map(function(a,b){return 0==b?a.toLowerCase():a.substring(0,1).toUpperCase()+a.substring(1).toLowerCase()}).join("")},a}();!function(a){function b(a,b){var c=a.querySelector(b);if(null==c)throw new Error("Selectors matched nothing: '"+b+"'");return c}function c(a,b){var c=a.querySelectorAll(b);if(0==c.length)throw new Error("Selectors matched nothing: '"+b+"'");return c}function d(a,b){return a.hasAttribute(b)}function e(a,b){return a.getAttribute(b)}function f(a,b,c){a.setAttribute(b,c)}function g(a,b){a.removeAttribute(b)}function h(b,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&a.setAttr(b,d,c[d])}function i(a,b,c){return a.dataset?a.dataset[O.toCamelCase(b)]=c:void a.setAttr("data-"+b,String(c))}function j(a,b){a.dataset?delete a.dataset[O.toCamelCase(b)]:a.removeAttr("data-"+b)}function k(a,b){return a.dataset?void 0!=a.dataset[O.toCamelCase(b)]:a.hasAttr("data-"+b)}function l(a,b){if(a.dataset)return a.dataset[O.toCamelCase(b)];var c=a.getAttr("data-"+b);switch(c){case"null":return null;case"false":return!1;case"true":return!0}return c}function m(b,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&a.setData(b,d,c[d]);return this}function n(a,b){if("classList"in a)return a.classList.contains(b);if("className"in a){var c;return c=A("baseVal"in a.className?a.className.baseVal:a.className),-1!=c.indexOf(b)}throw new Error}function o(a,b){if("classList"in a)a.classList.add(b);else{if(!("className"in a))throw new Error;var c,d;"baseVal"in a.className?(c=A(a.className.baseVal),-1==(d=c.indexOf(b))&&(c.push(b),a.className.baseVal=c.join(" "))):(c=A(a.className),-1==(d=c.indexOf(b))&&(c.push(b),a.className=c.join(" ")))}}function p(a,b){if("classList"in a)a.classList.remove(b);else{if(!("className"in a))throw new Error;var c,d;"baseVal"in a.className?(c=A(a.className.baseVal),-1!=(d=c.indexOf(b))&&(c.splice(d,1),a.className.baseVal=c.join(" "))):(c=A(a.className),-1!=(d=c.indexOf(b))&&(c.splice(d,1),a.className=c.join(" ")))}}function q(a,b){if("classList"in a)a.classList.toggle(b);else{if(!("className"in a))throw new Error;var c,d;"baseVal"in a.className?(c=A(a.className.baseVal),-1!=(d=c.indexOf(b))?c.splice(d,1):c.push(b),a.className.baseVal=c.join(" ")):(c=A(a.className),-1!=(d=c.indexOf(b))?c.splice(d,1):c.push(b),a.className=c.join(" "))}}function r(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)}function s(a,b){a.textContent=b}function t(a){return a.textContent}function u(a,b){if(!("innerHTML"in a))throw new TypeError;a.innerHTML=b}function v(a){if("innerHTML"in a)return a.innerHTML;throw new TypeError}function w(a,b,c,d){var e;return e=D in a?a[D]:a[D]=Object.create(null),b in e&&a.removeEventListener(b,e[b].listener,c[b].capture),a.addEventListener(b,c,d),e[b]={listener:c,capture:d},this}function x(a,b){var c;return D in a&&(c=a[D],b in c&&a.removeEventListener(b,c[b].listener,c[b].capture),delete c[b]),this}function y(a){a instanceof Array&&(a=B(a));var b=new DocumentFragment,c=document.createElement("div");c.innerHTML=a;for(var d=0;d<c.childNodes.length;d++)b.appendChild(c.childNodes[d]);return b}function z(a,b){for(var c in b)a.prototype[c]=b[c]}function A(a){return a=a.trim(),""==a?[]:a.split(/\s+/)}function B(a){return a instanceof Array?a.map(function(a){return B(a)}).join(""):a}function C(a,b,c){var d=document.createElement(a);if(b)if(b instanceof Array)for(var e=0;e<b.length;e++)d.classList.add(b[e]);else d.classList.add(b);return c&&(d.textContent=c),d}a.elementProto=Object.create(null),a.nodeListProto=Object.create(null),a.one=b,a.elementProto.$one=function(b){return a.one(this,b)},a.all=c,a.elementProto.$all=function(b){return a.all(this,b)},a.nodeListProto.forEach=function(a){[].forEach.call(this,a)},a.nodeListProto.map=function(a){return[].map.call(this,a)},a.nodeListProto.filter=function(a){return[].filter.call(this,a)},a.hasAttr=d,a.elementProto.hasAttr=function(b){return a.hasAttr(this,b)},a.getAttr=e,a.elementProto.getAttr=function(b){return a.getAttr(this,b)},a.setAttr=f,a.elementProto.setAttr=function(b,c){return a.setAttr(this,b,c),this},a.nodeListProto.setAttr=function(b,c){return this.forEach(function(d){1==d.nodeType&&a.setAttr(d,b,c)}),this},a.removeAttr=g,a.elementProto.removeAttr=function(b){return a.removeAttr(this,b),this},a.nodeListProto.removeAttr=function(b){return this.forEach(function(c){1==c.nodeType&&a.removeAttr(c,b)}),this},a.attrMap=h,a.elementProto.attrMap=function(b){return a.attrMap(this,b),this},a.nodeListProto.attrMap=function(b){return this.forEach(function(c){1==c.nodeType&&a.attrMap(c,b)}),this},a.setData=i,a.elementProto.setData=function(b,c){return a.setData(this,b,c),this},a.nodeListProto.setData=function(b,c){return this.forEach(function(d){1==d.nodeType&&a.setData(d,b,c)}),this},a.removeData=j,a.elementProto.removeData=function(b){return a.removeData(this,b),this},a.nodeListProto.removeData=function(b){return this.forEach(function(c){1==c.nodeType&&a.removeData(c,b)}),this},a.hasData=k,a.elementProto.hasData=function(b){return a.hasData(this,b)},a.getData=l,a.elementProto.getData=function(b){return a.getData(this,b)},a.dataMap=m,a.elementProto.dataMap=function(b){return a.dataMap(this,b),this},a.nodeListProto.dataMap=function(b){return this.forEach(function(c){1==c.nodeType&&a.dataMap(c,b)}),this},a.hasClass=n,a.elementProto.hasClass=function(b){return a.hasClass(this,b)},a.addClass=o,a.elementProto.addClass=function(b){return a.addClass(this,b),this},a.nodeListProto.addClass=function(b){return this.forEach(function(c){1==c.nodeType&&a.addClass(c,b)}),this},a.removeClass=p,a.elementProto.removeClass=function(b){return a.removeClass(this,b),this},a.nodeListProto.removeClass=function(b){return this.forEach(function(c){1==c.nodeType&&a.removeClass(c,b)}),this},a.toggleClass=q,a.elementProto.toggleClass=function(b){return a.toggleClass(this,b),this},a.nodeListProto.toggleClass=function(b){return this.forEach(function(c){1==c.nodeType&&a.toggleClass(c,b)}),this},a.cssMap=r,a.elementProto.cssMap=function(b){return a.cssMap(this,b),this},a.nodeListProto.cssMap=function(b){return this.forEach(function(c){1==c.nodeType&&a.cssMap(c,b)}),this},a.setText=s,a.elementProto.setText=function(b){return a.setText(this,b),this},a.nodeListProto.setText=function(b){return this.forEach(function(c){1==c.nodeType&&a.setText(c,b)}),this},a.getText=t,a.elementProto.getText=function(){return a.getText(this)},a.nodeListProto.getText=function(){var b=[];return this.forEach(function(c){1==c.nodeType?b.push(a.getText(c)):3==c.nodeType&&b.push(c.textContent)}),b.join("")},a.setHtml=u,a.elementProto.setHtml=function(b){return a.setHtml(this,b),this},a.nodeListProto.setHtml=function(b){return this.forEach(function(c){1==c.nodeType&&a.setHtml(c,b)}),this},a.getHtml=v,a.elementProto.getHtml=function(){return a.getHtml(this)},a.nodeListProto.getHtml=function(){var b=[];return this.forEach(function(c){1==c.nodeType?b.push(a.getHtml(c)):3==c.nodeType&&b.push(c.textContent)}),b.join("")};var D="__listener__";a.on=w,a.elementProto.on=function(b,c,d){return a.on(this,b,c,d),this},a.nodeListProto.on=function(b,c,d){return this.forEach(function(e){1==e.nodeType&&a.on(e,b,c,d)}),this},a.off=x,a.elementProto.off=function(b){return a.off(this,b),this},a.nodeListProto.off=function(b){return this.forEach(function(c){1==c.nodeType&&a.off(c,b)}),this},a.parse=y,z(Element,a.elementProto),z(NodeList,a.nodeListProto),a.make=C}(H||(H={}));var P;!function(a){function b(a){var b=Y.defer(),c=document.createElement("script");return c.async=!1,c.addEventListener("load",function(){b.resolve(c)}),c.addEventListener("error",function(){b.reject({message:"Cannot load script from uri "+a})}),c.type="text/javascript",c.src=a,document.head.appendChild(c),b.promise()}function c(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}a.loadScript=b,a.escapeHtml=c}(P||(P={}));var P;!function(a){function b(){for(var a=0;a<g.length;a++){var b=g[a];if(b.styleName("animation-name")in document.body.style)return b}return null}function c(a,b){return function(c){return a+b(c)}}var d={vendor:"standard",styleName:O.toCamelCase,eventName:O.toFlat},e={vendor:"webkit",styleName:c("webkit",O.toPascalCase),eventName:c("webkit",O.toPascalCase)},f={vendor:"moz",styleName:c("moz",O.toPascalCase),eventName:c("moz",O.toPascalCase)},g=[d,e,f];a.animationSupport=b}(P||(P={}));var Q;!function(a){function b(a){return h(document.cookie)[a]}function c(b,c,d){return d=e(d),d.expires=f(void 0===c?-1:d.expires,null),document.cookie=g(b,c,d),a}function d(b,c){return this.set(b,void 0,c),a}function e(b){return{path:b&&b.path||a.defaults.path,domain:b&&b.domain||a.defaults.domain,expires:b&&b.expires||a.defaults.expires,secure:b&&void 0!==b.secure?b.secure:a.defaults.secure}}function f(a,b){switch(b=b||new Date,typeof a){case"number":a=new Date(b.getTime()+1e3*a);break;case"string":a=new Date(a)}return a}function g(a,b,c){a=encodeURIComponent(a),b=encodeURIComponent(b),c=c||{path:"/"};var d=a+"="+b;return c.path&&(d+=";path="+c.path),c.domain&&(d+=";domain="+c.domain),c.expires&&(d+=";expires="+c.expires.toUTCString()),c.secure&&(d+=";secure"),d}function h(a){for(var b={},c=a?a.split("; "):[],d=0;d<c.length;d++){var e=i(c[d]);void 0===b[e.key]&&(b[e.key]=e.value)}return b}function i(a){var b=a.indexOf("=");return b=-1===b?a.length:b,{key:decodeURIComponent(a.substring(0,b)),value:decodeURIComponent(a.substring(b+1))}}a.defaults={path:"/"},a.get=b,a.set=c,a.expire=d}(Q||(Q={}));var R;!function(a){a[a.BACK_SPACE=8]="BACK_SPACE",a[a.TAB=9]="TAB",a[a.CLEAR=12]="CLEAR",a[a.RETURN=13]="RETURN",a[a.SHIFT=16]="SHIFT",a[a.CONTROL=17]="CONTROL",a[a.ALT=18]="ALT",a[a.PAUSE=19]="PAUSE",a[a.CAPS_LOCK=20]="CAPS_LOCK",a[a.ESCAPE=27]="ESCAPE",a[a.SPACE=32]="SPACE",a[a.PAGE_UP=33]="PAGE_UP",a[a.PAGE_DOWN=34]="PAGE_DOWN",a[a.END=35]="END",a[a.HOME=36]="HOME",a[a.LEFT=37]="LEFT",a[a.UP=38]="UP",a[a.RIGHT=39]="RIGHT",a[a.DOWN=40]="DOWN",a[a.PRINT_SCREEN=44]="PRINT_SCREEN",a[a.INSERT=45]="INSERT",a[a.DELETE=46]="DELETE",a[a.N0=48]="N0",a[a.N1=49]="N1",a[a.N2=50]="N2",a[a.N3=51]="N3",a[a.N4=52]="N4",a[a.N5=53]="N5",a[a.N6=54]="N6",a[a.N7=55]="N7",a[a.N8=56]="N8",a[a.N9=57]="N9",a[a.A=65]="A",a[a.B=66]="B",a[a.C=67]="C",a[a.D=68]="D",a[a.E=69]="E",a[a.F=70]="F",a[a.G=71]="G",a[a.H=72]="H",a[a.I=73]="I",a[a.J=74]="J",a[a.K=75]="K",a[a.L=76]="L",a[a.M=77]="M",a[a.N=78]="N",a[a.O=79]="O",a[a.P=80]="P",a[a.Q=81]="Q",a[a.R=82]="R",a[a.S=83]="S",a[a.T=84]="T",a[a.U=85]="U",a[a.V=86]="V",a[a.W=87]="W",a[a.X=88]="X",a[a.Y=89]="Y",a[a.Z=90]="Z",a[a.CONTEXT_MENU=93]="CONTEXT_MENU",a[a.NUMPAD0=96]="NUMPAD0",a[a.NUMPAD1=97]="NUMPAD1",a[a.NUMPAD2=98]="NUMPAD2",a[a.NUMPAD3=99]="NUMPAD3",a[a.NUMPAD4=100]="NUMPAD4",a[a.NUMPAD5=101]="NUMPAD5",a[a.NUMPAD6=102]="NUMPAD6",a[a.NUMPAD7=103]="NUMPAD7",a[a.NUMPAD8=104]="NUMPAD8",a[a.NUMPAD9=105]="NUMPAD9",a[a.MULTIPLY=106]="MULTIPLY",a[a.ADD=107]="ADD",a[a.SEPARATOR=108]="SEPARATOR",a[a.SUBTRACT=109]="SUBTRACT",a[a.DECIMAL=110]="DECIMAL",a[a.DIVIDE=111]="DIVIDE",a[a.F1=112]="F1",a[a.F2=113]="F2",a[a.F3=114]="F3",a[a.F4=115]="F4",a[a.F5=116]="F5",a[a.F6=117]="F6",a[a.F7=118]="F7",a[a.F8=119]="F8",a[a.F9=120]="F9",a[a.F10=121]="F10",a[a.F11=122]="F11",a[a.F12=123]="F12",a[a.F13=124]="F13",a[a.F14=125]="F14",a[a.F15=126]="F15",a[a.F16=127]="F16",a[a.NUM_LOCK=144]="NUM_LOCK",a[a.SCROLL_LOCK=145]="SCROLL_LOCK",a[a.SEMICOLON=186]="SEMICOLON",a[a.EQUALS=187]="EQUALS",a[a.COMMA=188]="COMMA",a[a.DASH=189]="DASH",a[a.PERIOD=190]="PERIOD",a[a.SLASH=191]="SLASH",a[a.BACK_QUOTE=192]="BACK_QUOTE",a[a.OPEN_BRACKET=219]="OPEN_BRACKET",a[a.BACK_SLASH=220]="BACK_SLASH",a[a.CLOSE_BRACKET=221]="CLOSE_BRACKET",a[a.QUOTE=222]="QUOTE",a[a.META=224]="META",a[a.ALTGR=225]="ALTGR",a[a.OEM_102=226]="OEM_102",a[a.ALT_SEMICOLON=59]="ALT_SEMICOLON",a[a.ALT_EQUALS=61]="ALT_EQUALS",a[a.ALT_HYPHEN_MINUS=173]="ALT_HYPHEN_MINUS"}(R||(R={}));var S;!function(a){a[a.STANDARD=KeyboardEvent.DOM_KEY_LOCATION_STANDARD]="STANDARD",a[a.LEFT=KeyboardEvent.DOM_KEY_LOCATION_LEFT]="LEFT",a[a.RIGHT=KeyboardEvent.DOM_KEY_LOCATION_RIGHT]="RIGHT",a[a.NUMPAD=KeyboardEvent.DOM_KEY_LOCATION_NUMPAD]="NUMPAD"}(S||(S={}));var T,U=function(){function a(){this.listener=null}return a.listen=function(b){a.INSTANCE._listen(b)},a._keyDown=function(b){a.INSTANCE._keyDown(b)},a._keyPress=function(b){a.INSTANCE._keyPress(b)},a._keyUp=function(b){a.INSTANCE._keyUp(b)},a.prototype._listen=function(a){this.listener=a,this.attach(),this.reset()},a.prototype.reset=function(){this.keyCode=0,this.key={type:null,timeStamp:0,location:0,key:null,charCode:0,keyCode:0,shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1}},a.prototype.attach=function(){this.detach(),document.addEventListener("keydown",a._keyDown,!0),document.addEventListener("keypress",a._keyPress,!0),document.addEventListener("keyup",a._keyUp,!0)},a.prototype.detach=function(){document.removeEventListener("keydown",a._keyDown,!0),document.removeEventListener("keypress",a._keyPress,!0),document.removeEventListener("keyup",a._keyUp,!0)},a.prototype._keyDown=function(a){this.keyCode!=a.keyCode&&(this.keyCode=a.keyCode,this.listener&&this.listener(!0,this.translateEvent(a))===!1&&(a.stopPropagation(),a.preventDefault()))},a.prototype._keyPress=function(){},a.prototype._keyUp=function(a){this.keyCode==a.keyCode&&(this.keyCode=0),this.listener&&this.listener(!1,this.translateEvent(a))===!1&&(a.stopPropagation(),a.preventDefault())},a.prototype.translateEvent=function(a){var b={type:a.type,timeStamp:a.timeStamp,location:a.location,key:a.key||a.keyIdentifier||null,charCode:a.charCode,keyCode:a.keyCode,shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.ctrlKey,metaKey:a.metaKey};switch(a.keyCode){case 59:b.keyCode=186;break;case 61:b.keyCode=187;break;case 173:b.keyCode=189}return this.key=b},a.isSpecialKey=function(a){return a.ctrlKey||a.metaKey||16==a.keyCode||17==a.keyCode||18==a.keyCode||224==a.keyCode||20==a.keyCode||93==a.keyCode||112==a.keyCode||113==a.keyCode||114==a.keyCode||115==a.keyCode||116==a.keyCode||117==a.keyCode||118==a.keyCode||119==a.keyCode||120==a.keyCode||121==a.keyCode||122==a.keyCode||123==a.keyCode||124==a.keyCode||125==a.keyCode||126==a.keyCode||127==a.keyCode||45==a.keyCode||36==a.keyCode||33==a.keyCode||46==a.keyCode||35==a.keyCode||34==a.keyCode||38==a.keyCode||37==a.keyCode||40==a.keyCode||39==a.keyCode||144==a.keyCode||145==a.keyCode},a.INSTANCE=new a,a}();!function(a){function b(a){return a>=q.MIN_CODE_POINT&&a<=q.MAX_CODE_POINT}function c(a){return a>>>16==0}function d(a){return a>=q.MIN_SUPPLEMENTARY_CODE_POINT&&a<=q.MAX_CODE_POINT}function e(a){return a>=q.MIN_HIGH_SURROGATE&&a<=q.MAX_HIGH_SURROGATE}function f(a){return a>=q.MIN_LOW_SURROGATE&&a<=q.MAX_LOW_SURROGATE}function g(a){return a>=q.MIN_SURROGATE&&a<=q.MAX_SURROGATE}function h(b,c){return a.isHighSurrogate(b)&&a.isLowSurrogate(c)}function i(b){return a.isCombiningDiacriticalMark(b)}function j(a){return a>=q.COMBINING_DIACRITICAL_MARK_MIN&&a<=q.COMBINING_DIACRITICAL_MARK_MAX}function k(a,b){var c=r[b];return c?c.combine(a):a}function l(a){for(var b=0;b<r.length;b++){var c=r[b];if(c){var d=c.uncombine(a);if(d!=a)return d}}return a}function m(a){var b=r[a];return b?b.image:a}function n(a){return"string"==typeof a&&(a=a.charCodeAt(0)),32==a||9==a||10==a||13==a||160==a||8192==a||8193==a||8194==a||8195==a||8232==a||8233==a}function o(a){return"string"==typeof a&&(a=a.charCodeAt(0)),10==a||13==a||8232==a||8233==a}function p(a){function b(a,b,c,d,e){a[b]=new s(b,c,d,e)}b(a,q.COMBINING_DIACRITIC_ACUTE,q.DIACRITIC_ACUTE,"AaCcEeGgIiKkLlMmNnOoPpRrSsUuWwYyZz","ÁáĆćÉéǴǵÍíḰḱĹĺḾḿŃńÓóṔṕŔŕŚśÚúẂẃÝýŹź"),b(a,q.COMBINING_DIACRITIC_DOUBLE_ACUTE,q.DIACRITIC_DOUBLE_ACUTE,"OoUu","ŐőŰű"),b(a,q.COMBINING_DIACRITIC_CEDILLA,q.DIACRITIC_CEDILLA,"CcDdEeGgHhKkLlNnRrSsTt","ÇçḐḑȨȩĢģḨḩĶķĻļŅņŖŗŞşŢţ"),b(a,q.COMBINING_DIACRITIC_CIRCUMFLEX,q.DIACRITIC_CIRCUMFLEX,"AaCcEeGgHhIiJjOoSsUuWwYyZz","ÂâĈĉÊêĜĝĤĥÎîĴĵÔôŜŝÛûŴŵŶŷẐẑ"),b(a,q.COMBINING_DIACRITIC_DIAERESIS,q.DIACRITIC_DIAERESIS,"AaEeHhIiOotUuWwXxYy","ÄäËëḦḧÏïÖöẗÜüẄẅẌẍŸÿ"),b(a,q.COMBINING_DIACRITIC_GRAVE,q.DIACRITIC_GRAVE,"AaEeIiNnOoUuWwYy","ÀàÈèÌìǸǹÒòÙùẀẁỲỳ"),b(a,q.COMBINING_DIACRITIC_TILDE,q.DIACRITIC_TILDE,"AaEeIiNnOoUuVvYy","ÃãẼẽĨĩÑñÕõŨũṼṽỸỹ")}var q=function(){function a(){}return a.MIN_HIGH_SURROGATE=55296,a.MAX_HIGH_SURROGATE=56319,a.MIN_LOW_SURROGATE=56320,a.MAX_LOW_SURROGATE=57343,a.MIN_SURROGATE=55296,a.MAX_SURROGATE=57343,a.MIN_SUPPLEMENTARY_CODE_POINT=65536,a.MIN_CODE_POINT=0,a.MAX_CODE_POINT=1114111,a.COMBINING_DIACRITICAL_MARK_MIN=768,a.COMBINING_DIACRITICAL_MARK_MAX=879,a.DIACRITIC_ACUTE=180,a.COMBINING_DIACRITIC_ACUTE=769,a.DIACRITIC_DOUBLE_ACUTE=733,a.COMBINING_DIACRITIC_DOUBLE_ACUTE=779,a.DIACRITIC_BREVE=728,a.COMBINING_DIACRITIC_BREVE=774,a.DIACRITIC_CARON=711,a.COMBINING_DIACRITIC_CARON=780,a.DIACRITIC_CEDILLA=184,a.COMBINING_DIACRITIC_CEDILLA=807,a.DIACRITIC_CIRCUMFLEX=710,a.COMBINING_DIACRITIC_CIRCUMFLEX=770,a.DIACRITIC_DIAERESIS=168,a.COMBINING_DIACRITIC_DIAERESIS=776,a.DIACRITIC_GRAVE=96,a.COMBINING_DIACRITIC_GRAVE=768,a.DIACRITIC_TILDE=126,a.COMBINING_DIACRITIC_TILDE=771,a}();a.Const=q;var r=[];a.isValidCodePoint=b,a.isBmpCodePoint=c,a.isSupplementaryCodePoint=d,a.isHighSurrogate=e,a.isLowSurrogate=f,a.isSurrogate=g,a.isSurrogatePair=h,a.isCombining=i,a.isCombiningDiacriticalMark=j,a.combine=k,a.uncombine=l,a.combinerImage=m,a.isWs=n,a.isNl=o;var s=function(){function b(b,c,d,e){if(d.length!=e.length)throw new Error;for(var f=0;f<e.length;f++)if(a.isCombining(e.charCodeAt(f)))throw new Error;return this.combiner=b,this.image=c,this.from=d,this.to=e,Object.freeze(this)}return b.prototype.combine=function(a){for(var b=0;b<this.from.length;b++)if(this.from.charCodeAt(b)==a)return this.to.charCodeAt(b);return a},b.prototype.uncombine=function(a){for(var b=0;b<this.to.length;b++)if(this.to.charCodeAt(b)==a)return this.from.charCodeAt(b);return a},b}();p(r)}(T||(T={}));var V;!function(a){var b=function(){function a(b,c){this.buffer=b,this.position=0,this.length=a.align(this.buffer.length,c)}return a.prototype.more=function(){return this.position<this.length},a.prototype.getUint32=function(){var a=this.getUint8(),b=this.getUint8(),c=this.getUint8(),d=this.getUint8();return a<<24|b<<16|c<<8|d<<0},a.prototype.putUint32=function(a){this.putUint8(a>>>24&255),this.putUint8(a>>>16&255),this.putUint8(a>>>8&255),this.putUint8(a>>>0&255)},a.prototype.getUint8=function(){var a;if(this.position<this.buffer.length)a=this.buffer[this.position];else{if(!(this.position<this.length))throw new Error;a=0}return this.position++,a},a.prototype.putUint8=function(a){if(this.position<this.buffer.length)this.buffer[this.position++]=a;else{if(!(this.position<this.length))throw new Error;this.position++}},a.align=function(a,b){return a+(b-1)&-b},a}();a.Cursor=b}(V||(V={}));var V;!function(a){function b(a){for(var b=4294967295,c=0;c<a.length;c++)b=b>>>8^d[255&(b^a[c])];return 4294967295^b}function c(){for(var a=[],b=0;256>b;b++){for(var c=b,d=0;8>d;d++)c=1&c?3988292384^c>>>1:c>>>1;a[b]=c}return a}var d=c();a.crc32=b}(V||(V={}));var V;!function(a){function b(a){function b(){return i<a.length?a[i++]:i==a.length?(i++,128):(i++,0)}function e(){if(h-1>j){var c=b(),d=b(),e=b(),f=b(),g=c<<24|d<<16|e<<8|f;return j++,g}return j==h-1?(j++,8*a.length):(i++,0)}for(var f=a.length+1+8,g=f+63>>>6,h=g<<4,i=0,j=0,k=[1518500249,1859775393,2400959708,3395469782],l=1732584193,m=4023233417,n=2562383102,o=271733878,p=3285377520,q=new Array(80),r=0;g>r;r++){for(var s=0;16>s;s++)q[s]=e();for(var s=16;80>s;s++)q[s]=d(q[s-3]^q[s-8]^q[s-14]^q[s-16],1);for(var t=l,u=m,v=n,w=o,x=p,s=0;80>s;s++){var y=s/20|0,z=d(t,5)+c(y,u,v,w)+x+k[y]+q[s]&4294967295;x=w,w=v,v=d(u,30),u=t,t=z}l=l+t&4294967295,m=m+u&4294967295,n=n+v&4294967295,o=o+w&4294967295,p=p+x&4294967295}var A=new ArrayBuffer(20),B=new DataView(A);return B.setUint32(0,l),B.setUint32(4,m),B.setUint32(8,n),B.setUint32(12,o),B.setUint32(16,p),new Uint8Array(A)}function c(a,b,c,d){switch(a){case 0:return b&c^~b&d;case 1:return b^c^d;case 2:return b&c^b&d^c&d;case 3:return b^c^d}throw new Error}function d(a,b){return a<<b|a>>>32-b}a.sha1=b}(V||(V={}));var V;!function(a){var b;!function(a){function b(a,b){var c,d,e,f=[];for(c=0;256>c;c++)f[c]=c;for(d=0,c=0;256>c;c++)d=(d+f[c]+a[c%a.length])%256,e=f[c],f[c]=f[d],f[d]=e;c=0,d=0;for(var g=0;g<b.length;g++)c=(c+1)%256,d=(d+f[c])%256,e=f[c],f[c]=f[d],f[d]=e,b[g]^=f[(f[c]+f[d])%256]}function c(a,c){var d=f();return b(g(d,a),c),g(d,c)}function d(a,c){var d=new Uint8Array(c.buffer,0,4),e=new Uint8Array(c.buffer,4);return b(g(d,a),e),e}function e(a){var b=new Uint8Array(4);return b[0]=a>>>24&255,b[1]=a>>>16&255,b[2]=a>>>8&255,b[3]=a>>>0&255,b}function f(){var a=Math.floor(4294967295*Math.random()),b=new Uint8Array(4);return b[0]=a>>>24&255,b[1]=a>>>16&255,b[2]=a>>>8&255,b[3]=a>>>0&255,b}function g(a,b){var c=new Uint8Array(a.length+b.length);return c.set(a,0),c.set(b,a.length),c}a.rc4=b,a.encode=c,a.decode=d,a.key=e}(b=a.RC4||(a.RC4={}))}(V||(V={}));var V;!function(a){var b=function(){function b(c){if(c.length!=2*b.BLOCK_SIZE)throw new Error;this.key=[],this.y=0,this.z=0;var d=new a.Cursor(c,b.BLOCK_SIZE);this.key.push(d.getUint32()),this.key.push(d.getUint32()),this.key.push(d.getUint32()),this.key.push(d.getUint32())}return b.prototype.encryptBlock=function(){for(var a=0,b=0;32>b;b++)this.y+=(this.z<<4^this.z>>>5)+this.z^a+this.key[3&a],a+=2654435769,this.z+=(this.y<<4^this.y>>>5)+this.y^a+this.key[a>>>11&3]},b.prototype.decryptBlock=function(){for(var a=3337565984,b=0;32>b;b++)this.z-=(this.y<<4^this.y>>>5)+this.y^a+this.key[a>>>11&3],a-=2654435769,this.y-=(this.z<<4^this.z>>>5)+this.z^a+this.key[3&a]},b.prototype.encrypt=function(c){var d=new Uint8Array(a.Cursor.align(c.length,b.BLOCK_SIZE)+b.BLOCK_SIZE),e=new a.Cursor(c,b.BLOCK_SIZE),f=new a.Cursor(d,b.BLOCK_SIZE),g=4294967295*Math.random()>>>0,h=4294967295*Math.random()>>>0;for(f.putUint32(g),f.putUint32(h),this.y=0,this.z=0;e.more();)this.y=e.getUint32()^g,this.z=e.getUint32()^h,this.encryptBlock(),f.putUint32(g=this.y),f.putUint32(h=this.z);return d},b.prototype.decrypt=function(c){var d=new Uint8Array(a.Cursor.align(c.length,b.BLOCK_SIZE)-b.BLOCK_SIZE),e=new a.Cursor(c,b.BLOCK_SIZE),f=new a.Cursor(d,b.BLOCK_SIZE),g=e.getUint32(),h=e.getUint32();for(this.y=0,this.z=0;e.more();){var i=this.y=e.getUint32(),j=this.z=e.getUint32();this.decryptBlock(),f.putUint32(this.y^g),f.putUint32(this.z^h),g=i,h=j}return d},b.BLOCK_SIZE=8,b}();a.XTea=b}(V||(V={}));var V;!function(a){var b;!function(a){function b(a){for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);b+=128>d?1:2048>d?2:3}return b}function c(a,b,c){for(var d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?b.setUint8(c++,127&e|0):2048>e?(b.setUint8(c++,e>>6&31|192),b.setUint8(c++,e>>0&63|128)):(b.setUint8(c++,e>>12&15|224),b.setUint8(c++,e>>6&63|128),b.setUint8(c++,e>>0&63|128))}return c}function d(a,b,c){for(var d,e,f,g="",h=b+c;h>b;)if(d=a.getUint8(b++),128>d)g+=String.fromCharCode(d);else if(224>d){if(b+1>h)throw new Error("Truncated UTF-8 stream");e=a.getUint8(b++),g+=String.fromCharCode((31&d)<<6|(63&e)<<0)}else{if(b+2>h)throw new Error("Truncated UTF-8 stream");e=a.getUint8(b++),f=a.getUint8(b++),g+=String.fromCharCode((15&d)<<12|(63&e)<<6|(63&f)<<0)}return g}a.size=b,a.encode=c,a.decode=d}(b=a.UTF8||(a.UTF8={}))}(V||(V={}));var V;!function(a){var b;!function(b){var c=function(){function b(){this.d=[]}return b.prototype.putString=function(b){return this.d.push({value:b,tag:"string",size:a.UTF8.size(b)}),this},b.prototype.putInt8=function(a){return this.d.push({value:a,tag:"int8"}),this},b.prototype.putUint8=function(a){return this.d.push({value:a,tag:"uint8"}),this},b.prototype.putInt16=function(a){return this.d.push({value:a,tag:"int16"}),this},b.prototype.putUint16=function(a){return this.d.push({value:a,tag:"uint16"}),this},b.prototype.putInt32=function(a){return this.d.push({value:a,tag:"int32"}),this},b.prototype.putUint32=function(a){return this.d.push({value:a,tag:"uint32"}),this},b.prototype.putFloat32=function(a){return this.d.push({value:a,tag:"float32"}),this},b.prototype.putFloat64=function(a){return this.d.push({value:a,tag:"float64"}),this},b.prototype.size=function(){for(var a=0,b=0;b<this.d.length;b++){var c=this.d[b];switch(c.tag){case"string":a+=2+c.size;break;case"int8":a+=1;break;case"uint8":a+=1;break;case"int16":a+=2;break;case"uint16":a+=2;break;case"int32":a+=4;break;case"uint32":a+=4;break;case"float32":a+=4;break;case"float64":a+=8;break;default:throw new Error}}return a},b.prototype.get=function(){for(var b=new ArrayBuffer(this.size()),c=new DataView(b),d=0,e=0;e<this.d.length;e++){var f=this.d[e];switch(f.tag){case"string":c.setUint16(d,f.size),d+=2,d=a.UTF8.encode(f.value,c,d);break;case"int8":c.setInt8(d,f.value),d+=1;break;case"uint8":c.setUint8(d,f.value),d+=1;break;case"int16":c.setInt16(d,f.value),d+=2;break;case"uint16":c.setUint16(d,f.value),d+=2;break;case"int32":c.setInt32(d,f.value),d+=4;break;case"uint32":c.setInt32(d,f.value),d+=4;break;case"float32":c.setFloat32(d,f.value),d+=4;break;case"float64":c.setFloat64(d,f.value),d+=8;break;default:throw new Error}}return b},b}();b.Writer=c;var d=function(){function b(a){this.p=0,this.data=new DataView(a)}return b.prototype.getString=function(){var b=this.data.getUint16(this.p);this.p+=2;var c=a.UTF8.decode(this.data,this.p,b);return this.p+=b,c},b.prototype.getInt8=function(){var a=this.data.getInt8(this.p);return this.p+=1,a},b.prototype.getUint8=function(){var a=this.data.getUint8(this.p);return this.p+=1,a},b.prototype.getInt16=function(){var a=this.data.getInt16(this.p);return this.p+=2,a},b.prototype.getUint16=function(){var a=this.data.getUint16(this.p);return this.p+=2,a},b.prototype.getInt32=function(){var a=this.data.getInt32(this.p);return this.p+=4,a},b.prototype.getUint32=function(){var a=this.data.getUint32(this.p);return this.p+=4,a},b.prototype.getFloat32=function(){var a=this.data.getFloat32(this.p);return this.p+=4,a},b.prototype.getFloat64=function(){var a=this.data.getFloat64(this.p);return this.p+=8,a},b}();b.Reader=d}(b=a.IO||(a.IO={}))}(V||(V={}));var W;!function(a){function b(a,b){var c=Math.sqrt(3*b),d=2*c,e=Math.random()*d-c,f=Math.random()*d-c,g=Math.random()*d-c,h=Math.random()*d-c,i=Math.random()*d-c;return a+(e+f+g+h+i)/5*2.23606797749979}function c(a,c,d){for(;;){var e=b(a,c);if(Math.abs(e-a)<d)return e}}a.normal=b,a.limitedNormal=c}(W||(W={}));var X;!function(a){function b(a){function b(a){return p+a*o}var c,d,e=a.length,f=.5*(e+1),g=0,h=0,i=0;for(c=0;e>c;c++)d=a[c],i+=d,0==c?(g=d,h=d):(g=Math.min(g,d),h=Math.max(h,d));var j=i/e,k=0;for(c=0;e>c;c++)d=a[c]-j,k+=d*d;var l=k/(e-1),m=0,n=0;for(c=0;e>c;c++)d=c-f,m+=d*(a[c]-j),n+=d*d;var o=m/n,p=j-o*f;return{get min(){return g},get max(){return h},get mean(){return j},get variance(){return l},get alpha(){return p},get beta(){return o},fn:b}}function c(){function a(a){d++;var b=a-e;e+=b/d,c+=b*(a-e),d>1?(f=c/(d-1),g=Math.min(g,a),h=Math.max(h,a)):(g=a,h=a)}function b(b){for(var c=0;c<b.length;c++)a(b[c])}var c=0,d=0,e=0,f=null,g=null,h=null;return{get n(){return d},get mean(){return e},get variance(){return f},get min(){return g},get max(){return h},add:a,addAll:b}}function d(a){function b(a){g++;var b=a/f;if(d.push(b),e+=b,d.length<f){var c=a-h;h+=c/g}else h=e,e-=d.shift();g>f?(i=Math.min(i,h),j=Math.max(j,h)):(i=h,j=h)}function c(a){for(var c=0;c<a.length;c++)b(a[c])}var d=[],e=0,f=0|a,g=0,h=0,i=null,j=null;return{get size(){return f},get n(){return g},get mean(){return h},get min(){return i},get max(){return j},get available(){return g>=f},add:b,addAll:c}}function e(a){function b(a){if(g++,e.length==d){var b=e.shift();f.remove(f.indexOf(b))}e.push(a),f.insert(f.search(a),a),i=e.median(),g>d?(j=Math.min(j,i),k=Math.max(k,i)):(j=i,k=i)}function c(a){for(var c=0;c<a.length;c++)b(a[c])}var d=0|a,e=new h(d),f=new h(d),g=0,i=0,j=null,k=null;return{get size(){return d},get n(){return g},get median(){return i},get min(){return j},get max(){return k},get available(){return g>=d},add:b,addAll:c}}function f(a,b){for(var c=[],e=d(a),f=0;f<b.length;f++)e.add(b[f]),e.available&&c.push(e.mean);return c}function g(a,b){for(var c=[],d=e(a),f=0;f<b.length;f++)d.add(b[f]),d.available&&c.push(d.median);return c}a.linearRegression=b,a.mean=c,a.movingMean=d,a.movingMedian=e,a.movingMeanSmooth=f,a.movingMedianSmooth=g;var h=function(){function a(a){this._a=new Array(a),this._l=0}return Object.defineProperty(a.prototype,"length",{get:function(){return this._l},enumerable:!0,configurable:!0}),a.prototype.shift=function(){if(0==this._l)throw new Error;var a=this._a[0];this._l--;for(var b=0;b<this._l;b++)this._a[b]=this._a[b+1];return a},a.prototype.push=function(a){if(this._l==this._a.length)throw new Error;this._a[this._l]=a,this._l++},a.prototype.indexOf=function(a){for(var b=0;b<this._l;b++)if(this._a[b]===a)return b;return-1},a.prototype.remove=function(a){if(0==this._l)throw new Error;this._l--;for(var b=a;b<this._l;b++)this._a[b]=this._a[b+1]},a.prototype.insert=function(a,b){if(this._l==this._a.length)throw new Error;for(var c=this._l;c>a;c--)this._a[c]=this._a[c-1];this._a[a]=b,this._l++},a.prototype.search=function(a){for(var b=0,c=this._l-1,d=0;c>=b;){d=b+c>>1;var e=this._a[d];if(a>e)b=d+1;else{if(!(e>a))return d+1;c=d-1}}return b},a.prototype.median=function(){if(0==this._l)throw new Error;var a=this._l>>1;return 0!=(1&this._l)?this._a[a]:(this._a[a-1]+this._a[a])/2},a}()}(X||(X={}));var Y;!function(a){function b(){return new q}function c(a){return b().resolve(a).promise()}function d(a){return b().reject(a).promise()}function e(a,c){var d=b(),e=new Array;return f(e,d,a,c),d.promise()}function f(a,b,c,d){var e=c(d);if(!e)return void b.resolve(a);for(;e.next&&2==e.promise.status;)if(a.push(e.promise.result),e=c(e.next),!e)return void b.resolve(a);
e.promise.done(function(d){a.push(d),e.next?f(a,b,c,e.next):b.resolve(a)}).fail(function(a){b.reject(a)})}function g(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];var d=b();if(!a.length)return d.resolve([]).promise();var e=0,f=[];return a.forEach(function(b,c){b.done(function(b){f[c]=b,++e,e===a.length&&1!==d.status&&d.resolve(f)}).fail(function(){1!==d.status&&d.reject(new Error("when: one or more promises were rejected"))})}),d.promise()}function h(b,c){var d=a.defer();return b.done(function(a){d.resolve(a)}),b.fail(function(a){d.reject(i(c,a))}),d.promise()}function i(a,b){return{message:a,cause:b}}function j(a){return"string"==typeof a.message?a:{message:"Unknown"}}function k(a){return function(){return l(a())}}function l(a){return new r(a)}function m(a,c){var d=b();return n(d,a(),c),d.promise()}function n(a,b,c){b.advance().done(function(d){return d?(c(b.current),void n(a,b,c)):void a.resolve({})}).fail(function(b){return a.reject(b)})}function o(a){return"undefined"==typeof a}a.defer=b,a.resolve=c,a.reject=d,a.unfold=e,function(a){a[a.Unfulfilled=0]="Unfulfilled",a[a.Rejected=1]="Rejected",a[a.Resolved=2]="Resolved"}(a.Status||(a.Status={}));a.Status;a.when=g,a.explain=h,a.because=i,a.cause=j;var p=function(){function a(a){this.deferred=a}return Object.defineProperty(a.prototype,"status",{get:function(){return this.deferred.status},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"result",{get:function(){return this.deferred.result},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"error",{get:function(){return this.deferred.error},enumerable:!0,configurable:!0}),a.prototype.done=function(a){return this.deferred.done(a),this},a.prototype.fail=function(a){return this.deferred.fail(a),this},a.prototype.always=function(a){return this.deferred.always(a),this},a.prototype.then=function(a){return this.deferred.then(a)},a}(),q=function(){function a(){this._resolved=function(){},this._rejected=function(){},this._status=0,this._error={message:""},this._promise=new p(this)}return a.prototype.promise=function(){return this._promise},Object.defineProperty(a.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"result",{get:function(){if(2!=this._status)throw new Error("Promise: result not available");return this._result},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"error",{get:function(){if(1!=this._status)throw new Error("Promise: rejection reason not available");return this._error},enumerable:!0,configurable:!0}),a.prototype.then=function(a){var c=b();return this.done(function(b){var d=a(b);if(d instanceof p){var e=d;return e.done(function(a){return c.resolve(a)}).fail(function(a){return c.reject(a)}),e}c.resolve(d)}).fail(function(a){return c.reject(a)}),c.promise()},a.prototype.done=function(a){if(2===this.status)return a(this._result),this;if(0!==this.status)return this;var b=this._resolved;return this._resolved=function(c){b(c),a(c)},this},a.prototype.fail=function(a){if(1===this.status)return a(this._error),this;if(0!==this.status)return this;var b=this._rejected;return this._rejected=function(c){b(c),a(c)},this},a.prototype.always=function(a){return this.done(function(b){return a(b)}).fail(function(b){return a(null,b)}),this},a.prototype.resolve=function(a){if(0!==this._status)throw new Error("tried to resolve a fulfilled promise");return this._result=a,this._status=2,this._resolved(a),this.detach(),this},a.prototype.reject=function(a){if(0!==this._status)throw new Error("tried to reject a fulfilled promise");return this._error=a,this._status=1,this._rejected(a),this.detach(),this},a.prototype.detach=function(){this._resolved=function(){},this._rejected=function(){}},a}();a.generator=k,a.iterator=l;var r=function(){function a(a){this.f=a,this.current=void 0}return a.prototype.advance=function(){var a=this,b=this.f();return b.then(function(b){return o(b)?!1:(a.current=b,!0)})},a}();a.each=m,a.isUndefined=o}(Y||(Y={}));var Z;!function(a){function b(a,b){var c=Y.defer(),d=l();return b.callback=d,window[d]=function(a){delete window[d],c.resolve(a)},P.loadScript(h(a,b)).done(function(a){a.parentNode.removeChild(a)}).fail(function(a){c.reject(a)}),c.promise()}function c(a,b,c){return i("GET",a,b,c)}function d(a,b,c){return i("HEAD",a,b,c)}function e(a,b,c){return i("PUT",a,b,c)}function f(a,b,c){return i("POST",a,b,c)}function g(a,b,c){return i("DELETE",a,b,c)}function h(a,b){null==b&&(b=Object.create(null));var c=a.indexOf("?");if(-1!=c){var d=a.substring(c+1);a=a.substring(0,c),d.split("&").forEach(function(a){if(a.length){var c,d,e=a.indexOf("=");-1!=e?(c=decodeURIComponent(a.substring(0,e)),d=decodeURIComponent(a.substring(e+1))):(c=decodeURIComponent(a),d=null),Object.prototype.hasOwnProperty.call(b,c)||(b[c]=d)}})}var e=[];for(var f in b)if(Object.prototype.hasOwnProperty.call(b,f)){var g=b[f];e.push(null!=g?encodeURIComponent(f)+"="+encodeURIComponent(String(g)):encodeURIComponent(f))}return e.length&&(a=a+"?"+e.join("&")),a}function i(a,b,c,d){var e=new XMLHttpRequest;if(e.open(a,h(b,c),!0),e.responseType="blob",d)for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&e.setRequestHeader(f,d[f]);var g=Y.defer();e.addEventListener("load",function(){200==e.status||201==e.status||204==e.status?j(e,g):g.reject({message:e.statusText,status:e.status})}),e.addEventListener("error",function(a){var b=k(e);g.reject({message:a.message||"Unreachable",status:b.status,headers:b.headers})}),e.addEventListener("timeout",function(){g.reject({message:"timeout"})}),e.addEventListener("abort",function(){g.reject({message:"abort"})});var i={header:function(a,b){return e.setRequestHeader(a,b),i},accept:function(a){return e.setRequestHeader("Accept",a.map(function(a){switch(a){case"text":return"text/plain";case"json":return"application/json";case"binary":return"application/octet-stream";case"any":return"*/*"}return a}).join(",")),i},send:function(){return e.send(),g.promise()},sendForm:function(a){if(!(a instanceof FormData)){var b=a;a=new FormData;for(var c in b)a.append(c,String(b[c]))}return e.send(a),g.promise()},sendText:function(a,b){return void 0===b&&(b="text/plain"),e.setRequestHeader("Content-Type",b),e.send(a),g.promise()},sendJson:function(a,b){return void 0===b&&(b="application/json"),e.setRequestHeader("Content-Type",b),e.send(JSON.stringify(a)),g.promise()},sendBinary:function(a,b){return void 0===b&&(b="application/octet-stream"),e.setRequestHeader("Content-Type",b),e.send(a),g.promise()}};return i}function j(a,b){var c=k(a),d={status:c.status,headers:c.headers,contentType:c.contentType,body:null,isText:!1,text:null,isJson:!1,json:null,isBinary:!1,binary:null};if(a.response instanceof Blob){d.body=a.response;var e=new FileReader;switch(e.addEventListener("error",function(a){b.reject({message:a.message,status:c.status,headers:c.headers})}),c.contentType){case"text/plain":e.addEventListener("load",function(){d.isText=!0,d.text=e.result,b.resolve(d)}),e.readAsText(a.response);break;case"application/json":e.addEventListener("load",function(){try{var a=JSON.parse(e.result)}catch(f){var g=f}a?(d.isJson=!0,d.json=a,b.resolve(d)):b.reject({message:"JSON parse error",error:g,status:c.status,headers:c.headers})}),e.readAsText(a.response);break;case"application/octet-stream":e.addEventListener("load",function(){d.isBinary=!0,d.binary=e.result,b.resolve(d)}),e.readAsArrayBuffer(a.response);break;default:b.resolve(d)}}else b.resolve(d)}function k(a){var b=Object.create(null);a.getAllResponseHeaders().split("\n").forEach(function(a){var c=a.indexOf(":");if(-1!=c){var d=a.substring(0,c).toLowerCase(),e=a.substring(c+1).trim();b[d]=e}});var c,d;if("content-type"in b){var e,f=b["content-type"];(e=f.match(/^(.*); *charset=(.*)$/i))?(c=e[1],d=e[2]):(c=f,d=null)}else c="application/octet-stream",d=null;return{status:a.status,headers:b,contentType:c,charSet:d}}function l(){return"__callback_"+String(Date.now())+"_"+String(m++)}a.JSONP=b,a.GET=c,a.HEAD=d,a.PUT=e,a.POST=f,a.DELETE=g,a.parseUri=h;var m=1}(Z||(Z={}));var _,ab="theme-changed",bb="show-page",cb="page-ready",db="hide-page",eb="settings-changed",fb="lesson-started",gb="lesson-progress",hb="lesson-completed";!function(a){function b(a,b,c){for(var d="",e="",f=0;f<a.length;f++){var g=a.charCodeAt(f);if(T.isNl(g))e=""==d?"":"\n";else if(T.isWs(g))""==d?e="":"\n"!=e&&(e=" ");else{d+=e,e="";var h=String.fromCharCode(g);switch(g){case 8210:case 8211:case 8212:case 8213:g=45,h="-";break;case 8216:case 8217:case 8218:g=39,h="'";break;case 8220:case 8221:case 8222:case 171:case 187:g=34,h='"';break;case 8230:g=0,h="..."}if(null!=c&&-1!=c.indexOf(g))continue;(null==b||-1!=b.indexOf(g))&&(d+=h)}}return d}function c(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);if(-1!=b.indexOf(d))throw new Error("duplicate char code "+d);b.push(d)}return b}a.sanitize=b,a.toCharCodeArray=c,a.NUMBER=c("0123456789"),a.GRAPHICS=c("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~");var d=function(){function a(a){this.text=a,this.reset()}return a.prototype.reset=function(){this.offset=0,this.next=null},a.prototype.nextWord=function(b){for(void 0===b&&(b=15);;){var c=this.next,d=this.nextWordImpl(b);if(null==d){if(null==c)return"empty";this.reset(),c!=a.SPLIT&&(this.next=a.SPLIT)}else{if(null==c&&d==a.SPLIT)continue;if(null==c&&"\n"==d)continue;if(c==a.SPLIT&&d==a.SPLIT){this.next=a.SPLIT;continue}if(c==a.SPLIT&&"\n"==d){this.next=a.SPLIT;continue}if("\n"==c&&d==a.SPLIT){this.next=a.SPLIT;continue}if("\n"==c&&"\n"==d){this.next="\n";continue}this.next=d}if(null!=c)return c}},a.prototype.nextWordImpl=function(b){if(this.skipWs())return"\n";if(this.offset==this.text.length)return null;for(var c=this.offset;this.offset<this.text.length&&this.offset-c<b;){var d=this.text.charCodeAt(this.offset);if(T.isWs(d))break;this.offset++}var e=this.text.substring(c,this.offset);return e==a.SPLIT&&this.skipWs(),e},a.prototype.skipWs=function(){for(var a=!1;this.offset<this.text.length;){var b=this.text.charCodeAt(this.offset);if(!T.isWs(b))break;T.isNl(b)&&(a=!0),this.offset++}return a},a.SPLIT=">>>",a}();a.Parser=d}(_||(_={}));var ib,jb=(function(){function a(a){this.text=a}return a.prototype.generate=function(){return this.text},a}(),function(){function a(a,b){this.wordLimit=20,this.fragmentLimit=80,b=a.text.mangle.simplify?_.sanitize(b,a.layout.characters,_.GRAPHICS):_.sanitize(b,a.layout.characters),a.text.mangle.lowercase&&(b=b.toLowerCase()),this.text=b,this.parser=new _.Parser(this.text),this.nextWord()}return a.prototype.generate=function(){for(var a="",b=0,c=" ";this.word!=_.Parser.SPLIT&&5>b;){if(""==a)"\n"!=this.word&&(a=this.word);else if("\n"==this.word)c="\n",b++;else{if(a.length+this.word.length+1>this.fragmentLimit)break;a=a+c+this.word,c=" "}this.nextWord()}for(;this.word==_.Parser.SPLIT;)this.nextWord();return a},a.prototype.nextWord=function(){return this.word=this.parser.nextWord(this.wordLimit)},a}()),kb=function(){function a(a,b){this.letters=[],this.wordLimit=8,this.fragmentLimit=80,this.enableCapitals=!1,this.enablePunctuators=!1,this.punctuators=["."],this.letters=a,this.generator=b}return a.prototype.getBoostFactor=function(a){for(var b=0,c=null,d=0;d<this.letters.length;d++){var e=this.letters[d];e.charCode==a&&(c=e.f),b=Math.max(b,e.f)}if(null==c)throw new Error;return b/c},a.prototype.generate=function(){this.generator.reset();for(var a="",b="";;){var c=b=this.nextWord(b);if(this.enableCapitals&&(c=c.substring(0,1).toUpperCase()+c.substring(1)),this.enablePunctuators){var d=this.punctuators[Math.floor(Math.random()*this.punctuators.length)];switch(d){case null:break;case"-":c=c+"-"+this.nextWord(b);break;case"(":c="("+c+")";break;case"[":c="["+c+"]";break;case'"':c='"'+c+'"';break;case"'":c=c+"'"+this.nextWord(b);break;default:c+=d}}if(0==a.length){if(a=c,a.length>this.fragmentLimit)break}else{if(a.length+1+c.length>this.fragmentLimit)break;a+=" "+c}}return a},a.prototype.nextWord=function(a){try{for(;;){var b=this.generator.next(this.filter,this.boost,this.wordLimit);if(b!=a)return b}}catch(c){return"x"}},a.create=function(b){function c(){for(var a=new Uint8Array(b,0),c=9,d=a[c++],e=0;d>e;e++)m+=String.fromCharCode(256*a[c++]+a[c++]);l=a[c++]-1;var f=c,g=f+2*Math.pow(m.length,l);n=new Uint8Array(b,f,g-f),o=new Uint8Array(b,g)}function d(a,b){for(var c=m.length,d=0,e=1,f=0;l>f;f++)d+=e*b[l-f-1],e*=c;d*=2,d=n[d]<<8|n[d+1];var g=[],h=0;if(65535!=d){var i=o[d]>>4&15,j=15&o[d];for(d++;;){for(;i>0;){var k=m.charCodeAt(h),p=o[d];(32==k||null==a||-1!=a.indexOf(k))&&g.push(new lb(h,k,p)),d++,h++,i--}if(h+=j,h==c)break;i=o[d]>>>4&15,j=15&o[d],d++}}return g}function e(a,b){for(var c=0;c<b.length;c++){var d=m.charCodeAt(b[c]);if(d>32&&-1==a.indexOf(d))return!1}return!0}function f(a,b){var c=p[b];if(null==c)throw new Error;if(a){for(var d=[],f=0;f<c.length;f++){var g=c[f];e(a,g)&&d.push(g)}if(d.length>0)return d}return c}function g(){for(var a=Object.create(null),b=0;b<m.length;b++){var c=m.charCodeAt(b);a[c]=0,p[c]=[]}return a}function h(a,b,c,e){for(var f=0;f<m.length;f++)if(a[b]=f,l-1>b)h(a,b+1,c,e||0==b&&0==f);else for(var g=d(null,a),i=0;i<g.length;i++){var j=g[i],k=c[j.charCode];if(k+=j.weight,c[j.charCode]=k,e){var n=p[j.charCode],o=a.slice(0);o.push(j.index),o.shift(),n.push(o)}}}function i(a){for(var b=0,c=0;c<m.length;c++){var d=m.charCodeAt(c);d>32&&(b+=a[d])}for(var e=[],c=0;c<m.length;c++){var d=m.charCodeAt(c);d>32&&e.push(new Wb(d,a[d]/b))}return e}function j(a){for(var b=0;l>b;b++)a[b]=0}function k(a,b,c){function e(){if(j(s),g="",h){if(!h.length)throw new Error;s=h[Math.floor(Math.random()*h.length)].slice(0);for(var a=0;l>a;a++){var b=m.charCodeAt(s[a]);b>32&&(g+=String.fromCharCode(b))}}}var g,h;for(b&&(h=f(a,b.charCode)),e();;){var i=d(a,s);if(0==i.length)e();else{var k=lb.pickRandom(i);if(s.push(k.index),s.shift(),32==k.charCode){if(!(g.length<3))return g;e()}else g.length==c?e():g+=String.fromCharCode(k.charCode)}}}var l=0,m="",n=null,o=null,p=Object.create(null);c();var q=g();h(new Array(l),0,q,!1);var r=i(q),s=new Array(l);return new a(r,{reset:function(){j(s)},next:function(a,b,c){return k(a,b,c)}})},a.load=function(b){return a.CACHE.get(b).then(function(b){return a.create(b)})},a.loadImpl=function(a){var b=Y.defer();return Z.GET("/data/lang-"+String(a)+".data").send().done(function(a){a.isBinary?b.resolve(a.binary):b.reject({message:"Invalid data"})}).fail(function(a){b.reject(a)}),Y.explain(b.promise(),"Cannot load language phonetic data")},a.CACHE=new K(function(b){return a.loadImpl(b)}),a}(),lb=function(){function a(a,b,c){this.index=a,this.charCode=b,this.weight=c}return a.boost=function(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];if(e.charCode==b)return e.weight=Math.round(e.weight*c),!0}return!1},a.weight=function(a){for(var b=0,c=0;c<a.length;c++){var d=a[c];b+=d.weight}return b},a.pickRandom=function(b){for(var c=a.weight(b),d=Math.floor(Math.random()*(c+1)),e=0;e<b.length;e++){var f=b[e];if(d<=f.weight)return f;d-=f.weight}throw new Error},a}(),mb=function(){function a(a,b,c){return this.id=a,this.xid=b,this.name=c,Object.freeze(this)}return a.prototype.valueOf=function(){return this.id},a.prototype.toString=function(){return this.id},a}(),nb={EN:new mb("en",wb,"English"),DE:new mb("de",xb,"German"),FR:new mb("fr",yb,"French"),IT:new mb("it",zb,"Italian"),ES:new mb("es",Ab,"Spanish"),PT:new mb("pt",Bb,"Portuguese"),RU:new mb("ru",Cb,"Russian")},ob=function(){function a(a,b,c,d,e,f){return this.id=a,this.keyCode=b,this.a=0|c,this.b=0|d,this.c=0|e,this.d=0|f,Object.freeze(this)}return a.prototype.charCode=function(a,b){return b?a?this.d||this.c:this.c:a?this.b||this.a:this.a},a}(),pb=function(){function a(a,b,c,d,e,f,g){return this.charCode=a,this.key=b,this.shift=c,this.alt=d,this.deadKey=e,this.deadShift=f,this.deadAlt=g,Object.freeze(this)}return a.prototype.applyDeadKey=function(b,c,d,e){return new a(b,this.key,this.shift,this.alt,c,d,e)},a}(),qb=function(){function a(a,b,c,d,e,f,g){return this.id=a,this.xid=b,this.name=c,this.lang=d,this.config={emulate:!1},this.byKeyCodeMap={},this.byIdMap={},this.comboMap={},this.characters=[],this.id=a,this.xid=b,this.name=c,this.lang=d,this.keyMap=e,this.geometryMap=f,this.variantOf=g,this.init(),Object.freeze(this)}return a.prototype.init=function(){function a(a){var b=f.comboMap[a.charCode];if(b){if(b.deadKey&&a.deadKey)throw new Error;b.deadKey&&!a.deadKey&&(f.comboMap[a.charCode]=a)}else f.comboMap[a.charCode]=a;f.characters.push(a.charCode)}function b(b,c,d,e){b>0&&!T.isCombining(b)&&(g.push(b),a(new pb(b,c,d,e)))}function c(b,c,d,e){if(b>0&&T.isCombining(b))for(var h=0;h<g.length;h++){var i=g[h],j=T.combine(i,b);if(j!=i){var k=f.comboMap[i];a(k.applyDeadKey(j,c,d,e))}}}for(var d in this.keyMap){var e=this.keyMap[d];this.byKeyCodeMap[e.keyCode]=this.byIdMap[d]=new ob(d,e.keyCode,e.a,e.b,e.c,e.d)}var f=this,g=[];for(var d in this.byIdMap){var h=this.byIdMap[d];b(h.a,h,!1,!1),b(h.b,h,!0,!1),b(h.c,h,!1,!0),b(h.d,h,!0,!0)}for(var d in this.byIdMap){var h=this.byIdMap[d];c(h.a,h,!1,!1),c(h.b,h,!0,!1),c(h.c,h,!1,!0),c(h.d,h,!0,!0)}this.characters.sort()},a.prototype.configure=function(a){this.config.emulate=a.emulateLayout},a.prototype.createEventHandler=function(a){return new rb(this,a)},a.prototype.keyCombo=function(a){return this.comboMap[a]},a.prototype.getKeyId=function(a){if(a.location==S.NUMPAD)switch(a.keyCode){case 8:return"numpad-backspace";case 13:return ib[ib.KPEN];case 45:return ib[ib.KP0];case 46:return ib[ib.KPDL];case 35:return ib[ib.KP1];case 40:return ib[ib.KP2];case 34:return ib[ib.KP3];case 37:return ib[ib.KP4];case 12:return ib[ib.KP5];case 39:return ib[ib.KP6];case 36:return ib[ib.KP7];case 38:return ib[ib.KP8];case 33:return ib[ib.KP9]}switch(a.keyCode){case 16:return ib[a.location==S.RIGHT?ib.RTSH:ib.LFSH];case 17:return ib[a.location==S.RIGHT?ib.RCTL:ib.LCTL];case 18:return ib[a.location==S.RIGHT?ib.RALT:ib.LALT];case 8:return ib[ib.BKSP];case 9:return ib[ib.TAB];case 13:return ib[ib.RTRN];case 20:return ib[ib.CAPS];case 32:return ib[ib.SPCE]}if(this.config.emulate)return ib[a.keyCode];var b=this.byKeyCodeMap[a.keyCode];return b?b.id:ib[a.keyCode]},a}(),rb=function(){function a(a,b){this.layout=a,this.sink=b,this.last=0}return a.prototype.keyDown=function(a){if(!a.ctrlKey&&!a.metaKey){var b=0;switch(a.keyCode){case 8:b=8;break;case 9:b=9;break;case 13:b=10;break;case 32:b=32;break;case 106:b=42;break;case 107:b=43;break;case 109:b=45;break;case 110:b=46;break;case 111:b=47;break;case 96:b=48;break;case 97:b=49;break;case 98:b=50;break;case 99:b=51;break;case 100:b=52;break;case 101:b=53;break;case 102:b=54;break;case 103:b=55;break;case 104:b=56;break;case 105:b=57}if(b)this.sink(this.last=b);else{var c=this.key(a);if(c&&(b=c.charCode(a.shiftKey,a.altKey)))return T.isCombining(b)?this.last=b:this.sink(T.isCombining(this.last)?this.last=T.combine(b,this.last):this.last=b),!0}}return!1},a.prototype.keyUp=function(){},a.prototype.key=function(a){return this.layout.config.emulate?this.layout.byIdMap[ib[a.keyCode]]:this.layout.byKeyCodeMap[a.keyCode]},a}(),sb=function(){function a(a){var b=a.querySelector(".layout");this.$layout=b.instance||new SVG.Container(b);var c=a.querySelector(".overlay");this.$overlay=c.instance||new SVG.Container(c)}return a.prototype.init=function(a,b){this.layout=a,this.$keyMap=Object.create(null),this.$layout.clear(),this.$overlay.clear(),this.$section(this.layout.geometryMap),b&&(this.$section(tb.CURSOR),this.$section(tb.NUMPAD)),this.reset()},a.prototype.$section=function(a){for(var b in a)this.$layout.add(this.$keyMap[b]=this.$key(this.layout.byIdMap[b],a[b]))},a.prototype.$key=function(b,c){var d=new SVG.Element(a.libraryElement(c.shape)),e=d.node.querySelector(".symbol"),f=d.node.querySelector(".symbol-a"),g=d.node.querySelector(".symbol-b"),h=d.node.querySelector(".symbol-c"),i=d.node.querySelector(".symbol-d");if(b){var j=b.a>0&&b.b>0&&a.upperCase(b.a)==a.upperCase(b.b);j?e.textContent=a.label(b.a).toUpperCase():(b.a&&(f.textContent=a.label(b.a)),b.b&&(g.textContent=a.label(b.b))),b.c&&(h.textContent=a.label(b.c)),b.d&&(i.textContent=a.label(b.d))}return c.zone&&d.addClass(c.zone),d.move(c.x,c.y),d},a.prototype.keyEventListener=function(){var a=this;return function(b,c){b?a.keyDown(c):a.keyUp(c)}},a.prototype.keyDown=function(a){var b=this.layout.getKeyId(a);b&&this.pressedKey(b,!0),this.pressedSpecialKeys(a)},a.prototype.keyUp=function(a){var b=this.layout.getKeyId(a);b&&this.pressedKey(b,!1),this.pressedSpecialKeys(a)},a.prototype.pressedSpecialKeys=function(a){a.ctrlKey||(this.pressedKey(ib[ib.LCTL],!1),this.pressedKey(ib[ib.RCTL],!1)),a.altKey||(this.pressedKey(ib[ib.LALT],!1),this.pressedKey(ib[ib.RALT],!1)),a.shiftKey||(this.pressedKey(ib[ib.LFSH],!1),this.pressedKey(ib[ib.RTSH],!1))},a.prototype.pressedKey=function(a,b){var c=this.$keyMap[a];c&&(b?c.addClass("down"):c.removeClass("down"))},a.prototype.highlight=function(a){if(this.$overlay.clear(),a){switch(a){case 8:return void this.highlightKey(ib[ib.TAB]);case 10:return void this.highlightKey(ib[ib.RTRN]);case 32:return void this.highlightKey(ib[ib.SPCE])}var b=this.layout.keyCombo(a);b&&(this.highlightKey(b.key.id),b.shift&&(this.highlightKey(ib[ib.LFSH]),this.highlightKey(ib[ib.RTSH])),b.alt&&this.highlightKey(ib[ib.RALT]),b.deadKey&&(this.highlightKey(b.deadKey.id),b.deadShift&&!b.shift&&(this.highlightKey(ib[ib.LFSH]),this.highlightKey(ib[ib.RTSH])),b.deadAlt&&!b.alt&&this.highlightKey(ib[ib.RALT])))}},a.prototype.highlightKey=function(b){var c=this.getKeyPoint(b),d=new SVG.Element(a.libraryElement("key-hl"));this.$overlay.add(d),d.center(c.cx,c.cy)},a.prototype.getKeyPoint=function(a){var b=this.layout.geometryMap[a],c=this.$keyMap[a],d=c.bbox(),e=b.x+d.width/2,f=b.y+d.height/2;return{cx:e,cy:f}},a.prototype.reset=function(){for(var a in this.$keyMap)this.pressedKey(a,!1)},a.prototype.createPauseAnimation=function(){var a=[];for(var b in this.$keyMap)a.push(this.$keyMap[b].node);return new fc(a)},a.libraryElement=function(a){var b=document.getElementById(a);return b=b.cloneNode(!0),b.setAttribute("id",SVG.eid("x")),b},a.upperCase=function(a){return String.fromCharCode(a).toUpperCase()},a.label=function(a){return T.isCombining(a)&&(a=T.combinerImage(a)),String.fromCharCode(a)},a}(),tb=function(){var a=Object.freeze({TLDE:{x:0,y:0,shape:"key",zone:"z1"},AE01:{x:42,y:0,shape:"key",zone:"z1"},AE02:{x:84,y:0,shape:"key",zone:"z2"},AE03:{x:126,y:0,shape:"key",zone:"z3"},AE04:{x:168,y:0,shape:"key",zone:"z4"},AE05:{x:210,y:0,shape:"key",zone:"z4"},AE06:{x:252,y:0,shape:"key",zone:"z5"},AE07:{x:294,y:0,shape:"key",zone:"z5"},AE08:{x:336,y:0,shape:"key",zone:"z6"},AE09:{x:378,y:0,shape:"key",zone:"z7"},AE10:{x:420,y:0,shape:"key",zone:"z8"},AE11:{x:462,y:0,shape:"key",zone:"z8"},AE12:{x:504,y:0,shape:"key",zone:"z8"},BKSP:{x:546,y:0,shape:"key-backspace",zone:""},TAB:{x:0,y:42,shape:"key-tab",zone:""},AD01:{x:65,y:42,shape:"key",zone:"z1"},AD02:{x:107,y:42,shape:"key",zone:"z2"},AD03:{x:149,y:42,shape:"key",zone:"z3"},AD04:{x:191,y:42,shape:"key",zone:"z4"},AD05:{x:233,y:42,shape:"key",zone:"z4"},AD06:{x:275,y:42,shape:"key",zone:"z5"},AD07:{x:317,y:42,shape:"key",zone:"z5"},AD08:{x:359,y:42,shape:"key",zone:"z6"},AD09:{x:401,y:42,shape:"key",zone:"z7"},AD10:{x:443,y:42,shape:"key",zone:"z8"},AD11:{x:485,y:42,shape:"key",zone:"z8"},AD12:{x:527,y:42,shape:"key",zone:"z8"},CAPS:{x:0,y:84,shape:"key-caps-lock",zone:""},AC01:{x:72,y:84,shape:"key",zone:"z1"},AC02:{x:114,y:84,shape:"key",zone:"z2"},AC03:{x:156,y:84,shape:"key",zone:"z3"},AC04:{x:198,y:84,shape:"key",zone:"z4"},AC05:{x:240,y:84,shape:"key",zone:"z4"},AC06:{x:282,y:84,shape:"key",zone:"z5"},AC07:{x:324,y:84,shape:"key",zone:"z5"},AC08:{x:366,y:84,shape:"key",zone:"z6"},AC09:{x:408,y:84,shape:"key",zone:"z7"},AC10:{x:450,y:84,shape:"key",zone:"z8"},AC11:{x:492,y:84,shape:"key",zone:"z8"},BKSL:{x:534,y:84,shape:"key",zone:"z8"},RTRN:{x:569,y:42,shape:"key-enter",zone:""},LFSH:{x:0,y:126,shape:"key-left-shift",zone:""},AB01:{x:94,y:126,shape:"key",zone:"z1"},AB02:{x:136,y:126,shape:"key",zone:"z2"},AB03:{x:178,y:126,shape:"key",zone:"z3"},AB04:{x:220,y:126,shape:"key",zone:"z4"},AB05:{x:262,y:126,shape:"key",zone:"z4"},AB06:{x:304,y:126,shape:"key",zone:"z5"},AB07:{x:346,y:126,shape:"key",zone:"z5"},AB08:{x:388,y:126,shape:"key",zone:"z6"},AB09:{x:430,y:126,shape:"key",zone:"z7"},AB10:{x:472,y:126,shape:"key",zone:"z8"},RTSH:{x:514,y:126,shape:"key-right-shift",zone:""},LCTL:{x:0,y:168,shape:"key-ctrl",zone:""},LALT:{x:65,y:168,shape:"key-alt",zone:""},SPCE:{x:130,y:168,shape:"key-space",zone:""},RALT:{x:501,y:168,shape:"key-alt",zone:""},RCTL:{x:566,y:168,shape:"key-ctrl",zone:""}}),b=Object.freeze({TLDE:{x:0,y:0,shape:"key",zone:"z1"},AE01:{x:42,y:0,shape:"key",zone:"z1"},AE02:{x:84,y:0,shape:"key",zone:"z2"},AE03:{x:126,y:0,shape:"key",zone:"z3"},AE04:{x:168,y:0,shape:"key",zone:"z4"},AE05:{x:210,y:0,shape:"key",zone:"z4"},AE06:{x:252,y:0,shape:"key",zone:"z5"},AE07:{x:294,y:0,shape:"key",zone:"z5"},AE08:{x:336,y:0,shape:"key",zone:"z6"},AE09:{x:378,y:0,shape:"key",zone:"z7"},AE10:{x:420,y:0,shape:"key",zone:"z8"},AE11:{x:462,y:0,shape:"key",zone:"z8"},AE12:{x:504,y:0,shape:"key",zone:"z8"},BKSP:{x:546,y:0,shape:"key-backspace",zone:""},TAB:{x:0,y:42,shape:"key-tab",zone:""},AD01:{x:65,y:42,shape:"key",zone:"z1"},AD02:{x:107,y:42,shape:"key",zone:"z2"},AD03:{x:149,y:42,shape:"key",zone:"z3"},AD04:{x:191,y:42,shape:"key",zone:"z4"},AD05:{x:233,y:42,shape:"key",zone:"z4"},AD06:{x:275,y:42,shape:"key",zone:"z5"},AD07:{x:317,y:42,shape:"key",zone:"z5"},AD08:{x:359,y:42,shape:"key",zone:"z6"},AD09:{x:401,y:42,shape:"key",zone:"z7"},AD10:{x:443,y:42,shape:"key",zone:"z8"},AD11:{x:485,y:42,shape:"key",zone:"z8"},AD12:{x:527,y:42,shape:"key",zone:"z8"},CAPS:{x:0,y:84,shape:"key-caps-lock",zone:""},AC01:{x:72,y:84,shape:"key",zone:"z1"},AC02:{x:114,y:84,shape:"key",zone:"z2"},AC03:{x:156,y:84,shape:"key",zone:"z3"},AC04:{x:198,y:84,shape:"key",zone:"z4"},AC05:{x:240,y:84,shape:"key",zone:"z4"},AC06:{x:282,y:84,shape:"key",zone:"z5"},AC07:{x:324,y:84,shape:"key",zone:"z5"},AC08:{x:366,y:84,shape:"key",zone:"z6"},AC09:{x:408,y:84,shape:"key",zone:"z7"},AC10:{x:450,y:84,shape:"key",zone:"z8"},AC11:{x:492,y:84,shape:"key",zone:"z8"},BKSL:{x:534,y:84,shape:"key",zone:"z8"},RTRN:{x:569,y:42,shape:"key-enter",zone:""},LFSH:{x:0,y:126,shape:"key-left-shift-small",zone:""},LSGT:{x:52,y:126,shape:"key",zone:"z1"},AB01:{x:94,y:126,shape:"key",zone:"z1"},AB02:{x:136,y:126,shape:"key",zone:"z2"},AB03:{x:178,y:126,shape:"key",zone:"z3"},AB04:{x:220,y:126,shape:"key",zone:"z4"},AB05:{x:262,y:126,shape:"key",zone:"z4"},AB06:{x:304,y:126,shape:"key",zone:"z5"},AB07:{x:346,y:126,shape:"key",zone:"z5"},AB08:{x:388,y:126,shape:"key",zone:"z6"},AB09:{x:430,y:126,shape:"key",zone:"z7"},AB10:{x:472,y:126,shape:"key",zone:"z8"},RTSH:{x:514,y:126,shape:"key-right-shift",zone:""},LCTL:{x:0,y:168,shape:"key-ctrl",zone:""},LALT:{x:65,y:168,shape:"key-alt",zone:""},SPCE:{x:130,y:168,shape:"key-space",zone:""},RALT:{x:501,y:168,shape:"key-alt-gr",zone:""},RCTL:{x:566,y:168,shape:"key-ctrl",zone:""}}),c=Object.freeze({TLDE:{x:0,y:0,shape:"key",zone:"z1"},AE01:{x:42,y:0,shape:"key",zone:"z1"},AE02:{x:84,y:0,shape:"key",zone:"z2"},AE03:{x:126,y:0,shape:"key",zone:"z3"},AE04:{x:168,y:0,shape:"key",zone:"z4"},AE05:{x:210,y:0,shape:"key",zone:"z4"},AE06:{x:252,y:0,shape:"key",zone:"z5"},AE07:{x:294,y:0,shape:"key",zone:"z5"},AE08:{x:336,y:0,shape:"key",zone:"z6"},AE09:{x:378,y:0,shape:"key",zone:"z7"},AE10:{x:420,y:0,shape:"key",zone:"z8"},AE11:{x:462,y:0,shape:"key",zone:"z8"},AE12:{x:504,y:0,shape:"key",zone:"z8"},BKSP:{x:546,y:0,shape:"key-backspace",zone:""},TAB:{x:0,y:42,shape:"key-tab",zone:""},AD01:{x:65,y:42,shape:"key",zone:"z1"},AD02:{x:107,y:42,shape:"key",zone:"z2"},AD03:{x:149,y:42,shape:"key",zone:"z3"},AD04:{x:191,y:42,shape:"key",zone:"z4"},AD05:{x:233,y:42,shape:"key",zone:"z4"},AD06:{x:275,y:42,shape:"key",zone:"z5"},AD07:{x:317,y:42,shape:"key",zone:"z5"},AD08:{x:359,y:42,shape:"key",zone:"z6"},AD09:{x:401,y:42,shape:"key",zone:"z7"},AD10:{x:443,y:42,shape:"key",zone:"z8"},AD11:{x:485,y:42,shape:"key",zone:"z8"},AD12:{x:527,y:42,shape:"key",zone:"z8"},BKSL:{x:569,y:42,shape:"key-wide",zone:"z8"},CAPS:{x:0,y:84,shape:"key-caps-lock",zone:""},AC01:{x:72,y:84,shape:"key",zone:"z1"},AC02:{x:114,y:84,shape:"key",zone:"z2"},AC03:{x:156,y:84,shape:"key",zone:"z3"},AC04:{x:198,y:84,shape:"key",zone:"z4"},AC05:{x:240,y:84,shape:"key",zone:"z4"},AC06:{x:282,y:84,shape:"key",zone:"z5"},AC07:{x:324,y:84,shape:"key",zone:"z5"},AC08:{x:366,y:84,shape:"key",zone:"z6"},AC09:{x:408,y:84,shape:"key",zone:"z7"},AC10:{x:450,y:84,shape:"key",zone:"z8"},AC11:{x:492,y:84,shape:"key",zone:"z8"},RTRN:{x:534,y:84,shape:"key-enter-small",zone:""},LFSH:{x:0,y:126,shape:"key-left-shift",zone:""},AB01:{x:94,y:126,shape:"key",zone:"z1"},AB02:{x:136,y:126,shape:"key",zone:"z2"},AB03:{x:178,y:126,shape:"key",zone:"z3"},AB04:{x:220,y:126,shape:"key",zone:"z4"},AB05:{x:262,y:126,shape:"key",zone:"z4"},AB06:{x:304,y:126,shape:"key",zone:"z5"},AB07:{x:346,y:126,shape:"key",zone:"z5"},AB08:{x:388,y:126,shape:"key",zone:"z6"},AB09:{x:430,y:126,shape:"key",zone:"z7"},AB10:{x:472,y:126,shape:"key",zone:"z8"},RTSH:{x:514,y:126,shape:"key-right-shift",zone:""},LCTL:{x:0,y:168,shape:"key-ctrl",zone:""},LALT:{x:65,y:168,shape:"key-alt",zone:""},SPCE:{x:130,y:168,shape:"key-space",zone:""},RALT:{x:501,y:168,shape:"key-alt",zone:""},RCTL:{x:566,y:168,shape:"key-ctrl",zone:""}}),d=Object.freeze({INS:{x:648,y:0,shape:"key-insert"},HOME:{x:690,y:0,shape:"key-home"},PGUP:{x:732,y:0,shape:"key-page-up"},DELE:{x:648,y:42,shape:"key-delete"},END:{x:690,y:42,shape:"key-end"},PGDN:{x:732,y:42,shape:"key-page-down"},UP:{x:690,y:126,shape:"key-up"},LEFT:{x:648,y:168,shape:"key-left"},DOWN:{x:690,y:168,shape:"key-down"},RGHT:{x:732,y:168,shape:"key-right"}}),e=Object.freeze({NMLK:{x:792,y:0,shape:"key-np-num-lock"},KPDV:{x:834,y:0,shape:"key-np-divide"},KPMU:{x:876,y:0,shape:"key-np-multiply"},KPSU:{x:918,y:0,shape:"key-np-subtract"},KP7:{x:792,y:42,shape:"key-np-7"},KP8:{x:834,y:42,shape:"key-np-8"},KP9:{x:876,y:42,shape:"key-np-9"},KPAD:{x:918,y:42,shape:"key-np-add"},KP4:{x:792,y:84,shape:"key-np-4"},KP5:{x:834,y:84,shape:"key-np-5"},KP6:{x:876,y:84,shape:"key-np-6"},KP1:{x:792,y:126,shape:"key-np-1"},KP2:{x:834,y:126,shape:"key-np-2"},KP3:{x:876,y:126,shape:"key-np-3"},KPEN:{x:918,y:126,shape:"key-np-enter"},KP0:{x:792,y:168,shape:"key-np-0"},KPDL:{x:876,y:168,shape:"key-np-decimal"}});return Object.freeze({TYPE_A:a,TYPE_B:b,TYPE_C:c,CURSOR:d,NUMPAD:e})}(),ub=function(){var a=Object.freeze({TLDE:{keyCode:192,a:96,b:126,c:null,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:64,c:null,d:null},AE03:{keyCode:51,a:51,b:35,c:null,d:null},AE04:{keyCode:52,a:52,b:36,c:null,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:94,c:null,d:null},AE07:{keyCode:55,a:55,b:38,c:null,d:null},AE08:{keyCode:56,a:56,b:42,c:null,d:null},AE09:{keyCode:57,a:57,b:40,c:null,d:null},AE10:{keyCode:48,a:48,b:41,c:null,d:null},AE11:{keyCode:189,a:45,b:95,c:null,d:null},AE12:{keyCode:187,a:61,b:43,c:null,d:null},AD01:{keyCode:81,a:113,b:81,c:null,d:null},AD02:{keyCode:87,a:119,b:87,c:null,d:null},AD03:{keyCode:69,a:101,b:69,c:null,d:null},AD04:{keyCode:82,a:114,b:82,c:null,d:null},AD05:{keyCode:84,a:116,b:84,c:null,d:null},AD06:{keyCode:89,a:121,b:89,c:null,d:null},AD07:{keyCode:85,a:117,b:85,c:null,d:null},AD08:{keyCode:73,a:105,b:73,c:null,d:null},AD09:{keyCode:79,a:111,b:79,c:null,d:null},AD10:{keyCode:80,a:112,b:80,c:null,d:null},AD11:{keyCode:219,a:91,b:123,c:null,d:null},AD12:{keyCode:221,a:93,b:125,c:null,d:null},BKSL:{keyCode:220,a:92,b:124,c:null,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:68,a:100,b:68,c:null,d:null},AC04:{keyCode:70,a:102,b:70,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:74,a:106,b:74,c:null,d:null},AC08:{keyCode:75,a:107,b:75,c:null,d:null},AC09:{keyCode:76,a:108,b:76,c:null,d:null},AC10:{keyCode:186,a:59,b:58,c:null,d:null},AC11:{keyCode:222,a:39,b:34,c:null,d:null},AB01:{keyCode:90,a:122,b:90,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:78,a:110,b:78,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:null,d:null},AB08:{keyCode:188,a:44,b:60,c:null,d:null},AB09:{keyCode:190,a:46,b:62,c:null,d:null},AB10:{keyCode:191,a:47,b:63,c:null,d:null}}),b=Object.freeze({TLDE:{keyCode:192,a:96,b:172,c:166,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:34,c:null,d:null},AE03:{keyCode:51,a:51,b:163,c:null,d:null},AE04:{keyCode:52,a:52,b:36,c:8364,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:94,c:null,d:null},AE07:{keyCode:55,a:55,b:38,c:null,d:null},AE08:{keyCode:56,a:56,b:42,c:null,d:null},AE09:{keyCode:57,a:57,b:40,c:null,d:null},AE10:{keyCode:48,a:48,b:41,c:null,d:null},AE11:{keyCode:189,a:45,b:95,c:null,d:null},AE12:{keyCode:187,a:61,b:43,c:null,d:null},AD01:{keyCode:81,a:113,b:81,c:null,d:null},AD02:{keyCode:87,a:119,b:87,c:null,d:null},AD03:{keyCode:69,a:101,b:69,c:201,d:null},AD04:{keyCode:82,a:114,b:82,c:null,d:null},AD05:{keyCode:84,a:116,b:84,c:null,d:null},AD06:{keyCode:89,a:121,b:89,c:null,d:null},AD07:{keyCode:85,a:117,b:85,c:218,d:null},AD08:{keyCode:73,a:105,b:73,c:205,d:null},AD09:{keyCode:79,a:111,b:79,c:211,d:null},AD10:{keyCode:80,a:112,b:80,c:null,d:null},AD11:{keyCode:219,a:91,b:123,c:null,d:null},AD12:{keyCode:221,a:93,b:125,c:null,d:null},BKSL:{keyCode:220,a:35,b:126,c:null,d:null},AC01:{keyCode:65,a:97,b:65,c:193,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:68,a:100,b:68,c:null,d:null},AC04:{keyCode:70,a:102,b:70,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:74,a:106,b:74,c:null,d:null},AC08:{keyCode:75,a:107,b:75,c:null,d:null},AC09:{keyCode:76,a:108,b:76,c:null,d:null},AC10:{keyCode:186,a:59,b:58,c:null,d:null},AC11:{keyCode:222,a:39,b:64,c:null,d:null},AB01:{keyCode:90,a:122,b:90,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:78,a:110,b:78,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:null,d:null},AB08:{keyCode:188,a:44,b:60,c:null,d:null},AB09:{keyCode:190,a:46,b:62,c:null,d:null},AB10:{keyCode:191,a:47,b:63,c:null,d:null},LSGT:{keyCode:226,a:92,b:124,c:null,d:null}}),c=Object.freeze({TLDE:{keyCode:192,a:96,b:126,c:null,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:64,c:null,d:null},AE03:{keyCode:51,a:51,b:163,c:null,d:null},AE04:{keyCode:52,a:52,b:36,c:null,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:94,c:null,d:null},AE07:{keyCode:55,a:55,b:38,c:null,d:null},AE08:{keyCode:56,a:56,b:42,c:null,d:null},AE09:{keyCode:57,a:57,b:40,c:null,d:null},AE10:{keyCode:48,a:48,b:41,c:null,d:null},AE11:{keyCode:189,a:45,b:95,c:null,d:null},AE12:{keyCode:187,a:61,b:43,c:null,d:null},AD01:{keyCode:81,a:113,b:81,c:null,d:null},AD02:{keyCode:87,a:119,b:87,c:null,d:null},AD03:{keyCode:69,a:101,b:69,c:201,d:null},AD04:{keyCode:82,a:114,b:82,c:null,d:null},AD05:{keyCode:84,a:116,b:84,c:null,d:null},AD06:{keyCode:89,a:121,b:89,c:null,d:null},AD07:{keyCode:85,a:117,b:85,c:null,d:null},AD08:{keyCode:73,a:105,b:73,c:null,d:null},AD09:{keyCode:79,a:111,b:79,c:null,d:null},AD10:{keyCode:80,a:112,b:80,c:null,d:null},AD11:{keyCode:219,a:91,b:123,c:null,d:null},AD12:{keyCode:221,a:93,b:125,c:null,d:null},BKSL:{keyCode:220,a:92,b:124,c:null,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:68,a:100,b:68,c:null,d:null},AC04:{keyCode:70,a:102,b:70,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:74,a:106,b:74,c:null,d:null},AC08:{keyCode:75,a:107,b:75,c:null,d:null},AC09:{keyCode:76,a:108,b:76,c:null,d:null},AC10:{keyCode:186,a:59,b:58,c:null,d:null},AC11:{keyCode:222,a:39,b:34,c:null,d:null},AB01:{keyCode:90,a:122,b:90,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:78,a:110,b:78,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:null,d:null},AB08:{keyCode:188,a:44,b:60,c:null,d:null},AB09:{keyCode:190,a:46,b:62,c:null,d:null},AB10:{keyCode:191,a:47,b:63,c:null,d:null}}),d=Object.freeze({TLDE:{keyCode:192,a:96,b:126,c:null,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:64,c:null,d:null},AE03:{keyCode:51,a:51,b:35,c:null,d:null},AE04:{keyCode:52,a:52,b:36,c:null,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:94,c:null,d:null},AE07:{keyCode:55,a:55,b:38,c:null,d:null},AE08:{keyCode:56,a:56,b:42,c:null,d:null},AE09:{keyCode:57,a:57,b:40,c:null,d:null},AE10:{keyCode:48,a:48,b:41,c:null,d:null},AE11:{keyCode:219,a:91,b:123,c:null,d:null},AE12:{keyCode:221,a:93,b:125,c:null,d:null},AD01:{keyCode:222,a:39,b:34,c:null,d:null},AD02:{keyCode:188,a:44,b:60,c:null,d:null},AD03:{keyCode:190,a:46,b:62,c:null,d:null},AD04:{keyCode:80,a:112,b:80,c:null,d:null},AD05:{keyCode:89,a:121,b:89,c:null,d:null},AD06:{keyCode:70,a:102,b:70,c:null,d:null},AD07:{keyCode:71,a:103,b:71,c:null,d:null},AD08:{keyCode:67,a:99,b:67,c:null,d:null},AD09:{keyCode:82,a:114,b:82,c:null,d:null},AD10:{keyCode:76,a:108,b:76,c:null,d:null},AD11:{keyCode:191,a:47,b:63,c:null,d:null},AD12:{keyCode:187,a:61,b:43,c:null,d:null},BKSL:{keyCode:220,a:92,b:124,c:null,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:79,a:111,b:79,c:null,d:null},AC03:{keyCode:69,a:101,b:69,c:null,d:null},AC04:{keyCode:85,a:117,b:85,c:null,d:null},AC05:{keyCode:73,a:105,b:73,c:null,d:null},AC06:{keyCode:68,a:100,b:68,c:null,d:null},AC07:{keyCode:72,a:104,b:72,c:null,d:null},AC08:{keyCode:84,a:116,b:84,c:null,d:null},AC09:{keyCode:78,a:110,b:78,c:null,d:null},AC10:{keyCode:83,a:115,b:83,c:null,d:null},AC11:{keyCode:189,a:45,b:95,c:null,d:null},AB01:{keyCode:186,a:59,b:58,c:null,d:null},AB02:{keyCode:81,a:113,b:81,c:null,d:null},AB03:{keyCode:74,a:106,b:74,c:null,d:null},AB04:{keyCode:75,a:107,b:75,c:null,d:null},AB05:{keyCode:88,a:120,b:88,c:null,d:null},AB06:{keyCode:66,a:98,b:66,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:null,d:null},AB08:{keyCode:87,a:119,b:87,c:null,d:null},AB09:{keyCode:86,a:118,b:86,c:null,d:null},AB10:{keyCode:90,a:122,b:90,c:null,d:null}}),e=Object.freeze({TLDE:{keyCode:192,a:96,b:126,c:null,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:64,c:null,d:null},AE03:{keyCode:51,a:51,b:35,c:null,d:null},AE04:{keyCode:52,a:52,b:36,c:null,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:94,c:null,d:null},AE07:{keyCode:55,a:55,b:38,c:null,d:null},AE08:{keyCode:56,a:56,b:42,c:null,d:null},AE09:{keyCode:57,a:57,b:40,c:null,d:null},AE10:{keyCode:48,a:48,b:41,c:null,d:null},AE11:{keyCode:189,a:45,b:95,c:null,d:null},AE12:{keyCode:187,a:61,b:43,c:null,d:null},AD01:{keyCode:81,a:113,b:81,c:null,d:null},AD02:{keyCode:87,a:119,b:87,c:null,d:null},AD03:{keyCode:70,a:102,b:70,c:null,d:null},AD04:{keyCode:80,a:112,b:80,c:null,d:null},AD05:{keyCode:71,a:103,b:71,c:null,d:null},AD06:{keyCode:74,a:106,b:74,c:null,d:null},AD07:{keyCode:76,a:108,b:76,c:null,d:null},AD08:{keyCode:85,a:117,b:85,c:null,d:null},AD09:{keyCode:89,a:121,b:89,c:null,d:null},AD10:{keyCode:186,a:59,b:58,c:null,d:null},AD11:{keyCode:219,a:91,b:123,c:null,d:null},AD12:{keyCode:221,a:93,b:125,c:null,d:null},BKSL:{keyCode:220,a:92,b:124,c:null,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:82,a:114,b:82,c:null,d:null},AC03:{keyCode:83,a:115,b:83,c:null,d:null},AC04:{keyCode:84,a:116,b:84,c:null,d:null},AC05:{keyCode:68,a:100,b:68,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:78,a:110,b:78,c:null,d:null},AC08:{keyCode:69,a:101,b:69,c:null,d:null},AC09:{keyCode:73,a:105,b:73,c:null,d:null},AC10:{keyCode:79,a:111,b:79,c:null,d:null},AC11:{keyCode:222,a:39,b:34,c:null,d:null},AB01:{keyCode:90,a:122,b:90,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:75,a:107,b:75,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:null,d:null},AB08:{keyCode:188,a:44,b:60,c:null,d:null},AB09:{keyCode:190,a:46,b:62,c:null,d:null},AB10:{keyCode:191,a:47,b:63,c:null,d:null}}),f=Object.freeze({TLDE:{keyCode:192,a:96,b:126,c:null,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:64,c:null,d:null},AE03:{keyCode:51,a:51,b:35,c:null,d:null},AE04:{keyCode:52,a:52,b:36,c:null,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:94,c:null,d:null},AE07:{keyCode:55,a:55,b:38,c:null,d:null},AE08:{keyCode:56,a:56,b:42,c:null,d:null},AE09:{keyCode:57,a:57,b:40,c:null,d:null},AE10:{keyCode:48,a:48,b:41,c:null,d:null},AE11:{keyCode:189,a:45,b:95,c:null,d:null},AE12:{keyCode:187,a:61,b:43,c:null,d:null},AD01:{keyCode:81,a:113,b:81,c:null,d:null},AD02:{keyCode:68,a:100,b:68,c:null,d:null},AD03:{keyCode:82,a:114,b:82,c:null,d:null},AD04:{keyCode:87,a:119,b:87,c:null,d:null},AD05:{keyCode:66,a:98,b:66,c:null,d:null},AD06:{keyCode:74,a:106,b:74,c:null,d:null},AD07:{keyCode:70,a:102,b:70,c:null,d:null},AD08:{keyCode:85,a:117,b:85,c:null,d:null},AD09:{keyCode:80,a:112,b:80,c:null,d:null},AD10:{keyCode:186,a:59,b:58,c:null,d:null},AD11:{keyCode:219,a:91,b:123,c:null,d:null},AD12:{keyCode:221,a:93,b:125,c:null,d:null},BKSL:{keyCode:220,a:92,b:124,c:null,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:72,a:104,b:72,c:null,d:null},AC04:{keyCode:84,a:116,b:84,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:89,a:121,b:89,c:null,d:null},AC07:{keyCode:78,a:110,b:78,c:null,d:null},AC08:{keyCode:69,a:101,b:69,c:null,d:null},AC09:{keyCode:79,a:111,b:79,c:null,d:null},AC10:{keyCode:73,a:105,b:73,c:null,d:null},AC11:{keyCode:222,a:39,b:34,c:null,d:null},AB01:{keyCode:90,a:122,b:90,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:77,a:109,b:77,c:null,d:null},AB04:{keyCode:67,a:99,b:67,c:null,d:null},AB05:{keyCode:86,a:118,b:86,c:null,d:null},AB06:{keyCode:75,a:107,b:75,c:null,d:null},AB07:{keyCode:76,a:108,b:76,c:null,d:null},AB08:{keyCode:188,a:44,b:60,c:null,d:null},AB09:{keyCode:190,a:46,b:62,c:null,d:null},AB10:{keyCode:191,a:47,b:63,c:null,d:null}}),g=Object.freeze({TLDE:{keyCode:220,a:770,b:176,c:null,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:34,c:178,d:null},AE03:{keyCode:51,a:51,b:167,c:179,d:null},AE04:{keyCode:52,a:52,b:36,c:null,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:38,c:null,d:null},AE07:{keyCode:55,a:55,b:47,c:123,d:null},AE08:{keyCode:56,a:56,b:40,c:91,d:null},AE09:{keyCode:57,a:57,b:41,c:93,d:null},AE10:{keyCode:48,a:48,b:61,c:125,d:null},AE11:{keyCode:219,a:223,b:63,c:92,d:null},AE12:{keyCode:221,a:769,b:768,c:null,d:null},AD01:{keyCode:81,a:113,b:81,c:64,d:null},AD02:{keyCode:87,a:119,b:87,c:null,d:null},AD03:{keyCode:69,a:101,b:69,c:8364,d:null},AD04:{keyCode:82,a:114,b:82,c:null,d:null},AD05:{keyCode:84,a:116,b:84,c:null,d:null},AD06:{keyCode:90,a:122,b:90,c:null,d:null},AD07:{keyCode:85,a:117,b:85,c:null,d:null},AD08:{keyCode:73,a:105,b:73,c:null,d:null},AD09:{keyCode:79,a:111,b:79,c:null,d:null},AD10:{keyCode:80,a:112,b:80,c:null,d:null},AD11:{keyCode:186,a:252,b:220,c:null,d:null},AD12:{keyCode:187,a:43,b:42,c:771,d:null},BKSL:{keyCode:191,a:35,b:39,c:null,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:68,a:100,b:68,c:null,d:null},AC04:{keyCode:70,a:102,b:70,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:74,a:106,b:74,c:null,d:null},AC08:{keyCode:75,a:107,b:75,c:null,d:null},AC09:{keyCode:76,a:108,b:76,c:null,d:null},AC10:{keyCode:192,a:246,b:214,c:null,d:null},AC11:{keyCode:222,a:228,b:196,c:null,d:null},AB01:{keyCode:89,a:121,b:89,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:78,a:110,b:78,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:181,d:null},AB08:{keyCode:188,a:44,b:59,c:null,d:null},AB09:{keyCode:190,a:46,b:58,c:null,d:null},AB10:{keyCode:189,a:45,b:95,c:null,d:null},LSGT:{keyCode:226,a:60,b:62,c:124,d:null}}),h=Object.freeze({TLDE:{keyCode:191,a:167,b:176,c:null,d:null},AE01:{keyCode:49,a:49,b:43,c:166,d:null},AE02:{keyCode:50,a:50,b:34,c:64,d:null},AE03:{keyCode:51,a:51,b:42,c:35,d:null},AE04:{keyCode:52,a:52,b:231,c:null,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:38,c:172,d:null},AE07:{keyCode:55,a:55,b:47,c:124,d:null},AE08:{keyCode:56,a:56,b:40,c:162,d:null},AE09:{keyCode:57,a:57,b:41,c:null,d:null},AE10:{keyCode:48,a:48,b:61,c:null,d:null},AE11:{keyCode:219,a:39,b:63,c:769,d:null},AE12:{keyCode:221,a:770,b:768,c:771,d:null},AD01:{keyCode:81,a:113,b:81,c:null,d:null},AD02:{keyCode:87,a:119,b:87,c:null,d:null},AD03:{keyCode:69,a:101,b:69,c:8364,d:null},AD04:{keyCode:82,a:114,b:82,c:null,d:null},AD05:{keyCode:84,a:116,b:84,c:null,d:null},AD06:{keyCode:90,a:122,b:90,c:null,d:null},AD07:{keyCode:85,a:117,b:85,c:null,d:null},AD08:{keyCode:73,a:105,b:73,c:null,d:null},AD09:{keyCode:79,a:111,b:79,c:null,d:null},AD10:{keyCode:80,a:112,b:80,c:null,d:null},AD11:{keyCode:186,a:252,b:232,c:91,d:null},AD12:{keyCode:192,a:776,b:33,c:93,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:68,a:100,b:68,c:null,d:null},AC04:{keyCode:70,a:102,b:70,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:74,a:106,b:74,c:null,d:null},AC08:{keyCode:75,a:107,b:75,c:null,d:null},AC09:{keyCode:76,a:108,b:76,c:null,d:null},AC10:{keyCode:222,a:246,b:233,c:null,d:null},AC11:{keyCode:220,a:228,b:224,c:123,d:null},BKSL:{keyCode:223,a:36,b:163,c:125,d:null},AB01:{keyCode:89,a:121,b:89,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:78,a:110,b:78,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:null,d:null},AB08:{keyCode:188,a:44,b:59,c:null,d:null},AB09:{keyCode:190,a:46,b:58,c:null,d:null},AB10:{keyCode:189,a:45,b:95,c:null,d:null},LSGT:{keyCode:226,a:60,b:62,c:92,d:null}}),i=Object.freeze({TLDE:{keyCode:222,a:178,b:null,c:null,d:null},AE01:{keyCode:49,a:38,b:49,c:null,d:null},AE02:{keyCode:50,a:233,b:50,c:771,d:null},AE03:{keyCode:51,a:34,b:51,c:35,d:null},AE04:{keyCode:52,a:39,b:52,c:123,d:null},AE05:{keyCode:53,a:40,b:53,c:91,d:null},AE06:{keyCode:54,a:45,b:54,c:124,d:null},AE07:{keyCode:55,a:232,b:55,c:768,d:null},AE08:{keyCode:56,a:95,b:56,c:92,d:null},AE09:{keyCode:57,a:231,b:57,c:94,d:null},AE10:{keyCode:48,a:224,b:48,c:64,d:null},AE11:{keyCode:219,a:41,b:176,c:93,d:null},AE12:{keyCode:187,a:61,b:43,c:125,d:null},AD01:{keyCode:65,a:97,b:65,c:null,d:null},AD02:{keyCode:90,a:122,b:90,c:null,d:null},AD03:{keyCode:69,a:101,b:69,c:8364,d:null},AD04:{keyCode:82,a:114,b:82,c:null,d:null},AD05:{keyCode:84,a:116,b:84,c:null,d:null},AD06:{keyCode:89,a:121,b:89,c:null,d:null},AD07:{keyCode:85,a:117,b:85,c:null,d:null},AD08:{keyCode:73,a:105,b:73,c:null,d:null},AD09:{keyCode:79,a:111,b:79,c:null,d:null},AD10:{keyCode:80,a:112,b:80,c:null,d:null},AD11:{keyCode:221,a:770,b:776,c:null,d:null},AD12:{keyCode:186,a:36,b:163,c:null,d:null},BKSL:{keyCode:220,a:42,b:181,c:null,d:null},AC01:{keyCode:81,a:113,b:81,c:null,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:68,a:100,b:68,c:null,d:null},AC04:{keyCode:70,a:102,b:70,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:74,a:106,b:74,c:null,d:null},AC08:{keyCode:75,a:107,b:75,c:null,d:null},AC09:{keyCode:76,a:108,b:76,c:null,d:null},AC10:{keyCode:77,a:109,b:77,c:null,d:null},AC11:{keyCode:192,a:249,b:37,c:null,d:null},AB01:{keyCode:87,a:119,b:87,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:78,a:110,b:78,c:null,d:null},AB07:{keyCode:188,a:44,b:63,c:null,d:null},AB08:{keyCode:190,a:59,b:46,c:null,d:null},AB09:{keyCode:191,a:58,b:47,c:null,d:null},AB10:{keyCode:223,a:33,b:167,c:null,d:null},LSGT:{keyCode:226,a:60,b:62,c:null,d:null}}),j=Object.freeze({TLDE:{keyCode:222,a:47,b:92,c:124,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:64,c:null,d:null},AE03:{keyCode:51,a:51,b:35,c:null,d:null},AE04:{keyCode:52,a:52,b:36,c:164,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:63,c:null,d:null},AE07:{keyCode:55,a:55,b:38,c:123,d:null},AE08:{keyCode:56,a:56,b:42,c:125,d:null},AE09:{keyCode:57,a:57,b:40,c:91,d:null},AE10:{keyCode:48,a:48,b:41,c:93,d:null},AE11:{keyCode:189,a:45,b:95,c:null,d:null},AE12:{keyCode:187,a:61,b:43,c:172,d:null},AD01:{keyCode:81,a:113,b:81,c:null,d:null},AD02:{keyCode:87,a:119,b:87,c:null,d:null},AD03:{keyCode:69,a:101,b:69,c:8364,d:null},AD04:{keyCode:82,a:114,b:82,c:null,d:null},AD05:{keyCode:84,a:116,b:84,c:null,d:null},AD06:{keyCode:89,a:121,b:89,c:null,d:null},AD07:{keyCode:85,a:117,b:85,c:null,d:null},AD08:{keyCode:73,a:105,b:73,c:null,d:null},AD09:{keyCode:79,a:111,b:79,c:null,d:null},AD10:{keyCode:80,a:112,b:80,c:null,d:null},AD11:{keyCode:219,a:770,b:776,c:768,d:null},AD12:{keyCode:221,a:231,b:199,c:771,d:null},BKSL:{keyCode:220,a:224,b:192,c:null,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:68,a:100,b:68,c:null,d:null},AC04:{keyCode:70,a:102,b:70,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:74,a:106,b:74,c:null,d:null},AC08:{keyCode:75,a:107,b:75,c:null,d:null},AC09:{keyCode:76,a:108,b:76,c:null,d:null},AC10:{keyCode:186,a:59,b:58,c:176,d:null},AC11:{keyCode:192,a:232,b:200,c:null,d:null},AB01:{keyCode:90,a:122,b:90,c:171,d:null},AB02:{keyCode:88,a:120,b:88,c:187,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:78,a:110,b:78,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:null,d:null},AB08:{keyCode:188,a:44,b:39,c:60,d:null},AB09:{keyCode:190,a:46,b:34,c:62,d:null},AB10:{keyCode:191,a:233,b:201,c:null,d:null},LSGT:{keyCode:226,a:249,b:217,c:null,d:null}}),k=Object.freeze({TLDE:{keyCode:191,a:167,b:176,c:null,d:null},AE01:{keyCode:49,a:49,b:43,c:166,d:null},AE02:{keyCode:50,a:50,b:34,c:64,d:null},AE03:{keyCode:51,a:51,b:42,c:35,d:null},AE04:{keyCode:52,a:52,b:231,c:null,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:38,c:172,d:null},AE07:{keyCode:55,a:55,b:47,c:124,d:null},AE08:{keyCode:56,a:56,b:40,c:162,d:null},AE09:{keyCode:57,a:57,b:41,c:null,d:null},AE10:{keyCode:48,a:48,b:61,c:null,d:null},AE11:{keyCode:219,a:39,b:63,c:769,d:null},AE12:{keyCode:221,a:770,b:768,c:771,d:null},AD01:{keyCode:81,a:113,b:81,c:null,d:null},AD02:{keyCode:87,a:119,b:87,c:null,d:null},AD03:{keyCode:69,a:101,b:69,c:8364,d:null},AD04:{keyCode:82,a:114,b:82,c:null,d:null},AD05:{keyCode:84,a:116,b:84,c:null,d:null},AD06:{keyCode:90,a:122,b:90,c:null,d:null},AD07:{keyCode:85,a:117,b:85,c:null,d:null},AD08:{keyCode:73,a:105,b:73,c:null,d:null},AD09:{keyCode:79,a:111,b:79,c:null,d:null},AD10:{keyCode:80,a:112,b:80,c:null,d:null},AD11:{keyCode:186,a:232,b:252,c:91,d:null},AD12:{keyCode:192,a:776,b:33,c:93,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:68,a:100,b:68,c:null,d:null},AC04:{keyCode:70,a:102,b:70,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:74,a:106,b:74,c:null,d:null},AC08:{keyCode:75,a:107,b:75,c:null,d:null},AC09:{keyCode:76,a:108,b:76,c:null,d:null},AC10:{keyCode:222,a:233,b:246,c:null,d:null},AC11:{keyCode:220,a:224,b:228,c:123,d:null},BKSL:{keyCode:223,a:36,b:163,c:125,d:null},AB01:{keyCode:89,a:121,b:89,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:78,a:110,b:78,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:null,d:null},AB08:{keyCode:188,a:44,b:59,c:null,d:null},AB09:{keyCode:190,a:46,b:58,c:null,d:null},AB10:{keyCode:189,a:45,b:95,c:null,d:null},LSGT:{keyCode:226,a:60,b:62,c:92,d:null}}),l=Object.freeze({TLDE:{keyCode:220,a:92,b:124,c:null,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:34,c:null,d:null},AE03:{keyCode:51,a:51,b:163,c:null,d:null},AE04:{keyCode:52,a:52,b:36,c:null,d:null},AE05:{keyCode:53,a:53,b:37,c:8364,d:null},AE06:{keyCode:54,a:54,b:38,c:null,d:null},AE07:{keyCode:55,a:55,b:47,c:null,d:null},AE08:{keyCode:56,a:56,b:40,c:null,d:null},AE09:{keyCode:57,a:57,b:41,c:null,d:null},AE10:{keyCode:48,a:48,b:61,c:null,d:null},AE11:{keyCode:219,a:39,b:63,c:null,d:null},AE12:{keyCode:221,a:236,b:94,c:null,d:null},AD01:{keyCode:81,a:113,b:81,c:null,d:null},AD02:{keyCode:87,a:119,b:87,c:null,d:null},AD03:{keyCode:69,a:101,b:69,c:8364,d:null},AD04:{keyCode:82,a:114,b:82,c:null,d:null},AD05:{keyCode:84,a:116,b:84,c:null,d:null},AD06:{keyCode:89,a:121,b:89,c:null,d:null},AD07:{keyCode:85,a:117,b:85,c:null,d:null},AD08:{keyCode:73,a:105,b:73,c:null,d:null},AD09:{keyCode:79,a:111,b:79,c:null,d:null},AD10:{keyCode:80,a:112,b:80,c:null,d:null},AD11:{keyCode:186,a:232,b:233,c:91,d:123},AD12:{keyCode:187,a:43,b:42,c:93,d:125},BKSL:{keyCode:191,a:249,b:167,c:null,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:68,a:100,b:68,c:null,d:null},AC04:{keyCode:70,a:102,b:70,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:74,a:106,b:74,c:null,d:null},AC08:{keyCode:75,a:107,b:75,c:null,d:null},AC09:{keyCode:76,a:108,b:76,c:null,d:null},AC10:{keyCode:192,a:242,b:231,c:64,d:null},AC11:{keyCode:222,a:224,b:176,c:35,d:null},AB01:{keyCode:90,a:122,b:90,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:78,a:110,b:78,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:null,d:null},AB08:{keyCode:188,a:44,b:59,c:null,d:null},AB09:{keyCode:190,a:46,b:58,c:null,d:null},AB10:{keyCode:189,a:45,b:95,c:null,d:null},LSGT:{keyCode:226,a:60,b:62,c:null,d:null}}),m=Object.freeze({TLDE:{keyCode:192,a:39,b:34,c:null,d:null},AE01:{keyCode:49,a:49,b:33,c:185,d:null},AE02:{keyCode:50,a:50,b:64,c:178,d:null},AE03:{keyCode:51,a:51,b:35,c:179,d:null},AE04:{keyCode:52,a:52,b:36,c:163,d:null},AE05:{keyCode:53,a:53,b:37,c:162,d:null},AE06:{keyCode:54,a:54,b:776,c:172,d:null},AE07:{keyCode:55,a:55,b:38,c:null,d:null},AE08:{keyCode:56,a:56,b:42,c:null,d:null},AE09:{keyCode:57,a:57,b:40,c:null,d:null},AE10:{keyCode:48,a:48,b:41,c:null,d:null},AE11:{keyCode:189,a:45,b:95,c:null,d:null},AE12:{keyCode:187,a:61,b:43,c:167,d:null},AD01:{keyCode:81,a:113,b:81,c:47,d:null},AD02:{keyCode:87,a:119,b:87,c:63,d:null},AD03:{keyCode:69,a:101,b:69,c:8364,d:null},AD04:{keyCode:82,a:114,b:82,c:null,d:null},AD05:{keyCode:84,a:116,b:84,c:null,d:null},AD06:{keyCode:89,a:121,b:89,c:null,d:null},AD07:{keyCode:85,a:117,b:85,c:null,d:null},AD08:{keyCode:73,a:105,b:73,c:null,d:null},AD09:{keyCode:79,a:111,b:79,c:null,d:null},AD10:{keyCode:80,a:112,b:80,c:null,d:null},AD11:{keyCode:219,a:769,b:768,c:null,d:null},AD12:{keyCode:221,a:91,b:123,c:170,d:null},AC01:{keyCode:65,a:97,b:65,c:null,d:null},AC02:{keyCode:83,a:115,b:83,c:null,d:null},AC03:{keyCode:68,a:100,b:68,c:null,d:null},AC04:{keyCode:70,a:102,b:70,c:null,d:null},AC05:{keyCode:71,a:103,b:71,c:null,d:null},AC06:{keyCode:72,a:104,b:72,c:null,d:null},AC07:{keyCode:74,a:106,b:74,c:null,d:null},AC08:{keyCode:75,a:107,b:75,c:null,d:null},AC09:{keyCode:76,a:108,b:76,c:null,d:null},AC10:{keyCode:186,a:231,b:199,c:null,d:null},AC11:{keyCode:222,a:771,b:770,c:null,d:null},BKSL:{keyCode:220,a:93,b:125,c:186,d:null},AB01:{keyCode:90,a:122,b:90,c:null,d:null},AB02:{keyCode:88,a:120,b:88,c:null,d:null},AB03:{keyCode:67,a:99,b:67,c:null,d:null},AB04:{keyCode:86,a:118,b:86,c:null,d:null},AB05:{keyCode:66,a:98,b:66,c:null,d:null},AB06:{keyCode:78,a:110,b:78,c:null,d:null},AB07:{keyCode:77,a:109,b:77,c:null,d:null},AB08:{keyCode:188,a:44,b:60,c:null,d:null},AB09:{keyCode:190,a:46,b:62,c:null,d:null},AB10:{keyCode:191,a:59,b:58,c:null,d:null},LSGT:{keyCode:226,a:92,b:124,c:null,d:null}}),n=Object.freeze({TLDE:{keyCode:192,a:1105,b:1025,c:null,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:34,c:null,d:null},AE03:{keyCode:51,a:51,b:8470,c:null,d:null},AE04:{keyCode:52,a:52,b:59,c:null,d:null},AE05:{keyCode:53,a:53,b:37,c:null,d:null},AE06:{keyCode:54,a:54,b:58,c:null,d:null},AE07:{keyCode:55,a:55,b:63,c:null,d:null},AE08:{keyCode:56,a:56,b:42,c:null,d:null},AE09:{keyCode:57,a:57,b:40,c:null,d:null},AE10:{keyCode:48,a:48,b:41,c:null,d:null},AE11:{keyCode:189,a:45,b:95,c:null,d:null},AE12:{keyCode:187,a:61,b:43,c:null,d:null},AD01:{keyCode:81,a:1081,b:1049,c:null,d:null},AD02:{keyCode:87,a:1094,b:1062,c:null,d:null},AD03:{keyCode:69,a:1091,b:1059,c:null,d:null},AD04:{keyCode:82,a:1082,b:1050,c:null,d:null},AD05:{keyCode:84,a:1077,b:1045,c:null,d:null},AD06:{keyCode:89,a:1085,b:1053,c:null,d:null},AD07:{keyCode:85,a:1075,b:1043,c:null,d:null},AD08:{keyCode:73,a:1096,b:1064,c:null,d:null},AD09:{keyCode:79,a:1097,b:1065,c:null,d:null},AD10:{keyCode:80,a:1079,b:1047,c:null,d:null},AD11:{keyCode:219,a:1093,b:1061,c:null,d:null},AD12:{keyCode:221,a:1098,b:1066,c:null,d:null},BKSL:{keyCode:220,a:92,b:47,c:null,d:null},AC01:{keyCode:65,a:1092,b:1060,c:null,d:null},AC02:{keyCode:83,a:1099,b:1067,c:null,d:null},AC03:{keyCode:68,a:1074,b:1042,c:null,d:null},AC04:{keyCode:70,a:1072,b:1040,c:null,d:null},AC05:{keyCode:71,a:1087,b:1055,c:null,d:null},AC06:{keyCode:72,a:1088,b:1056,c:null,d:null},AC07:{keyCode:74,a:1086,b:1054,c:null,d:null},AC08:{keyCode:75,a:1083,b:1051,c:null,d:null},AC09:{keyCode:76,a:1076,b:1044,c:null,d:null},AC10:{keyCode:186,a:1078,b:1046,c:null,d:null},AC11:{keyCode:222,a:1101,b:1069,c:null,d:null},AB01:{keyCode:90,a:1103,b:1071,c:null,d:null},AB02:{keyCode:88,a:1095,b:1063,c:null,d:null},AB03:{keyCode:67,a:1089,b:1057,c:null,d:null},AB04:{keyCode:86,a:1084,b:1052,c:null,d:null},AB05:{keyCode:66,a:1080,b:1048,c:null,d:null},AB06:{keyCode:78,a:1090,b:1058,c:null,d:null},AB07:{keyCode:77,a:1100,b:1068,c:null,d:null},AB08:{keyCode:188,a:1073,b:1041,c:null,d:null},AB09:{keyCode:190,a:1102,b:1070,c:null,d:null},AB10:{keyCode:191,a:46,b:44,c:null,d:null}}),o=Object.freeze({TLDE:{keyCode:192,a:93,b:91,c:null,d:null},AE01:{keyCode:49,a:49,b:33,c:null,d:null},AE02:{keyCode:50,a:50,b:34,c:null,d:null},AE03:{keyCode:51,a:51,b:8470,c:null,d:null},AE04:{keyCode:52,a:52,b:37,c:null,d:null},AE05:{keyCode:53,a:53,b:58,c:null,d:null},AE06:{keyCode:54,a:54,b:44,c:null,d:null},AE07:{keyCode:55,a:55,b:46,c:null,d:null},AE08:{keyCode:56,a:56,b:59,c:null,d:null},AE09:{keyCode:57,a:57,b:40,c:null,d:null},AE10:{keyCode:48,a:48,b:41,c:null,d:null},AE11:{keyCode:189,a:45,b:95,c:null,d:null},AE12:{keyCode:187,a:61,b:43,c:null,d:null},AD01:{keyCode:81,a:1081,b:1049,c:null,d:null},AD02:{keyCode:87,a:1094,b:1062,c:null,d:null},AD03:{keyCode:69,a:1091,b:1059,c:null,d:null},AD04:{keyCode:82,a:1082,b:1050,c:null,d:null},AD05:{keyCode:84,a:1077,b:1045,c:null,d:null},AD06:{keyCode:89,a:1085,b:1053,c:null,d:null},AD07:{keyCode:85,a:1075,b:1043,c:null,d:null},AD08:{keyCode:73,a:1096,b:1064,c:null,d:null},AD09:{keyCode:79,a:1097,b:1065,c:null,d:null},AD10:{keyCode:80,a:1079,b:1047,c:null,d:null},AD11:{keyCode:219,a:1093,b:1061,c:null,d:null},AD12:{keyCode:221,a:1098,b:1066,c:null,d:null},BKSL:{keyCode:220,a:1105,b:1025,c:null,d:null},AC01:{keyCode:65,a:1092,b:1060,c:null,d:null},AC02:{keyCode:83,a:1099,b:1067,c:null,d:null},AC03:{keyCode:68,a:1074,b:1042,c:null,d:null},AC04:{keyCode:70,a:1072,b:1040,c:null,d:null},AC05:{keyCode:71,a:1087,b:1055,c:null,d:null},AC06:{keyCode:72,a:1088,b:1056,c:null,d:null},AC07:{keyCode:74,a:1086,b:1054,c:null,d:null},AC08:{keyCode:75,a:1083,b:1051,c:null,d:null},AC09:{keyCode:76,a:1076,b:1044,c:null,d:null},AC10:{keyCode:186,a:1078,b:1046,c:null,d:null},AC11:{keyCode:222,a:1101,b:1069,c:null,d:null},AB01:{keyCode:90,a:1103,b:1071,c:null,d:null},AB02:{keyCode:88,a:1095,b:1063,c:null,d:null},AB03:{keyCode:67,a:1089,b:1057,c:null,d:null},AB04:{keyCode:86,a:1084,b:1052,c:null,d:null},AB05:{keyCode:66,a:1080,b:1048,c:null,d:null},AB06:{keyCode:78,a:1090,b:1058,c:null,d:null},AB07:{keyCode:77,a:1100,b:1068,c:null,d:null},AB08:{keyCode:188,a:1073,b:1041,c:null,d:null},AB09:{keyCode:190,a:1102,b:1070,c:null,d:null},AB10:{keyCode:191,a:47,b:63,c:null,d:null}});
return Object.freeze({ENGLISH_US_STANDARD:a,ENGLISH_UK_STANDARD_WIN:b,ENGLISH_UK_STANDARD_MAC:c,ENGLISH_US_DVORAK:d,ENGLISH_US_COLEMAK:e,ENGLISH_US_WORKMAN:f,GERMAN_STANDARD:g,GERMAN_SWITZERLAND:h,FRENCH_STANDARD:i,FRENCH_CANADA:j,FRENCH_SWITZERLAND:k,ITALIAN_STANDARD:l,PORTUGUESE_BRAZIL:m,RUSSIAN_WIN:n,RUSSIAN_MAC:o})}();!function(a){a[a.TLDE=192]="TLDE",a[a.AE01=49]="AE01",a[a.AE02=50]="AE02",a[a.AE03=51]="AE03",a[a.AE04=52]="AE04",a[a.AE05=53]="AE05",a[a.AE06=54]="AE06",a[a.AE07=55]="AE07",a[a.AE08=56]="AE08",a[a.AE09=57]="AE09",a[a.AE10=48]="AE10",a[a.AE11=189]="AE11",a[a.AE12=187]="AE12",a[a.BKSP=8]="BKSP",a[a.TAB=9]="TAB",a[a.AD01=81]="AD01",a[a.AD02=87]="AD02",a[a.AD03=69]="AD03",a[a.AD04=82]="AD04",a[a.AD05=84]="AD05",a[a.AD06=89]="AD06",a[a.AD07=85]="AD07",a[a.AD08=73]="AD08",a[a.AD09=79]="AD09",a[a.AD10=80]="AD10",a[a.AD11=219]="AD11",a[a.AD12=221]="AD12",a[a.BKSL=220]="BKSL",a[a.RTRN=13]="RTRN",a[a.CAPS=20]="CAPS",a[a.AC01=65]="AC01",a[a.AC02=83]="AC02",a[a.AC03=68]="AC03",a[a.AC04=70]="AC04",a[a.AC05=71]="AC05",a[a.AC06=72]="AC06",a[a.AC07=74]="AC07",a[a.AC08=75]="AC08",a[a.AC09=76]="AC09",a[a.AC10=186]="AC10",a[a.AC11=222]="AC11",a[a.LFSH=16]="LFSH",a[a.LSGT=226]="LSGT",a[a.AB01=90]="AB01",a[a.AB02=88]="AB02",a[a.AB03=67]="AB03",a[a.AB04=86]="AB04",a[a.AB05=66]="AB05",a[a.AB06=78]="AB06",a[a.AB07=77]="AB07",a[a.AB08=188]="AB08",a[a.AB09=190]="AB09",a[a.AB10=191]="AB10",a[a.RTSH=1016]="RTSH",a[a.LCTL=17]="LCTL",a[a.LALT=18]="LALT",a[a.SPCE=32]="SPCE",a[a.RALT=1018]="RALT",a[a.RCTL=1017]="RCTL",a[a.INS=45]="INS",a[a.HOME=36]="HOME",a[a.PGUP=33]="PGUP",a[a.DELE=46]="DELE",a[a.END=35]="END",a[a.PGDN=34]="PGDN",a[a.UP=38]="UP",a[a.LEFT=37]="LEFT",a[a.DOWN=40]="DOWN",a[a.RGHT=39]="RGHT",a[a.NMLK=144]="NMLK",a[a.KPDV=111]="KPDV",a[a.KPMU=106]="KPMU",a[a.KPSU=109]="KPSU",a[a.KP7=103]="KP7",a[a.KP8=104]="KP8",a[a.KP9=105]="KP9",a[a.KPAD=107]="KPAD",a[a.KP4=100]="KP4",a[a.KP5=101]="KP5",a[a.KP6=102]="KP6",a[a.KP1=97]="KP1",a[a.KP2=98]="KP2",a[a.KP3=99]="KP3",a[a.KPEN=1013]="KPEN",a[a.KP0=96]="KP0",a[a.KPDL=110]="KPDL"}(ib||(ib={}));var vb,wb=16,xb=32,yb=48,zb=64,Ab=64,Bb=96,Cb=112,Db=function(){var a=new qb("us",0|wb,"English/US",nb.EN,ub.ENGLISH_US_STANDARD,tb.TYPE_C),b=new qb("us-dvorak",8|wb,"English/US - Dvorak",nb.EN,ub.ENGLISH_US_DVORAK,tb.TYPE_C,a),c=new qb("us-colemak",9|wb,"English/US - Colemak",nb.EN,ub.ENGLISH_US_COLEMAK,tb.TYPE_C,a),d=new qb("us-workman",10|wb,"English/US - Workman",nb.EN,ub.ENGLISH_US_WORKMAN,tb.TYPE_C,a),e=new qb("de",0|xb,"German/Germany",nb.DE,ub.GERMAN_STANDARD,tb.TYPE_B),f=new qb("de-ch",1|xb,"German/Switzerland",nb.DE,ub.GERMAN_SWITZERLAND,tb.TYPE_B),g=new qb("fr",0|yb,"French/France",nb.FR,ub.FRENCH_STANDARD,tb.TYPE_B),h=new qb("fr-ca",1|yb,"French/Canada",nb.FR,ub.FRENCH_CANADA,tb.TYPE_B),i=new qb("fr-ch",2|yb,"French/Switzerland",nb.FR,ub.FRENCH_SWITZERLAND,tb.TYPE_B),j=new qb("it",0|zb,"Italian/Italy",nb.IT,ub.ITALIAN_STANDARD,tb.TYPE_B),k=new qb("pt-br",0|Bb,"Portuguese/Brazil",nb.PT,ub.PORTUGUESE_BRAZIL,tb.TYPE_B),l=navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)?!0:!1;if(l){var m=new qb("uk",1|wb,"English/UK",nb.EN,ub.ENGLISH_UK_STANDARD_MAC,tb.TYPE_C),n=new qb("ru",0|Cb,"Cyrillic/Russia (Mac)",nb.RU,ub.RUSSIAN_MAC,tb.TYPE_C);return Object.freeze({ENGLISH_US_STANDARD:a,ENGLISH_UK_STANDARD:m,ENGLISH_US_DVORAK:b,ENGLISH_US_COLEMAK:c,ENGLISH_US_WORKMAN:d,RUSSIAN:n})}var o=new qb("uk",1|wb,"English/UK",nb.EN,ub.ENGLISH_UK_STANDARD_WIN,tb.TYPE_B),p=new qb("ru",0|Cb,"Cyrillic/Russia (Win)",nb.RU,ub.RUSSIAN_WIN,tb.TYPE_A);return Object.freeze({ENGLISH_US_STANDARD:a,ENGLISH_UK_STANDARD:o,ENGLISH_US_DVORAK:b,ENGLISH_US_COLEMAK:c,ENGLISH_US_WORKMAN:d,GERMAN_STANDARD:e,GERMAN_SWITZERLAND:f,FRENCH_STANDARD:g,FRENCH_CANADA:h,FRENCH_SWITZERLAND:i,ITALIAN_STANDARD:j,PORTUGUESE_BRAZIL:k,RUSSIAN:p})}(),Eb=function(){function a(a,b,c){return this.id=a,this.xid=b,this.name=c,Object.freeze(this)}return a}(),Fb=Object.freeze({AUTO:new Eb("auto",1,"Computer-generated lessons"),CUSTOM:new Eb("custom",2,"User-provided lessons")}),Gb=function(){function a(a,b,c){return this.id=a,this.xid=b,this.type=c,Object.freeze(this)}return a}(),Hb=Object.freeze({GUIDED:new Gb("guided",1,Fb.AUTO),IMPORT_WEBSITE:new Gb("import_website",2,Fb.CUSTOM),IMPORT_TEXT:new Gb("import_text",3,Fb.CUSTOM)}),Ib=function(){function a(a,b,c,d){return this.id=a,this.xid=b,this.name=c,this.measure=d,Object.freeze(this)}return a.prototype.fromTime=function(a){return this.measure(6e4/a)},a}(),Jb=Object.freeze({WPM:new Ib("wpm",1,"Words per minute",function(a){return a/5}),CPM:new Ib("cpm",2,"Characters per minute",function(a){return a})}),Kb=function(){function a(a,b){this.layout=a,this.modeType=b,this.key=this.layout.id+":"+this.modeType.id,this.name=this.modeType.name+" / "+this.layout.name}return a.prototype.toString=function(){return this.key},a.get=function(b){var c=b.indexOf(":");if(-1==c)throw new Error;var d=b.substring(0,c),e=b.substring(c+1);return a.get1(d,e)},a.get1=function(b,c){return a.get2(J.fromCode(Db,b),J.fromCode(Fb,c))},a.get2=function(b,c){var d=b.id+":"+c.id,e=a.MAP[d];return null==e&&(e=a.MAP[d]=new a(b,c)),e},a.MAP=Object.create(null),a}(),Lb=function(){function a(b){this.storage=b,this.layout=a.DEFAULT_LAYOUT,this.emulateLayout=!1,this.mode=a.DEFAULT_MODE,this.lesson={complexity:1,length:1,capitals:!1,punctuators:!1},this.speedUnit=Jb.WPM,this.sound=!1,this.text={url:"",content:"",mangle:{simplify:!0,lowercase:!0}},this.newSettings=!0,this.reload(),this.newSettings&&this.persist()}return Object.defineProperty(a.prototype,"modeKey",{get:function(){return Kb.get2(this.layout,this.mode.type)},enumerable:!0,configurable:!0}),a.prototype.update=function(a){a.url&&(this.mode=Hb.IMPORT_WEBSITE,this.text.url=a.url)},a.prototype.reload=function(){function b(a,b){return null==a?!!b:!!a}var c=this.storage.getObject();null==c?c={}:this.newSettings=!1,c.layout=c.layout||"",c.mode=c.mode||"",c.lesson=c.lesson||{},c.text=c.text||{},c.text.mangle=c.text.mangle||{},this.layout=J.fromCode(Db,c.layout,a.DEFAULT_LAYOUT),this.emulateLayout=b(c.emulateLayout,!1),this.mode=J.fromCode(Hb,c.mode,a.DEFAULT_MODE),this.lesson.complexity=Math.max(0,Math.min(1,parseFloat(c.lesson.complexity)||0)),this.lesson.length=Math.max(0,Math.min(1,parseFloat(c.lesson.length)||0)),this.lesson.capitals=b(c.lesson.capitals,!1),this.lesson.punctuators=b(c.lesson.punctuators,!1),this.speedUnit=J.fromCode(Jb,c.speedUnit,Jb.WPM),this.sound=b(c.sound,!1),this.text.url=c.text.url||"",this.text.content=c.text.content||"",this.text.mangle.simplify=b(c.text.mangle.simplify,!0),this.text.mangle.lowercase=b(c.text.mangle.lowercase,!0)},a.prototype.persist=function(){this.storage.setObject({layout:this.layout.id,emulateLayout:this.emulateLayout,mode:this.mode.id,lesson:{complexity:this.lesson.complexity,length:this.lesson.length,capitals:this.lesson.capitals,punctuators:this.lesson.punctuators},speedUnit:this.speedUnit.id,sound:this.sound,text:{mangle:{simplify:this.text.mangle.simplify,lowercase:this.text.mangle.lowercase},url:this.text.url,content:this.text.content}})},a.prototype.remove=function(){this.storage.deleteObject()},a.DEFAULT_LAYOUT=Db.ENGLISH_US_STANDARD,a.DEFAULT_MODE=Hb.GUIDED,a}(),Mb=function(){function a(){}return a.prototype.init=function(a){function b(a){return[c+a+".ogg",c+a+".mp3",c+a+".wav"]}var c="/res/sound/";if(a.sound){if(null==this.library){this.library=Object.create(null);for(var d=["click","blip","correct","wrong","tada"],e=0;e<d.length;e++)this.library[d[e]]=new Howl({urls:b(d[e])})}}else this.library=null},a.prototype.play=function(a){if(this.library){var b=this.library[a];if(!b)throw new Error;b.stop(),b.play()}},a}(),Nb=new Mb,Ob=function(){function a(a,b){this.storage=a,this.sync=b,this.data=Object.create(null)}return a.prototype.get=function(a){var b=this.data[String(a)];return null==b&&(b=this.data[String(a)]=[]),b},a.prototype.add=function(a){return Y.explain(this.addImpl(a),"Cannot add new record to database")},a.prototype.addImpl=function(a){return this.sync.enabled?this.sync.send([a]):this.storage.add([a])},a.prototype.open=function(){return Y.explain(this.openImpl(),"Cannot read records from database")},a.prototype.openImpl=function(){return this.sync.enabled?this.receiveImpl():this.readImpl()},a.prototype.receiveImpl=function(){var a=this,b=Y.defer();return this.sync.receive().done(function(c){c.length>0?(c.sort(Xb.SORT_BY_TS),a.data=Xb.group(c),b.resolve(a.data)):a.storage.read().done(function(c){c.sort(Xb.SORT_BY_TS),a.data=Xb.group(c),c.length>0?a.sync.send(c).done(function(){a.storage.clear().done(function(){b.resolve(a.data)}).fail(function(a){b.reject(a)})}).fail(function(a){b.reject(a)}):b.resolve(a.data)}).fail(function(a){b.reject(a)})}).fail(function(a){b.reject(a)}),b.promise()},a.prototype.readImpl=function(){var a=this,b=Y.defer();return this.storage.read().done(function(c){c.sort(Xb.SORT_BY_TS),a.data=Xb.group(c),b.resolve(a.data)}).fail(function(a){b.reject(a)}),b.promise()},a.prototype.clear=function(){return Y.explain(this.clearImpl(),"Cannot clear database")},a.prototype.clearImpl=function(){return this.data=Object.create(null),this.sync.enabled?this.sync.clear():this.storage.clear()},a}(),Pb=function(){function a(a,b){this.name=a,this.factory=b,this.persistent=!0,this.objectStoreName="history"}return a.prototype.read=function(){var a=this,b=Y.defer();return this.withDatabase(b,function(c){var d=[];try{var e=c.transaction(a.objectStoreName),f=e.objectStore(a.objectStoreName)}catch(g){return void b.reject(g)}var h=f.openCursor();h.onerror=function(a){a.preventDefault(),b.reject(Y.cause(h.error))},h.onsuccess=function(){var a=h.result;if(a){try{var c=a.value;if(c.tx&&(c.n=c.tx.length),"string"==typeof c.l&&"string"==typeof c.m){var e=Xb.fromJson(c);e.validate()&&d.push(e)}}catch(f){}a["continue"]()}else b.resolve(d)}}),b.promise()},a.prototype.add=function(a){var b=this,c=Y.defer();return this.withDatabase(c,function(d){function e(){var b=g.add(Xb.toJson(a[i++]));b.onerror=function(a){a.preventDefault(),c.reject(Y.cause(b.error))},b.onsuccess=function(){i<a.length?e():c.resolve({})}}try{var f=d.transaction(b.objectStoreName,"readwrite"),g=f.objectStore(b.objectStoreName)}catch(h){return void c.reject(h)}var i=0;e()}),c.promise()},a.prototype.clear=function(){var a=Y.defer(),b=this.factory.deleteDatabase(this.name);return b.onerror=function(c){c.preventDefault(),a.reject(Y.cause(b.error))},b.onblocked=function(){a.reject({message:"Database is blocked"})},b.onsuccess=function(){a.resolve({})},a.promise()},a.prototype.withDatabase=function(a,b){var c=this,d=this.factory.open(this.name,1);d.onerror=function(b){b.preventDefault(),a.reject(Y.cause(d.error))},d.onblocked=function(){a.reject({message:"Database is blocked"})},d.onupgradeneeded=function(){{var a=d.result;a.createObjectStore(c.objectStoreName,{autoIncrement:!0})}},d.onsuccess=function(){var a=d.result;try{b(a)}finally{a.close()}}},a}(),Qb=function(){function a(a){this.user=a,this.enabled=!0}return a.prototype.send=function(a){var b=new Rb([],null);b.addAll(a);var c=b.format();c=V.RC4.encode(V.RC4.key(this.user.id),c);var d=Y.defer();return Z.POST("/sync").sendBinary(c.buffer).done(function(a){a.isBinary?d.resolve({}):d.reject(a.isJson?a.json:{message:"Invalid response"})}).fail(function(a){d.reject(a)}),Y.explain(d.promise(),"Cannot send data to server")},a.prototype.receive=function(){var a=Y.defer();return Z.GET("/sync").send().done(function(b){if(b.isBinary){var c=new Rb(null,new DataView(b.binary)),d=c.parse();a.resolve(d)}else a.reject(b.isJson?b.json:{message:"Invalid response"})}).fail(function(b){a.reject(b)}),Y.explain(a.promise(),"Cannot receive data from server")},a.prototype.clear=function(){var a=Y.defer();return Z.DELETE("/sync").send().done(function(b){b.isBinary?a.resolve({}):a.reject(b.isJson?b.json:{message:"Invalid response"})}).fail(function(b){a.reject(b)}),Y.explain(a.promise(),"Cannot delete data on server")},a.MESSAGE_SIGNATURE=1262836034,a.MESSAGE_VERSION=1,a.FILE_SIGNATURE=1262836034,a.FILE_VERSION=1,a}(),Rb=function(){function a(a,b){this.data=a,this.dataView=b}return a.prototype.addAll=function(a){for(var b=0;b<a.length;b++)this.add(a[b])},a.prototype.add=function(a){this.data.push(a)},a.prototype.format=function(){for(var b=0,c=0;c<this.data.length;c++)b+=a.L0+a.L1*Object.keys(this.data[c].histogram).length;var d=new ArrayBuffer(12+b+4);this.dataView=new DataView(d),this.dataView.setUint32(0,Qb.MESSAGE_SIGNATURE),this.dataView.setUint32(4,Qb.MESSAGE_VERSION),this.dataView.setUint32(8,this.data.length);for(var e=12,c=0;c<this.data.length;c++)e=this.formatRecord(e,this.data[c]);return this.dataView.setUint32(e,V.crc32(new Uint8Array(d,0,e))),new Uint8Array(d)},a.prototype.formatRecord=function(b,c){var d=Object.keys(c.histogram),e=d.length,f=c.timeStamp/1e3|0,g=c.timeStamp-1e3*f|0;this.dataView.setUint8(b+0,c.modeKey.layout.xid),this.dataView.setUint8(b+1,c.modeKey.modeType.xid),this.dataView.setUint32(b+2,f),this.dataView.setUint16(b+6,g),this.dataView.setUint16(b+8,c.time),this.dataView.setUint8(b+10,c.length),this.dataView.setUint8(b+11,c.errors),this.dataView.setUint8(b+12,c.complexity),this.dataView.setUint8(b+13,e),b+=a.L0;for(var h=0;e>h;h++){var i=parseInt(d[h]),j=c.histogram[i];this.dataView.setUint16(b+0,i),this.dataView.setUint8(b+2,j.h),this.dataView.setUint8(b+3,j.m),this.dataView.setUint32(b+4,Math.round(1e3*j.t)),b+=a.L1}return b},a.prototype.parse=function(){if(this.data=[],this.dataView.byteLength>8&&this.dataView.getUint32(0)==Qb.FILE_SIGNATURE&&this.dataView.getUint32(4)==Qb.FILE_VERSION)for(var a=8;a<this.dataView.byteLength;)a=this.parseRecord(a);return this.data},a.prototype.parseRecord=function(b){var c=this.dataView.getUint8(b+0),d=this.dataView.getUint8(b+1),e=this.dataView.getUint32(b+2),f=this.dataView.getUint16(b+6),g=this.dataView.getUint16(b+8),h=this.dataView.getUint8(b+10),i=this.dataView.getUint8(b+11),j=this.dataView.getUint8(b+12),k=this.dataView.getUint8(b+13);b+=a.L0;for(var l=Object.create(null),m=0;k>m;m++){var n=this.dataView.getUint16(b+0),o=this.dataView.getUint8(b+2),p=this.dataView.getUint8(b+3),q=this.dataView.getUint32(b+4)/1e3;l[n]={h:o,m:p,t:q},b+=a.L1}var r=Kb.get2(J.fromXCode(Db,c),J.fromXCode(Fb,d)),s=Math.round(1e3*e+f),t=new Xb(r,s,h,g,i,j,l);return t.validate()&&this.data.push(t),b},a.L0=14,a.L1=8,a}(),Sb=Object.freeze({MAX_SPEED:"max-speed",MAX_SCORE:"max-score",SPEED_STREAK:"speed-streak",SCORE_STREAK:"score-streak",ERRORS_STREAK:"errors-streak"}),Tb=Object.freeze({SILVER:"silver",BRONZE:"gold",GOLD:"gold",RUBY:"ruby"}),Ub=function(){function a(a,b){this.id=a,this.value=b}return a.prototype.description=function(){switch(this.id){case Sb.MAX_SPEED:return"Top speed so far";case Sb.MAX_SCORE:return"Best score so far";case Sb.SPEED_STREAK:return"Increasing speed sequence";case Sb.SCORE_STREAK:return"Increasing score sequence";case Sb.ERRORS_STREAK:return"Sequence without errors"}throw new Error},a.prototype.equals=function(a){return this.id===a.id&&this.value===a.value},a.prototype.toString=function(){return this.value?"["+this.value+"] "+this.description():this.description()},a}(),Vb=function(){function a(){this.last=null,this.maxSpeed=0,this.maxScore=0,this.speedStreak=0,this.scoreStreak=0,this.errorsStreak=0,this.count=0,this.reset()}return a.prototype.reset=function(){this.last=null,this.maxSpeed=0,this.maxScore=0,this.speedStreak=0,this.scoreStreak=0,this.errorsStreak=0,this.count=0},a.prototype.add=function(a){var b=[];return this.last&&(a.speed>=this.last.speed?(this.speedStreak++,7==this.speedStreak?b.push(new Ub(Sb.SPEED_STREAK,Tb.GOLD)):5==this.speedStreak?b.push(new Ub(Sb.SPEED_STREAK,Tb.BRONZE)):3==this.speedStreak&&b.push(new Ub(Sb.SPEED_STREAK,Tb.SILVER))):this.speedStreak=0,a.score>=this.last.score?(this.scoreStreak++,7==this.scoreStreak?b.push(new Ub(Sb.SCORE_STREAK,Tb.GOLD)):3==this.scoreStreak?b.push(new Ub(Sb.SCORE_STREAK,Tb.BRONZE)):5==this.scoreStreak&&b.push(new Ub(Sb.SCORE_STREAK,Tb.SILVER))):this.scoreStreak=0),0==a.errors?(this.errorsStreak++,17==this.errorsStreak?b.push(new Ub(Sb.ERRORS_STREAK,Tb.RUBY)):12==this.errorsStreak?b.push(new Ub(Sb.ERRORS_STREAK,Tb.GOLD)):8==this.errorsStreak?b.push(new Ub(Sb.ERRORS_STREAK,Tb.BRONZE)):5==this.errorsStreak&&b.push(new Ub(Sb.ERRORS_STREAK,Tb.SILVER))):this.errorsStreak=0,this.count>=10&&(a.speed>this.maxSpeed&&(this.maxSpeed=a.speed,b.push(new Ub(Sb.MAX_SPEED,null))),a.score>this.maxScore&&(this.maxScore=a.score,b.push(new Ub(Sb.MAX_SCORE,null)))),this.last=a,this.count++,b.length>0?{modeKey:a.modeKey,timeStamp:a.timeStamp,list:b}:null},a.prototype.analyze=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=this.add(d);e&&b.push(e)}return b},a}(),Wb=function(){function a(a,b){return this.charCode=a,this.f=b,Object.freeze(this)}return a.prototype.valueOf=function(){return this.charCode},a.SORT_BY_INDEX=function(a,b){return a.charCode-b.charCode},a.SORT_BY_FREQUENCY=function(a,b){return b.f-a.f},a.sort=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d]);return c.sort(b),c},a.predicate=function(a){return function(b){var c=a.keyCombo(b.charCode);return c&&!c.deadKey}},a.split=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(b(d,a.charCodeAt(d)));return c},a.PUNCTUATORS=a.split(".,:;!?-([\"'",function(b,c){return new a(c,0)}),a}(),Xb=function(){function a(a,b,c,d,e,f,g){return this.modeKey=a,this.timeStamp=b,this.length=c,this.time=d,this.errors=e,this.complexity=f,this.histogram=g,this.time>1&&this.length>1&&this.complexity>1?(this.speed=this.length/(this.time/1e3)*60,this.score=this.speed*this.complexity/(this.errors+1)*(this.length/50)):(this.speed=0,this.score=0),Object.freeze(this)}return a.prototype.validate=function(){return this.time>1&&this.length>1&&this.complexity>1&&this.speed>1&&this.speed<2500},a.toJson=function(a){return{l:a.modeKey.layout.id,m:a.modeKey.modeType.id,ts:a.timeStamp,n:a.length,t:a.time,e:a.errors,c:a.complexity,h:a.histogram}},a.fromJson=function(b){return new a(Kb.get1(b.l,b.m),b.ts,b.n,b.t,b.e,b.c,b.h)},a.group=function(a){for(var b=Object.create(null),c=0;c<a.length;c++){var d=a[c],e=d.modeKey,f=b[String(e)];null==f&&(f=b[String(e)]=[]),f.push(d)}return b},a.statistics=function(a){var b=0,c=0,d=0,e=0,f=0,g=0;if(a.length>0){for(var h=0;h<a.length;h++){var i=a[h];b+=i.time,c=Math.max(c,i.speed),d+=i.speed,e=Math.max(e,i.score),f+=i.score,g+=i.errors}d/=a.length,f/=a.length,g/=a.length}return{count:a.length,totalTime:b,topSpeed:c,avgSpeed:d,topScore:e,avgScore:f,avgErrors:g}},a.SORT_BY_TS=function(a,b){return a.timeStamp-b.timeStamp},a}(),Yb=function(){function a(a){this.charCode=a,this.t=[],this.st=[],this.learningTime=0,this.movingMean=X.movingMean(bc.WINDOW_SIZE)}return a.prototype.add=function(a){var b=a.histogram[this.charCode];b&&b.t>0&&(this.t.push(b.t),this.learningTime+=a.time,this.movingMean.add(b.t),this.movingMean.available&&this.st.push(this.movingMean.mean))},a.prototype.meanTime=function(){return this.movingMean.mean},a.prototype.minTime=function(){return this.movingMean.min},a.prototype.confidenceLevel=function(){return a.confidenceLevel(this.meanTime())},a.confidenceLevel=function(a){return null==a||0==a?null:(a=Math.max(a,bc.MIN_TIME),a=Math.min(a,bc.MAX_TIME),a=(a-bc.MIN_TIME)/(bc.MAX_TIME-bc.MIN_TIME),1-a)},a.prototype.isConfident=function(){return a.isConfident(this.minTime())},a.isConfident=function(a){return null==a||0==a?!1:a<=bc.MIN_TIME},a.prototype.learningRate=function(a){var b=X.linearRegression(this.t.map(function(b){return a.fromTime(b)}));return{unit:a,lr:b,perSample:b.beta,perHour:60*b.beta*60*1e3/(this.learningTime/this.t.length)}},a}(),Zb=function(){function a(a,b){this.letters=a,this.data=b,this.letters=a,this.data=b,this.map=Object.create(null);for(var c=0;c<this.letters.length;c++){var d=this.letters[c];this.map[d.charCode]=new Yb(d.charCode)}for(var c=0;c<this.data.length;c++){var e=this.data[c];this._add(e)}}return a.prototype.add=function(a){this.data.push(a),this._add(a)},a.prototype._add=function(a){for(var b=0;b<this.letters.length;b++){var c=this.letters[b];this.map[c.charCode].add(a)}},a}(),$b=function(){function a(b,c){this.modeKey=b,this.lesson=c,this.text=this.lesson.generate(),this.complexity=a.complexity(this.text),this.reset()}return a.prototype.reset=function(){this.started=null,this.elapsed=null,this.finished=null,this.errors=0,this.position=0,this.buffer=[],this.errorPos=[],this.histogram=Object.create(null),this.lastKeyTime=0,this.keyTimesMap=Object.create(null),this.result=null},a.prototype.put=function(a){if(8==a)return void this.back();if(0!=this.position||13!=a&&32!=a){var b=I.getTime();null==this.started&&(this.started=b),this.elapsed=b-this.started;var c=this.advance(a,I.now());if(this.isCompleted()){this.finished=this.elapsed;for(var d in this.histogram){var e=this.histogram[d],f=this.keyTimesMap[d];if(f){for(var g=0,h=0;h<f.length;h++)g+=f[h];g/=f.length,e.t=Math.round(1e3*g)/1e3}}this.result=new Xb(this.modeKey,this.started,this.text.length,this.elapsed,this.errors,this.complexity,this.histogram)}return c}},a.prototype.isCompleted=function(){return this.position==this.text.length},a.prototype.nextChar=function(){return this.position<this.text.length?this.text.charCodeAt(this.position):0},a.prototype.back=function(){this.lastKeyTime=0,this.position>0&&this.position--,this.buffer=[];for(var a=this.errorPos.length;a>0;a--){var b=this.errorPos[a-1];if(b<this.position)break}this.errorPos.splice(a)},a.prototype.advance=function(a,b){var c=3,d=this.text.charCodeAt(this.position);if(0==this.buffer.length){if(d==a)return this.hit(d),this.measureTime(d,b),this.position++,!0;this.errors++,this.errorPos.push(this.position)}this.lastKeyTime=0,this.buffer.push(a);var e;if(this.position+c<this.text.length&&this.buffer.length==c&&this.isSkipped()){for(this.miss(d),e=0;e<this.buffer.length;e++)this.hit(this.buffer[e]);return this.buffer=[],this.position+=c+1,this.lastKeyTime=b,null}if(this.position+c<this.text.length&&this.buffer.length==c+1&&this.isReplaced()){for(this.miss(d),e=1;e<this.buffer.length;e++)this.hit(this.buffer[e]);return this.buffer=[],this.position+=c+1,this.lastKeyTime=b,null}if(d==a){for(e=0;e<this.buffer.length-1;e++)this.miss(d);return this.hit(d),this.buffer=[],this.position++,this.lastKeyTime=b,!0}return!1},a.prototype.isSkipped=function(){for(var a=0;a<this.buffer.length;a++){var b=this.text.charCodeAt(this.position+1+a);if(b!=this.buffer[a])return!1}return!0},a.prototype.isReplaced=function(){for(var a=1;a<this.buffer.length;a++){var b=this.text.charCodeAt(this.position+a);if(b!=this.buffer[a])return!1}return!0},a.prototype.hit=function(a){var b=this.histogram[a];null==b&&(this.histogram[a]=b={h:0,m:0,t:0}),b.h++},a.prototype.miss=function(a){var b=this.histogram[a];null==b&&(this.histogram[a]=b={h:0,m:0,t:0}),b.m++},a.prototype.measureTime=function(a,b){if(this.lastKeyTime>0){var c=this.keyTimesMap[a];null==c&&(this.keyTimesMap[a]=c=[]),c.push(b-this.lastKeyTime)}this.lastKeyTime=b},a.complexity=function(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);-1==b.indexOf(d)&&b.push(d)}return b.length},a}(),_b=function(){function a(){}return a.loadLesson=function(b){switch(b.mode){case Hb.GUIDED:return a.loadGuided(b);case Hb.IMPORT_WEBSITE:return a.importUrl(b);case Hb.IMPORT_TEXT:return a.importText(b);default:throw new Error}},a.loadGuided=function(a){return kb.load(a.layout.lang).then(function(b){return new bc(a,b)})},a.importUrl=function(a){var b=Y.defer();return Z.GET("/fetch",{url:a.text.url}).send().done(function(c){c.isText?b.resolve(new ac(a,new jb(a,c.text))):b.reject(c.isJson?c.json:{message:"Invalid data"})}).fail(function(a){b.reject(a)}),Y.explain(b.promise(),"Cannot fetch web page")},a.importText=function(a){return Y.resolve(new ac(a,new jb(a,a.text.content)))},a}(),ac=function(){function a(a,b){this.settings=a,this.generator=b,this.letters=[]}return a.prototype.generate=function(){return this.generator.generate()},a.prototype.update=function(){},a}(),bc=function(){function a(a,b){this.settings=a,this.generator=b,this.includeKeys=[],this.excludeKeys=[];var c=Wb.predicate(this.settings.layout);this.letters=this.generator.letters.filter(c).sort(Wb.SORT_BY_FREQUENCY),this.generator.punctuators=Wb.PUNCTUATORS.filter(c).map(function(a){return String.fromCharCode(a.charCode)})}return a.prototype.generate=function(){return this.generator.filter=this.includeKeys.length?this.includeKeys.map(function(a){return a.charCode}):null,this.generator.boost=this.boost,this.generator.wordLimit=5+Math.round(4*this.settings.lesson.length),this.generator.fragmentLimit=50+Math.round(100*this.settings.lesson.length),this.generator.enableCapitals=this.settings.lesson.capitals,this.generator.enablePunctuators=this.settings.lesson.punctuators,this.generator.generate()},a.prototype.update=function(b){this.update1(b,a.MIN_SIZE)},a.prototype.update1=function(a,b){var c=b+Math.round((this.letters.length-b)*this.settings.lesson.complexity);this.update2(a,b,c)},a.prototype.update2=function(a,b,c){this.includeKeys=[],this.excludeKeys=[],this.boost=null;for(var d=[],e=0,f=0;f<this.letters.length;f++){var g=this.letters[f],h=a.map[g.charCode],i={charCode:g.charCode,f:g.f,t:h.meanTime(),confidenceLevel:h.confidenceLevel(),isConfident:h.isConfident(),isForced:f>=b&&c>f,isBoosted:!1};b>f?(this.includeKeys.push(i),i.isConfident||e++):i.isConfident?this.includeKeys.push(i):d.push(i)}for(d.length>0&&1>e&&(i=d.shift(),this.includeKeys.push(i));d.length>0;)i=d.shift(),i.isForced?this.includeKeys.push(i):this.excludeKeys.push(i);var j=this.includeKeys.filter(function(a){return null==a.confidenceLevel||a.confidenceLevel<1});j.length>0&&(j.sort(function(a,b){var c=a.confidenceLevel||0,d=b.confidenceLevel||0;return c==d?b.f-a.f:c-d}),i=j.shift(),i.isBoosted=!0,this.boost={charCode:i.charCode,factor:this.generator.getBoostFactor(i.charCode)})},a.MIN_SIZE=6,a.MIN_TIME=340,a.MAX_TIME=1e3,a.WINDOW_SIZE=20,a}(),cc=function(){function a(a){this.$root=a}return a.confidenceColor=function(b){if(null==b)return new M(14540253);var c=a.COLOR_MIN_CONFIDENCE,d=a.COLOR_MAX_CONFIDENCE;return new M(Math.round((d.r-c.r)*b+c.r),Math.round((d.g-c.g)*b+c.g),Math.round((d.b-c.b)*b+c.b))},a.prototype.update=function(b,c){function d(a){var c=["Character '"+m(a)+"'"];if(a.t?(c.push("Typing speed: "+i(e.fromTime(a.t),1)+e.id),c.push("Time to type: "+i(a.t,1)+"ms"),c.push("Confidence level: "+i(a.confidenceLevel,100))):c.push("Not calibrated"),a.isBoosted){var d=b.map[a.charCode];if(d.t.length>=10){var f=d.learningRate(e),g="~"+String(i(f.perSample,1e3))+e.id+"/sample",h="~"+String(i(f.perHour,1))+e.id+"/hour";c.push("Learning rate: "+g+", "+h)}c.push("Boosted frequency")}return a.isForced&&c.push("Added by user"),c.join("; ")}var e=c.settings.speedUnit;if(this.$root.empty(),c.includeKeys&&c.excludeKeys){if(c.includeKeys.length){for(var f=$("<span></span>").addClass("include"),g=0;g<c.includeKeys.length;g++){var h=c.includeKeys[g],j=$("<span></span>").addClass("lesson-key").addClass("included").css("background-color",String(a.confidenceColor(h.confidenceLevel))).text(m(h)).attr("title",d(h)).data("item",h);h.isForced&&j.addClass("forced"),h.isBoosted&&j.addClass("boosted"),f.append(j)}this.$root.append(f)}if(c.excludeKeys.length){for(var k=$("<span></span>").addClass("exclude"),g=0;g<c.excludeKeys.length;g++){var h=c.excludeKeys[g],j=$("<span></span>").addClass("lesson-key").addClass("excluded").css("background-color","#F3F3F3").text(m(h)).attr("title",d(h)).data("item",h);k.append(j)}this.$root.append(k)}}else this.$root.append($("<span></span>").text("manual mode"))},a.COLOR_MIN_CONFIDENCE=new M(13369344),a.COLOR_MAX_CONFIDENCE=new M(7334996),a}(),dc=function(){function a(a,b){this.lesson=a,this.fragment=b,this.$root=H.make("div",["fragment"]),this.$item=[];for(var c=this.fragment.text,d=0;d<c.length;d++){var e=c.charCodeAt(d);if(10==e)this.$root.appendChild(this.$item[d]=H.make("span",["item","new-line"],"↵")),this.$root.appendChild(H.make("br",null,null));else if(32==e)this.$root.appendChild(this.$item[d]=H.make("span",["item","space"],"␣")),this.$root.appendChild(H.make("span",null," "));else{var f=["item"];this.lesson.boost&&e==this.lesson.boost.charCode&&f.push("boosted"),this.$root.appendChild(this.$item[d]=H.make("span",f,String.fromCharCode(e)))}}this.updateUi()}return a.prototype.attach=function(a){a.appendChild(this.$root)},a.prototype.detach=function(){this.$root.parentNode.removeChild(this.$root)},a.prototype.updateUi=function(){var a,b,c,d=this.fragment.text,e=this.fragment.position,f=this.fragment.errorPos,g=-1;for(a=0;e>a;a++)c=this.$item[a],c.classList.add("down"),c.classList.remove("cursor");for(a=e;a<d.length;a++)c=this.$item[a],c.classList.remove("down"),a==e?c.classList.add("cursor"):c.classList.remove("cursor");for(a=0,b=0;a<d.length;a++){if(c=this.$item[a],a>g)for(;b<f.length&&(g=f[b],!(g>=a));b++);g==a&&g!=e?c.classList.add("error"):c.classList.remove("error")}},a.prototype.createPauseAnimation=function(){return new fc(this.$item)},a}(),ec=function(){function a(a){this.animations=a}return a.prototype.start=function(){this.init(),this.schedule()},a.prototype.cancel=function(){this.unschedule(),this.reset()},a.prototype.schedule=function(){var a=this;this.timer=window.requestAnimationFrame(function(b){a.step(b)})},a.prototype.unschedule=function(){this.timer&&(window.cancelAnimationFrame(this.timer),this.timer=null)},a.prototype.init=function(){this.started=null,this.animations.forEach(function(a){a.init()})},a.prototype.step=function(a){null==this.started&&(this.started=a);var b=a-this.started;this.animations.forEach(function(a){a.step(b)}),this.schedule()},a.prototype.reset=function(){this.animations.forEach(function(a){a.reset()})},a}(),fc=(function(){function a(){}return a.prototype.init=function(){},a.prototype.step=function(){},a.prototype.reset=function(){},a}(),function(){function a(a){this.elements=a}return a.prototype.init=function(){this.t=0,this.f=!0},a.prototype.step=function(a){if(this.t+350<a){this.t=a;for(var b=0;b<this.elements.length;b++){var c=this.elements[b];c.style.visibility=this.f?"hidden":""}this.f=!this.f}},a.prototype.reset=function(){for(var a=0;a<this.elements.length;a++){var b=this.elements[a];b.style.visibility=""}},a}()),gc=(function(){function a(a){this.elements=a}return a.prototype.init=function(){function a(a,b){return a+Math.floor(Math.random()*(b-a+1))}for(var b=0;b<this.elements.length;b++){{var c=this.elements[b];c.__anim={x:c.offsetLeft,y:c.offsetTop,rx:a(5,20)*(a(0,1)>0?1:-1),ry:a(5,20)*(a(0,1)>0?1:-1),sx:a(80,200),sy:a(80,200)}}c.style.position="absolute"}},a.prototype.step=function(a){for(var b=0;b<this.elements.length;b++){var c=this.elements[b],d=c.__anim,e=d.x+Math.sin(a/d.sx)*d.rx,f=d.y+Math.cos(a/d.sy)*d.ry;c.style.left=e+"px",c.style.top=f+"px"}},a.prototype.reset=function(){for(var a=0;a<this.elements.length;a++){var b=this.elements[a];delete b.__anim,b.style.position="",b.style.left="",b.style.top=""}},a}(),document.getElementById("game"),document.getElementById("text")),hc=document.getElementById("keyboard"),ic=$("#g-achievements"),jc=$("#g-speed"),kc=$("#g-speed-gain"),lc=$("#g-errors"),mc=$("#g-errors-gain"),nc=$("#g-score"),oc=$("#g-score-gain"),pc=$("#g-key-times-gain"),qc=$("#g-lesson-key-details"),rc=$(".button.tour"),sc=function(){function a(a,b,c){this.settings=a,this.database=b,this.lesson=c,this.refresh()}return a.prototype.refresh=function(){this.data=this.database.get(this.settings.modeKey),this.forecast=new Zb(this.lesson.letters,this.data),this.analyzer=new Vb,this.analyzer.analyze(this.data)},a.prototype.update=function(){this.lesson.update(this.forecast),r(this.forecast,this.lesson)},a.prototype.add=function(a){for(var b=Xb.statistics(this.data),c=[],d=0;d<this.lesson.letters.length;d++){var e=this.lesson.letters[d],f=this.forecast.map[e.charCode],g=a.histogram[e.charCode];if(g&&g.t>0){var h=g.t,i=f.meanTime();h&&i&&c.push({charCode:e.charCode,delta:i-h})}}c.sort(function(a,b){return b.delta-a.delta}),this.forecast.add(a);
var j=this.analyzer.add(a),k=this.settings.speedUnit,l=a.speed-b.avgSpeed,m=a.score-b.avgScore,n=-(a.errors-b.avgErrors);return jc.text(Math.round(k.measure(a.speed))),lc.text(Math.round(a.errors)),nc.text(Math.round(a.score)),o(kc,k.measure(l)),o(oc,m),o(mc,n),p(j),q(c),j&&j.list.length?Nb.play("tada"):0==a.errors&&Nb.play("correct"),this.database.add(a)},a}(),tc=function(){function a(a,b){this.settings=a,this.database=b}return a.prototype.init=function(){var a=this,b=this.buildTour();rc.on("click",function(){return b.start(),!1});var c=this.settings.newSettings;window.setInterval(function(){gc.classList.toggle("blink")},300),window.addEventListener("blur",function(){a.reset(),document.body.classList.add("pause")}),window.addEventListener("focus",function(){a.reset(),document.body.classList.remove("pause")}),z({path:"game",onShow:function(){c&&(c=!1,b.start()),a.resume()},onHide:function(){b.cancel(),a.pause()}}),this.keyboardUi=new sb(hc)},a.prototype.start=function(){var a=this;Nb.init(this.settings),_b.loadLesson(this.settings).done(function(b){a.lesson=b,a.settings.layout.configure(a.settings),a.keyboardUi.init(a.settings.layout,!0),a.progressNotifier=new sc(a.settings,a.database,a.lesson),a.next()}).fail(B)},a.prototype.reset=function(){this.fragment&&(this.fragment.reset(),this.update(this.fragment))},a.prototype.next=function(){this.update(null)},a.prototype.update=function(b){var c=this;this.progressNotifier.update(),this.fragment=b?b:new $b(this.settings.modeKey,this.lesson),a.dispatchLessonStartedEvent(this.fragment),this.fragmentUi&&this.fragmentUi.detach(),this.fragmentUi=new dc(this.lesson,this.fragment),this.fragmentUi.attach(gc),this.keyboardUi.reset(),this.highlight(),this.handler=this.settings.layout.createEventHandler(function(a){c.progress(a)})},a.prototype.progress=function(b){var c=this.fragment.put(b);a.dispatchLessonProgressEvent(this.fragment),this.highlight(),c===!0&&Nb.play("click"),c===!1&&Nb.play("blip"),this.fragment.isCompleted()?this.completed(this.fragment.result):this.fragment.elapsed>6e4&&this.next()},a.prototype.completed=function(b){b.validate()&&(a.dispatchLessonCompletedEvent(b),this.progressNotifier.add(b).fail(B)),this.next()},a.prototype.highlight=function(){this.fragmentUi.updateUi(),this.keyboardUi.highlight(this.fragment.nextChar())},a.prototype.pause=function(){this.active=!1,this.cancelPauseAnimation(),U.listen(null)},a.prototype.resume=function(){this.active=!0,n(),this.reset(),U.listen(this.keyEventListener())},a.prototype.delayPauseAnimation=function(){var a=this;this.cancelPauseAnimation(),this.timeoutId=window.setTimeout(function(){a.kickPauseAnimation()},3e4)},a.prototype.kickPauseAnimation=function(){this.cancelPauseAnimation(),document.body.classList.add("shake"),this.pauseAnimation=new ec([this.keyboardUi.createPauseAnimation(),this.fragmentUi.createPauseAnimation()]),this.pauseAnimation.start()},a.prototype.cancelPauseAnimation=function(){this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=null),document.body.classList.remove("shake"),this.pauseAnimation&&(this.pauseAnimation.cancel(),this.pauseAnimation=null)},a.prototype.keyEventListener=function(){var a=this;return function(b,c){return a.active?b?a.keyDown(c):a.keyUp(c):void 0}},a.prototype.keyDown=function(a){if(this.pauseAnimation)this.cancelPauseAnimation(),this.reset();else if(this.keyboardUi.keyDown(a),27==a.keyCode)this.kickPauseAnimation();else{if(37==a.keyCode&&a.ctrlKey)return this.reset(),!1;if(39==a.keyCode&&a.ctrlKey)return this.next(),!1;if(!U.isSpecialKey(a))return this.handler.keyDown(a),this.delayPauseAnimation(),!1}},a.prototype.keyUp=function(a){this.keyboardUi.keyUp(a),this.handler.keyUp(a)},a.prototype.buildTour=function(){var a=this,b=vb.Tour.buildPages(".tour-page"),c={onStart:function(){document.body.classList.add("tour"),a.pause()},onStop:function(){document.body.classList.remove("tour"),a.resume()}};return new vb.Tour(b,c)},a.dispatchLessonStartedEvent=function(a){document.dispatchEvent(b(fb,{detail:{fragment:a},bubbles:!0,cancelable:!1}))},a.dispatchLessonProgressEvent=function(a){document.dispatchEvent(b(gb,{detail:{fragment:a},bubbles:!0,cancelable:!1}))},a.dispatchLessonCompletedEvent=function(a){document.dispatchEvent(b(hb,{detail:{result:a},bubbles:!0,cancelable:!1}))},a}();!function(a){var b=function(){function a(a){var b=this;this.$el=a,this.$placeholder=this.$el.children("span"),0==this.$placeholder.length&&this.$el.append(this.$placeholder=$("<span></span>")),this.$list=this.$el.children("ul"),0==this.$list.length&&this.$el.append(this.$list=$('<ul tabindex="1"></ul>')),this.$el.on("click",function(){return b.$el.toggleClass("active"),!1}),this.clear()}return a.prototype.listen=function(a){this.change=a},a.prototype.clear=function(){this.$placeholder.text("-"),this.$list.empty(),this.map=Object.create(null),this.value=null},a.prototype.add=function(a,b){var c=this;b=b||a;var d=$('<a href="#"></a>').data("value",b).text(a),e=$("<li></li>").append(d);d.on("click",function(){return c.$el.removeClass("active"),c.select(b),!1}),this.$list.append(e),this.map[b]={text:a,value:b}},a.prototype.select=function(a){var b=this.map[a];b?(this.$placeholder.text(b.text),this.value=b.value,this.change&&this.change(this,this.value)):(this.$placeholder.text("-"),this.value=null)},a}();a.DropDown=b,$(document).on("click",function(){$(".ui.dropdown").removeClass("active")})}(vb||(vb={}));var vb;!function(a){var b=function(){function a(b,c){var d=this;if(0==b.length)throw new Error;this.pages=b,this.config=$.extend(a.DEFAULT_CONFIG,c),this.pageIndex=this.config.pageIndex,this.$root=$("body"),this.$overlay=$(['<div class="tour-overlay">','<div class="c1"></div>','<div class="c2"></div>','<div class="c3"></div>','<div class="c4"></div>','<div class="marker"></div>',"</div>"].join("")),this.$overlay.hide(),this.$root.append(this.$overlay),this.$tour=$(['<div class="tour-block vertical flex">','<a href="#" class="tour-close"><svg class="ui icon"><use xlink:href="#icon-close"/></svg></a>','<div class="tour-content fill article"></div>','<div class="tour-progress-wrapper horizontal flex align-center">','<div class="tour-progress-bar horizontal flex align-center fill"></div>','<a href="#" class="tour-prev"></a>','<a href="#" class="tour-next"></a>',"</div>","</div>"].join("")),this.$tour.hide(),this.$tour.find(".tour-close").on("click",function(a){a.preventDefault(),d.stop()}),this.$tour.find(".tour-prev").on("click",function(a){a.preventDefault(),d.prev()}),this.$tour.find(".tour-next").on("click",function(a){a.preventDefault(),d.next()}),this.$progress=this.$tour.find(".tour-progress-bar");for(var e=0;e<this.pages.length;e++)this.$progress.append($('<span class="pi"></span>'));this.$root.append(this.$tour)}return a.buildPages=function(a){var b=[];return $(a).each(function(a,c){var d=$(c);b.push({selection:$(d.data("query")),content:d.html(),position:d.data("position")})}),b},a.prototype.bindEvents=function(){var a=this;$(window).on("resize.Tour",function(b){a.resizeEvent(b)}),$(document).on("keydown.Tour",function(b){a.keyEvent(b)})},a.prototype.unbindEvents=function(){$(window).off("resize.Tour"),$(document).off("keydown.Tour")},a.prototype.resizeEvent=function(){this.run()},a.prototype.keyEvent=function(a){switch(a.keyCode){case 27:a.preventDefault(),this.stop();break;case 37:case 38:case 8:a.preventDefault(),this.prev();break;case 39:case 40:case 32:a.preventDefault(),this.next()}},a.prototype.next=function(){this.isLast()?this.stop():this.pageIndex<this.pages.length-1&&(this.pageIndex++,this.run(),this.callCallback())},a.prototype.prev=function(){this.isFirst()||this.pageIndex>0&&(this.pageIndex--,this.run(),this.callCallback())},a.prototype.callCallback=function(){var a=this.pages[this.pageIndex].callback;a&&a(this.pageIndex)},a.prototype.run=function(){var a=this.pages[this.pageIndex];this.showCurrentPage(a),this.config.onChange(this.pageIndex,a)},a.prototype.showCurrentPage=function(a){"string"==typeof a.selection&&(a.selection=$(a.selection)),this.updateTourBlock(a),this.showTourBlock(a)},a.prototype.isFirst=function(){return 0===this.pageIndex},a.prototype.isLast=function(){return this.pageIndex===this.pages.length-1},a.prototype.updateTourBlock=function(a){var b=a.prevLabel||this.config.prevLabel,c=a.nextLabel||this.config.nextLabel,d=a.finishLabel||this.config.finishLabel,e=this.$progress.children();e.removeClass("current"),$(e[this.pageIndex]).addClass("current"),this.$tour.find(".tour-content").html(a.content),this.$tour.find(".tour-prev").html(b).toggle(!this.isFirst()),this.$tour.find(".tour-next").html(this.isLast()?d:c).toggle(!0),this.$tour.removeClass("slide s n e w"),this.$tour.addClass(a.selection.length?a.position:"slide"),this.positionBlock(a,"left"),this.positionBlock(a,"top"),a.selection.length?(this.positionOverlay(a),this.$overlay.show()):this.$overlay.hide()},a.prototype.positionBlock=function(a,b){var c=a.selection.offset(),d=a.selection.outerWidth(),e=a.selection.outerHeight(),f=this.$tour.outerWidth(),g=this.$tour.outerHeight(),h=$(window).width(),i=$(window).height(),j=18,k=18,l=0,m=0;switch(a.position){case"e":l=c.left+d+k,m=c.top-(g-e)/2;break;case"s":l=c.left+(d-f)/2,m=c.top+e+j;break;case"w":l=c.left-(k+f),m=c.top-(g-e)/2;break;case"n":l=c.left+(d-f)/2,m=c.top-j-g;break;default:l=(h-f)/2,m=(i-g)/2}this.$tour.css("left"==b?{left:l}:{top:m})},a.prototype.positionOverlay=function(a){var b=this.$overlay.find(".c1"),c=this.$overlay.find(".c2"),d=this.$overlay.find(".c3"),e=this.$overlay.find(".c4"),f=this.$overlay.find(".marker"),g=a.selection.offset(),h=g.left-5,i=g.top-5,j=a.selection.outerWidth()+10,k=a.selection.outerHeight()+10;b.css({left:0,top:0,width:h+j,height:i}),c.css({left:h+j,top:0,right:0,height:i+k}),d.css({left:h,top:i+k,right:0,bottom:0}),e.css({left:0,top:i,width:h,bottom:0}),f.css({left:h,top:i,width:j,height:k})},a.prototype.showTourBlock=function(){this.$tour.show();var a=$(window).height(),b=$(window).scrollTop(),c=this.$tour.offset().top,d=100;b+a>c&&c>=b||this.$root.animate({scrollTop:c-d},"slow")},a.prototype.hideTourBlock=function(){this.$overlay.hide(),this.$tour.hide()},a.prototype.start=function(){this.config.onStart(),this.bindEvents(),this.run()},a.prototype.stop=function(){this.cancel(),this.config.onStop()},a.prototype.cancel=function(){this.unbindEvents(),this.hideTourBlock(),this.pageIndex=this.config.pageIndex},a.DEFAULT_CONFIG={pageIndex:0,nextLabel:"Next",prevLabel:"Back",finishLabel:"Close",onStart:$.noop,onStop:$.noop,onChange:$.noop},a}();a.Tour=b}(vb||(vb={}));var vb;!function(a){function b(a){var b=$(['<div class="dialog-overlay vertical flex justify-center align-center">',"</div>"].join("")),c=$(['<div class="dialog-block vertical flex">','<div class="dialog-content fill grid-row">',"</div>",'<div class="dialog-buttons horizontal flex justify-end grid-row field-list"></div>',"</div>"].join(""));c.find(".dialog-content").append(a.$content.html()),a.buttons.forEach(function(a){var d=$("<button></button>").append(a.$label);c.find(".dialog-buttons").append($('<span class="field"></span>').append(d)),d.on("click",function(){b.remove(),a.handler&&a.handler()})}),$("body").append(b.append(c))}a.alert=b}(vb||(vb={}));var uc,vc=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},wc=function(){function a(a,b){this.letters=a,this.data=b,this.map=Object.create(null),this.minh=null,this.maxh=0,this.minm=null,this.maxm=0,this.minr=null,this.maxr=0,this.count=0;for(var c=0;c<this.letters.length;c++){var d=this.letters[c];this.map[d.charCode]={h:0,m:0,r:0}}for(var c=0;c<this.data.length;c++)this.add(this.data[c])}return a.prototype.add=function(a){for(var b=0;b<this.letters.length;b++){var c=this.letters[b],d=this.map[c.charCode],e=a.histogram[c.charCode];e&&(d.h+=0|e.h,d.m+=0|e.m,d.r=d.m/d.h,this.maxh=Math.max(this.maxh,d.h),this.maxm=Math.max(this.maxm,d.m),this.maxr=Math.max(this.maxr,d.r),0==this.count?(this.minh=d.h,this.minm=d.m,this.minr=d.r):(this.minh=Math.min(this.minh,d.h),this.minm=Math.min(this.minm,d.m),this.minr=Math.min(this.minr,d.r)))}this.count++},a}(),xc=function(){function a(a,b,c,d,e){this.size=a,this.top=b,this.right=c,this.bottom=void 0!==d?d:b,this.left=void 0!==e?e:c,this.width=this.size.width-this.left-this.right,this.height=this.size.height-this.top-this.bottom}return a.prototype.x=function(a){return a+this.left},a.prototype.y=function(a){return a+this.top},a}(),yc=function(){function a(a){var b=$(a).parent();this.size={width:b.width(),height:b.height()},this.$svg=a,this.svg=SVG(this.$svg)}return a.prototype.clear=function(){this.svg.size(this.size.width,this.size.height),this.svg.clear()},a.prototype.noDataLabel=function(a,b){a.plain("Not enough data").font({anchor:"middle"}).x(b.x(b.width/2)).cy(b.y(b.height/2)).attr("class","no-data")},a}(),zc=function(a){function b(b){a.call(this,g("svg",b)),this.$canvas=g("canvas",b),this.context=this.$canvas.getContext("2d")}return vc(b,a),b.prototype.clear=function(){a.prototype.clear.call(this),this.$canvas.width=this.size.width,this.$canvas.height=this.size.height,this.context.clearRect(0,0,this.size.width,this.size.height)},b}(yc);!function(a){function b(a){l&&(l.remove(),l=null),$(i).append(a),l=a,setTimeout(function(){a==l&&(l.remove(),l=null)},1500)}function c(){return"ws://"+window.location.hostname+":8080/game?u="+encodeURIComponent([global.user.id,global.user.name].join("|"))}function d(a){switch(a.keyCode){case 8:return 8;case 9:return 9;case 13:return 10}switch(a.charCode){case 13:return 10}return a.charCode}function e(a){return 10==a?32:a}function f(){var a=new t;z({path:"mmo",onShow:function(){a.init()},onHide:function(){a.destroy()}})}var g,h=document.getElementById("mmo-ticker"),i=document.getElementById("mmo-flasher"),j=document.getElementById("mmo-track"),k=document.getElementById("mmo-text"),l=null,m=17,n=18,o=33,p=34,q=35,r=33;!function(a){a[a.INITIALIZING=-1]="INITIALIZING",a[a.WAITING=0]="WAITING",a[a.STARTING=1]="STARTING",a[a.RUNNING=2]="RUNNING",a[a.FINISHED=3]="FINISHED"}(g||(g={}));var s=function(){function a(a){this.id=a.id,this.user=a.user,this.reset()}return a.prototype.reset=function(){this.ghost=!1,this.finished=!1,this.position=0,this.offset=0,this.velocity=0,this.distance=0,this.tSpeed=0,this.tErrors=0},a.prototype.avatar=function(){return this.user.link?"https://graph.facebook.com/"+this.user.link+"/picture?type=small":"/res/image/person.png"},a.prototype.buildPlayer=function(){var a=this.id%5+1,b=H.make("img");b.src=this.avatar();var c=H.make("span");return c.textContent=this.user.name,this.$indicator=H.make("span",["indicator"]),this.$indicator.appendChild(b),this.$indicator.appendChild(c),this.$car=H.make("span",["car","car"+a]),this.$lane=H.make("div",["lane","lane"+a]),this.$lane.appendChild(this.$car),this.$player=H.make("div","player"),this.$player.appendChild(this.$indicator),this.$player.appendChild(this.$lane),this.$player},a.prototype.updatePlayer=function(a){this.ghost?this.$player.classList.add("ghost"):this.$player.classList.remove("ghost"),this.finished?this.$player.classList.add("finished"):this.$player.classList.remove("finished"),a==this?this.$player.classList.add("me"):this.$player.classList.remove("me")},a.prototype.movePlayer=function(a){var b=(this.$lane.offsetWidth-this.$car.offsetWidth)*a;this.$car.style.left=b+"px"},a}(),t=function(){function a(){var a=this;window.setInterval(function(){k.classList.toggle("blink")},300),window.addEventListener("blur",function(){a.ws}),window.addEventListener("focus",function(){a.ws}),window.addEventListener("resize",function(){a.ws&&a.updateTrack()}),document.addEventListener("keydown",function(b){a.ws&&a.me&&a.keyDown(b)},!0),document.addEventListener("keyup",function(b){a.ws&&a.me&&a.keyUp(b)},!0),document.addEventListener("keypress",function(b){a.ws&&a.me&&a.keyPress(b)},!0)}return a.prototype.init=function(){this.ws&&this.ws.close(),this.connect()},a.prototype.destroy=function(){this.ws&&this.ws.close()},a.prototype.connect=function(){var a=this,b=new WebSocket(c());b.binaryType="arraybuffer",b.onopen=function(){console.log("WebSocket connected"),document.body.classList.remove("offline"),document.body.classList.add("online"),a.ws=b,a.reset()},b.onclose=function(b){console.log("WebSocket closed; code="+b.code+", reason='"+b.reason+"'"),document.body.classList.remove("online"),document.body.classList.add("offline"),a.ws=null,a.reset()},b.onerror=function(a){console.log("WebSocket error",a.error)},b.onmessage=function(b){a.handle(b.data)}},a.prototype.handle=function(a){var b=new V.IO.Reader(a),c=b.getInt8();switch(c){case m:this.handlePlayerJoin(b);break;case n:this.handlePlayerLeave(b);break;case o:this.handleGameConfig(b);break;case p:this.handleGameReady(b);break;case q:this.handleGameWorld(b);break;default:this.ws.close(1003,"Unrecognized message "+c)}},a.prototype.handlePlayerJoin=function(a){for(var b=a.getInt32(),c=[],d=a.getInt8();d>0;d--)c.push({id:a.getInt32(),user:{id:a.getInt32(),link:a.getString(),name:a.getString()}});var e=0==Object.keys(this.players).length;this.sync(c),e&&(this.me=this.players[b]),this.buildTrack()},a.prototype.handlePlayerLeave=function(a){for(var b=a.getInt32(),c=[],d=a.getInt8();d>0;d--)c.push({id:a.getInt32(),user:{id:a.getInt32(),link:a.getString(),name:a.getString()}});this.sync(c),this.buildTrack(),this.me.id==b&&(console.log("Player was kicked out of the game"),this.me=null)},a.prototype.handleGameConfig=function(a){this.text=a.getString(),this.position=0},a.prototype.handleGameReady=function(a){var c=a.getInt8(),d=a.getInt8();switch(c){case 0:if(0!=this.state){this.state=0;for(var e in this.players){var f=this.players[e];f.reset()}this.updateTrack(),this.fragmentUi=new u("",k),this.fragmentUi.update(-1),$(h).text("Waiting for more players...")}break;case 1:if(1!=this.state){this.state=1;for(var e in this.players){var f=this.players[e];f.reset()}this.updateTrack(),this.fragmentUi=new u(this.text,k),this.fragmentUi.update(this.position)}$(h).text("Start in "+d),b($('<div class="bounce-in">'+d+"</div>"));break;case 2:2!=this.state&&(1==this.state?($(h).text("GO!"),b($('<div class="bounce-in">GO!</div>'))):$(h).text("Please wait, you will join the next race"),this.state=2,this.started=Date.now(),null==this.fragmentUi&&(this.fragmentUi=new u(this.text,k),this.fragmentUi.update(this.text.length)));break;case 3:3!=this.state&&(this.state=3,null==this.fragmentUi&&(this.fragmentUi=new u(this.text,k),this.fragmentUi.update(this.text.length)),$(h).text("Race finished"))}},a.prototype.handleGameWorld=function(a){for(var b=(a.getInt32(),a.getInt8());b>0;b--){var c={id:a.getInt32(),flags:a.getInt8(),position:a.getInt8(),offset:a.getInt16(),velocity:a.getFloat32(),distance:a.getFloat32(),tSpeed:a.getInt16(),tErrors:a.getInt16()},d=this.players[c.id];null!=d&&(d.ghost=!!(1&c.flags),d.finished=!!(2&c.flags),d.position=c.position,d.offset=c.offset,d.velocity=c.velocity,d.distance=c.distance,d.tSpeed=c.tSpeed,d.tErrors=c.tErrors)}this.updateTrack()},a.prototype.keyDown=function(a){if(!(a.ctrlKey||a.altKey||a.metaKey)&&2==this.state)switch(a.keyCode){case 8:case 27:a.stopPropagation(),a.preventDefault()}},a.prototype.keyUp=function(){},a.prototype.keyPress=function(a){if(!(a.ctrlKey||a.altKey||a.metaKey)&&2==this.state){var b=Date.now()-this.started,c=d(a);c>0&&(this.me.ghost||(this.progress(b,c),this.position<this.text.length&&e(this.text.charCodeAt(this.position))==e(c)&&this.position++,this.fragmentUi.update(this.position)),a.stopPropagation(),a.preventDefault())}},a.prototype.progress=function(a,b){var c=new V.IO.Writer;c.putUint8(r),c.putUint32(a),c.putUint16(b),this.ws.send(c.get())},a.prototype.reset=function(){this.state=-1,this.me=null,this.players=Object.create(null),this.buildTrack()},a.prototype.sync=function(a){var b=this,c=a.map(function(a){return a.id});for(var d in this.players){var e=this.players[d];-1==c.indexOf(e.id)&&delete this.players[d]}a.forEach(function(a){null==b.players[a.id]&&(b.players[a.id]=new s(a))})},a.prototype.buildTrack=function(){for(;j.firstChild;)j.removeChild(j.firstChild);var a=0;for(var b in this.players){var c=this.players[b];j.appendChild(c.buildPlayer()),a++}for(;5>a;)j.appendChild(H.make("div","player")),a++;this.updateTrack()},a.prototype.updateTrack=function(){for(var a in this.players){var b=this.players[a];b.updatePlayer(this.me),b.movePlayer(2===this.state||3===this.state?b.offset/this.text.length:0)}},a}(),u=function(){function a(a,b){this.text=a,this.$root=H.make("div",["fragment"]),this.$item=[];for(var a=this.text,c=0;c<a.length;c++){var d=a.charCodeAt(c);10==d?(this.$root.appendChild(this.$item[c]=H.make("span",["item","new-line"],"↵")),this.$root.appendChild(H.make("br",null,null))):32==d?(this.$root.appendChild(this.$item[c]=H.make("span",["item","space"],"␣")),this.$root.appendChild(H.make("span",null," "))):this.$root.appendChild(this.$item[c]=H.make("span",["item"],String.fromCharCode(d)))}for(;b.firstChild;)b.removeChild(b.firstChild);b.appendChild(this.$root)}return a.prototype.update=function(a){var b,c;if(a>=0&&a<this.text.length){for(b=0;a>b;b++)c=this.$item[b],c.classList.add("down"),c.classList.remove("cursor");for(b=a;b<this.text.length;b++)c=this.$item[b],c.classList.remove("down"),b==a?c.classList.add("cursor"):c.classList.remove("cursor")}else for(b=0;b<this.text.length;b++)c=this.$item[b],c.classList.remove("down"),c.classList.remove("cursor")},a}();a.webSocketUrl=c,a.init=f}(uc||(uc={}));var Ac,Bc=function(){function a(a,b){this.user=a,this.id=b,this.enabled=!0}return a.prototype.login=function(){var a=Y.defer();return this.id.watch({loggedInUser:this.user.email,onlogin:function(b){Z.POST("/auth/login/persona").sendForm({assertion:b}).done(function(b){var c=b.json;c.status?a.resolve(null):a.reject({message:"Persona login failure",response:c})}).fail(function(b){a.reject(b)})},onlogout:function(){}}),this.id.request(),a.promise()},a.prototype.logout=function(){var a=Y.defer();return this.id.watch({loggedInUser:this.user.email,onlogin:function(){},onlogout:function(){a.resolve(null)}}),this.id.logout(),a.promise()},a}();!function(a){function b(){var a=[];return $(".social-shares").each(function(b,c){$(c).find(".widget").each(function(b,c){var d=$(c),e=d.data("provider"),g=i[e];g?a.push(new f(e,g,d)):d.remove()})}),a}function c(a){var b=Object.create(null);for(var c in a)b[c]=h[a[c]];return b}function e(a){var b=[];for(var c in a)b.push(c+"="+String(a[c]));return b}a.init=b;var f=function(){function a(a,b,c){var d=this;this.id=a,this.provider=b,this.$widget=c,this.$widget.hide(),this.$widget.empty(),this.$widget.addClass("widget"),this.$widget.addClass(this.id),this.$widget.append($('<span class="icon"><svg><use xlink:href="#icon-social-'+this.id+'"/></svg></span>')),this.$widget.append($('<span class="counter"></span>')),this.$widget.on("click",function(){d.openPopup()}),this.load().done(function(a){d.count=a.count,c.show().find(".counter").text(d.count)}).fail(function(){d.count=null,c.show().find(".counter").text("?")})}return a.prototype.load=function(){var a=g[this.id];if(null==a){var b=Y.defer(),d=this.provider.counter;Z.JSONP(d.url,c(d.params)).done(function(a){b.resolve(d.parse(a))}).fail(function(a){b.reject(a)}),a=g[this.id]=b.promise()}return a},a.prototype.openPopup=function(){var a=this.provider.popup,b=Z.parseUri(a.url,c(a.params)),d=Math.round(screen.width/2-a.width/2),f=Math.round(screen.height/3-a.height/2),g=window.open(b,"social-shares-"+this.id,e({left:d,top:f,width:a.width,height:a.height,personalbar:0,toolbar:0,scrollbars:1,resizable:1}).join(","));g?g.focus():window.location.href=b},a}();a.Button=f;var g={},h={url:d("meta[property='og:url']").attr("content"),title:d("meta[property='og:title']").attr("content"),description:d("meta[property='og:description']").attr("content")},i={facebook:{counter:{url:"https://graph.facebook.com/",params:{id:"url"},parse:function(a){return{count:a.shares}}},popup:{url:"https://www.facebook.com/sharer/sharer.php",params:{u:"url"},width:600,height:500}},twitter:{counter:{url:"https://cdn.api.twitter.com/1/urls/count.json",params:{url:"url"},parse:function(a){return{count:a.count}}},popup:{url:"https://twitter.com/intent/tweet",params:{url:"url",text:"description"},width:600,height:450}}}}(Ac||(Ac={}));var Cc;!function(a){function b(a){var b=String(a)+"\n",d=a.stack;return d.startsWith(b)&&(d=d.substring(b.length)),d.split("\n").map(function(a){return c(a)}).filter(function(a){return null!=a})}function c(a){function b(a){return parseInt(a,10)}var c;if(-1!=a.indexOf("@")){if(c=a.match(/(.+)@(.+) line (\d+) .+ eval:(\d+):(\d+)$/i))return new f(e(c[1]),null,b(c[4]),b(c[5]));if(c=a.match(/@(.+) line (\d+) .+ eval:(\d+):(\d+)$/i))return new f(null,null,b(c[3]),b(c[4]));if(c=a.match(/^(.+)@(.+):(\d+):(\d+)$/i))return new f(e(c[1]),c[2],b(c[3]),b(c[4]));if(c=a.match(/^@(.+):(\d+):(\d+)$/i))return new f(null,c[1],b(c[2]),b(c[3]))}if(-1!=a.indexOf("at ")){if(c=a.match(/^[ \t]+at (.+) \(eval at (.+) \((.+):(\d+):(\d+)\), (.+):(\d+):(\d+)\)$/i))return new f(d(c[1]),null,b(c[7]),b(c[8]));if(c=a.match(/^[ \t]+at (.+) \((.+):(\d+):(\d+)\)$/i))return new f(d(c[1]),c[2],b(c[3]),b(c[4]));if(c=a.match(/^[ \t]+at (.+):(\d+):(\d+)$/i))return new f(null,c[1],b(c[2]),b(c[3]))}return null}function d(a){if(a.endsWith("<anonymous>"))return null;var b=a.toLowerCase();return"object.eval"==b?null:"eval code"==b?null:"anonymous function"==b?null:a}function e(a){return a}var f=function(){function a(a,b,c,d){this.name=a,this.uri=b,this.line=c,this.column=d}return a.prototype.toString=function(){var a="";return a=null!=this.name?this.name:"<anonymous>",null!=this.uri?a=a+"@"+this.uri:a+="@<anonymous>",null!=this.line&&null!=this.column&&(a=a+":"+this.line+":"+this.column),a},a.parse=function(a){try{if("string"==typeof a.stack)return b(a)}catch(c){console.error(c)}return[]},a}();a.StackFrame=f}(Cc||(Cc={}));var Dc;!function(a){function b(){window.onerror=d}function c(a){h=a,g({userAgent:window.navigator.userAgent,message:String(a),uri:String(window.location),stack:f(a)})}function d(a,b,c,i,j){if(null==h||h!=j){h=j,window.onerror=e;try{b&&-1!=b.indexOf(document.domain)&&g({userAgent:window.navigator.userAgent,message:a,uri:b,line:c,column:i,stack:f(j)})}finally{window.onerror=d}}return!1}function e(){return!1}function f(a){if(a instanceof Error)return Cc.StackFrame.parse(a);try{throw new Error("stack frame")}catch(b){var c=Cc.StackFrame.parse(b);return c.length&&c.shift(),c.length&&c.shift(),c}}function g(a){var b=new XMLHttpRequest;b.open("POST","/log",!0),b.setRequestHeader("Content-Type","application/json"),b.send(JSON.stringify(a))}a.init=b,a.log=c;var h=null}(Dc||(Dc={})),"console"in window&&(Dc.init(),G(),Ac.init())}();
//# sourceMappingURL=js.min.js.map